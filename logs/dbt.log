

============================== 2022-06-04 13:42:14.437121 | 5bea79ab-b701-48de-bb63-3ecb8006eaa9 ==============================
13:42:14.437133 [info ] [MainThread]: Running with dbt=1.1.0
13:42:14.438354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:42:14.441031 [debug] [MainThread]: Tracking: tracking
13:42:14.447017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146d794ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146d794d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146d794ca0>]}
13:42:14.493235 [debug] [MainThread]: Executing "git --help"
13:42:14.501953 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:42:14.502264 [debug] [MainThread]: STDERR: "b''"
13:42:14.502585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146d83d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146bf9a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f146bf9ab20>]}


============================== 2022-06-04 13:43:02.694645 | 1469d896-e0a1-4f90-8d5e-a020f4cc5395 ==============================
13:43:02.694655 [info ] [MainThread]: Running with dbt=1.1.0
13:43:02.695052 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:43:02.695149 [debug] [MainThread]: Tracking: tracking
13:43:02.704235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd599b8b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd599b8b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd599b8b280>]}
13:43:02.764207 [debug] [MainThread]: Executing "git --help"
13:43:02.773424 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:43:02.773836 [debug] [MainThread]: STDERR: "b''"
13:43:02.790325 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:43:02.793890 [debug] [MainThread]: Using postgres connection "debug"
13:43:02.794832 [debug] [MainThread]: On debug: select 1 as id
13:43:02.795240 [debug] [MainThread]: Opening a new connection, currently in state init
13:43:02.807210 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
13:43:02.808125 [debug] [MainThread]: On debug: Close
13:43:02.808539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5983122e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59831b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59831bdc0>]}
13:43:03.595450 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-04 14:18:04.878076 | a7ce7d52-4832-4be0-9e24-097422e22761 ==============================
14:18:04.878103 [info ] [MainThread]: Running with dbt=1.1.0
14:18:04.878779 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:04.878903 [debug] [MainThread]: Tracking: tracking
14:18:04.900687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8cf8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8cf8af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8cf8ee0>]}
14:18:04.908729 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
14:18:04.909018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8caf5e0>]}
14:18:04.915993 [debug] [MainThread]: Parsing macros/catalog.sql
14:18:04.918266 [debug] [MainThread]: Parsing macros/relations.sql
14:18:04.919139 [debug] [MainThread]: Parsing macros/adapters.sql
14:18:04.934522 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
14:18:04.935739 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:18:04.937290 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:18:04.939810 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:18:04.946507 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:18:04.956655 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:18:04.967769 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:18:04.970735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:18:04.971755 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:18:04.972593 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:18:04.974090 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:18:04.976089 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:18:04.980437 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:18:04.984939 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:18:04.986776 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:18:04.997110 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:18:05.000952 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:18:05.002142 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:18:05.004810 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:18:05.005938 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:18:05.014621 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:18:05.024815 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:18:05.032741 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:18:05.034257 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:18:05.035778 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:18:05.036749 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:18:05.037728 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:18:05.043689 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:18:05.049319 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:18:05.051156 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:18:05.052740 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:18:05.054331 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:18:05.059126 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:18:05.062248 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:18:05.062810 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:18:05.063323 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:18:05.063846 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:18:05.064681 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:18:05.069796 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:18:05.072523 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:18:05.218893 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
14:18:05.227251 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
14:18:05.229111 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
14:18:05.267445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d88010d0>]}
14:18:05.276386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0daececa0>]}
14:18:05.276717 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:05.276955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0daece2b0>]}
14:18:05.278208 [info ] [MainThread]: 
14:18:05.278616 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:05.279323 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:05.286509 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:05.288751 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:05.288938 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:05.296954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:05.311639 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:05.314088 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:05.317934 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:05.318054 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:05.318120 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:05.329912 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:18:05.330201 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:05.330285 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:05.344722 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.01 seconds
14:18:05.345930 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:05.346424 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:05.349344 [debug] [MainThread]: Using postgres connection "master"
14:18:05.349478 [debug] [MainThread]: On master: BEGIN
14:18:05.349560 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:05.353674 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:05.353850 [debug] [MainThread]: Using postgres connection "master"
14:18:05.353936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:05.364478 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:18:05.365348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0dae6f850>]}
14:18:05.365747 [debug] [MainThread]: On master: ROLLBACK
14:18:05.366059 [debug] [MainThread]: Using postgres connection "master"
14:18:05.366159 [debug] [MainThread]: On master: BEGIN
14:18:05.366519 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:05.366627 [debug] [MainThread]: On master: COMMIT
14:18:05.366704 [debug] [MainThread]: Using postgres connection "master"
14:18:05.366826 [debug] [MainThread]: On master: COMMIT
14:18:05.367098 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:05.367217 [debug] [MainThread]: On master: Close
14:18:05.367514 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:05.367702 [info ] [MainThread]: 
14:18:05.374132 [debug] [Thread-1  ]: Began running node model.first_project.costumers
14:18:05.374411 [info ] [Thread-1  ]: 1 of 3 START view model public.costumers ....................................... [RUN]
14:18:05.375150 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
14:18:05.375262 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
14:18:05.375337 [debug] [Thread-1  ]: Compiling model.first_project.costumers
14:18:05.376324 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
14:18:05.376631 [debug] [Thread-1  ]: finished collecting timing info
14:18:05.376724 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
14:18:05.383129 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:05.383462 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:05.383814 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:05.383945 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:05.384019 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:05.385553 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:05.401505 [debug] [Thread-2  ]: finished collecting timing info
14:18:05.401674 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:05.415198 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
14:18:05.420854 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:18:05.420990 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
14:18:05.421051 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:05.423223 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:05.424169 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:05.424359 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:05.424468 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:18:05.428154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:18:05.428335 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:18:05.428400 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:05.433277 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:18:05.433521 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:05.435112 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:05.455259 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.02 seconds
14:18:05.459998 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:05.460370 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:05.461010 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:05.467860 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.04 seconds
14:18:05.469231 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:18:05.469341 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
14:18:05.469851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:05.473014 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:18:05.473143 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:18:05.473205 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:18:05.475230 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:05.475405 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:05.475497 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:05.476553 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:18:05.479956 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:18:05.480240 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
14:18:05.480168 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:18:05.481715 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:05.481914 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:05.481854 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:05.482748 [debug] [Thread-1  ]: finished collecting timing info
14:18:05.482954 [debug] [Thread-1  ]: On model.first_project.costumers: Close
14:18:05.482872 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:05.484876 [debug] [Thread-2  ]: finished collecting timing info
14:18:05.485340 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:05.487070 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8794f70>]}
14:18:05.487454 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
14:18:05.485228 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8786e50>]}
14:18:05.487855 [info ] [Thread-1  ]: 1 of 3 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.11s]
14:18:05.488121 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:05.488340 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
14:18:05.488826 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:05.488984 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:05.489292 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:05.489391 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:05.489488 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:05.491229 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:05.491523 [debug] [Thread-4  ]: finished collecting timing info
14:18:05.491642 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:05.494002 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:05.494346 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:05.494434 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:05.494494 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:05.500621 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:05.500813 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:05.500946 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:05.503320 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:05.505134 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:05.505263 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:05.505682 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:05.506551 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:05.506648 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:05.506742 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:05.508302 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:18:05.511067 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:05.511242 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:05.511751 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:05.513869 [debug] [Thread-4  ]: finished collecting timing info
14:18:05.514032 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:05.514374 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ce7d52-4832-4be0-9e24-097422e22761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0da56c3d0>]}
14:18:05.514700 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
14:18:05.515001 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:05.517647 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:05.517807 [debug] [MainThread]: Using postgres connection "master"
14:18:05.517879 [debug] [MainThread]: On master: BEGIN
14:18:05.517935 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:05.522711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:05.522901 [debug] [MainThread]: On master: COMMIT
14:18:05.522969 [debug] [MainThread]: Using postgres connection "master"
14:18:05.523037 [debug] [MainThread]: On master: COMMIT
14:18:05.523301 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:05.523431 [debug] [MainThread]: On master: Close
14:18:05.523738 [info ] [MainThread]: 
14:18:05.524026 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.25s.
14:18:05.524274 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:05.524367 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:05.524447 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
14:18:05.524527 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:05.530360 [info ] [MainThread]: 
14:18:05.530742 [info ] [MainThread]: [32mCompleted successfully[0m
14:18:05.531037 [info ] [MainThread]: 
14:18:05.531237 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:18:05.531488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0daec1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d8d007f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d875cd60>]}


============================== 2022-06-04 14:30:02.868581 | 20361810-bc08-4256-b62d-30c7c1837800 ==============================
14:30:02.868599 [info ] [MainThread]: Running with dbt=1.1.0
14:30:02.869027 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:02.869124 [debug] [MainThread]: Tracking: tracking
14:30:02.871610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f578a049400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f578a0496d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f578a049910>]}
14:30:02.899370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
14:30:02.899637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
14:30:02.904108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789f5a0d0>]}
14:30:02.911691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789fcc040>]}
14:30:02.912018 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:02.912314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789fddfd0>]}
14:30:02.913346 [info ] [MainThread]: 
14:30:02.913753 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:02.914424 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:30:02.920979 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:30:02.921184 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:30:02.921261 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:02.931912 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:30:02.933023 [debug] [ThreadPool]: On list_erp_oltp: Close
14:30:02.936268 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:30:02.948683 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:02.948876 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:30:02.948952 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:02.953415 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:30:02.953596 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:02.953676 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:02.955131 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:30:02.956222 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:30:02.956547 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:30:02.960362 [debug] [MainThread]: Using postgres connection "master"
14:30:02.960563 [debug] [MainThread]: On master: BEGIN
14:30:02.960634 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:02.964784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:02.964970 [debug] [MainThread]: Using postgres connection "master"
14:30:02.965046 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:02.975527 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:30:02.976510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789fdddf0>]}
14:30:02.976793 [debug] [MainThread]: On master: ROLLBACK
14:30:02.977050 [debug] [MainThread]: Using postgres connection "master"
14:30:02.977157 [debug] [MainThread]: On master: BEGIN
14:30:02.977368 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:02.977456 [debug] [MainThread]: On master: COMMIT
14:30:02.977566 [debug] [MainThread]: Using postgres connection "master"
14:30:02.977628 [debug] [MainThread]: On master: COMMIT
14:30:02.978071 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:02.978182 [debug] [MainThread]: On master: Close
14:30:02.978536 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:30:02.978768 [info ] [MainThread]: 
14:30:02.984271 [debug] [Thread-1  ]: Began running node model.first_project.costumers
14:30:02.984529 [info ] [Thread-1  ]: 1 of 3 START view model public.costumers ....................................... [RUN]
14:30:02.984844 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:30:02.985064 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:30:02.985493 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
14:30:02.985601 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
14:30:02.985750 [debug] [Thread-1  ]: Compiling model.first_project.costumers
14:30:02.986587 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
14:30:02.986827 [debug] [Thread-1  ]: finished collecting timing info
14:30:02.986975 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
14:30:02.993193 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:30:02.993417 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:30:02.993521 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:30:02.995036 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:30:03.011758 [debug] [Thread-2  ]: finished collecting timing info
14:30:03.013367 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
14:30:03.013617 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:30:03.046114 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:03.046296 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
14:30:03.046363 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:03.061852 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:30:03.062090 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:03.062202 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:30:03.062435 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:30:03.063268 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:03.063366 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:30:03.063481 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:03.064804 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:03.069178 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:03.069333 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
14:30:03.069641 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:30:03.069827 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:03.069931 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:30:03.070020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:03.071692 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:03.071833 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
14:30:03.071984 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:30:03.073428 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:03.073563 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:30:03.073683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:03.078450 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:30:03.078682 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:03.078858 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:30:03.079125 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
14:30:03.081326 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:03.081467 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:30:03.081868 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:03.085162 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:03.085302 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:03.085410 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:03.085580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:30:03.088905 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:03.089064 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
14:30:03.089172 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:30:03.090393 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:03.090515 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:30:03.094315 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:30:03.095406 [debug] [Thread-1  ]: finished collecting timing info
14:30:03.096002 [debug] [Thread-1  ]: On model.first_project.costumers: Close
14:30:03.095878 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
14:30:03.098170 [debug] [Thread-2  ]: finished collecting timing info
14:30:03.098324 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:30:03.098787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5788634af0>]}
14:30:03.099073 [info ] [Thread-1  ]: 1 of 3 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.11s]
14:30:03.099336 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
14:30:03.099872 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789ee7af0>]}
14:30:03.100091 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
14:30:03.100328 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:30:03.100764 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:30:03.100989 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:30:03.101255 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:30:03.101334 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:30:03.101402 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:30:03.102866 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:30:03.103451 [debug] [Thread-4  ]: finished collecting timing info
14:30:03.103614 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:30:03.104834 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:30:03.105033 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:03.105144 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:30:03.105208 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:30:03.109626 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
14:30:03.109979 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:03.110078 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:30:03.111561 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:03.113211 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:03.113321 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:30:03.113864 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:03.114604 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:03.114698 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:03.114759 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:03.116093 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:30:03.117003 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:03.117092 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:30:03.117275 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:03.117984 [debug] [Thread-4  ]: finished collecting timing info
14:30:03.118125 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:30:03.118540 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20361810-bc08-4256-b62d-30c7c1837800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f578cc9c4c0>]}
14:30:03.118848 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:30:03.119120 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:30:03.121759 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:03.121942 [debug] [MainThread]: Using postgres connection "master"
14:30:03.122022 [debug] [MainThread]: On master: BEGIN
14:30:03.122088 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:03.129943 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:03.130167 [debug] [MainThread]: On master: COMMIT
14:30:03.130255 [debug] [MainThread]: Using postgres connection "master"
14:30:03.130328 [debug] [MainThread]: On master: COMMIT
14:30:03.130503 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:03.130647 [debug] [MainThread]: On master: Close
14:30:03.131133 [info ] [MainThread]: 
14:30:03.131325 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.22s.
14:30:03.131432 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:03.131484 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:30:03.131533 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
14:30:03.131581 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:30:03.134409 [info ] [MainThread]: 
14:30:03.134619 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:03.134784 [info ] [MainThread]: 
14:30:03.134920 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:30:03.135095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5788e75fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789fab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5789eec910>]}


============================== 2022-06-04 14:30:11.099229 | 3af6dc03-550e-439a-903f-44c5cb96ee82 ==============================
14:30:11.099246 [info ] [MainThread]: Running with dbt=1.1.0
14:30:11.099681 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:11.099782 [debug] [MainThread]: Tracking: tracking
14:30:11.102238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb773a70fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb773a70fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb773a70d60>]}
14:30:11.132531 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:11.132902 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
14:30:11.141082 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
14:30:11.156873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7735350d0>]}
14:30:11.160632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb773a729a0>]}
14:30:11.160972 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:11.161247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb773a726a0>]}
14:30:11.162282 [info ] [MainThread]: 
14:30:11.162717 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:11.163570 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:30:11.178774 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:30:11.178973 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:30:11.179057 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:11.184645 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:30:11.185761 [debug] [ThreadPool]: On list_erp_oltp: Close
14:30:11.190609 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:30:11.200004 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:11.200242 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:30:11.200324 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:11.204540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:30:11.204706 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:11.204775 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:11.206466 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:30:11.208119 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:30:11.208858 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:30:11.238682 [debug] [MainThread]: Using postgres connection "master"
14:30:11.238916 [debug] [MainThread]: On master: BEGIN
14:30:11.238986 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:11.244670 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:11.244876 [debug] [MainThread]: Using postgres connection "master"
14:30:11.244990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:11.253468 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:30:11.254624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7739b7640>]}
14:30:11.254962 [debug] [MainThread]: On master: ROLLBACK
14:30:11.255352 [debug] [MainThread]: Using postgres connection "master"
14:30:11.255442 [debug] [MainThread]: On master: BEGIN
14:30:11.255807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:11.255899 [debug] [MainThread]: On master: COMMIT
14:30:11.255966 [debug] [MainThread]: Using postgres connection "master"
14:30:11.256031 [debug] [MainThread]: On master: COMMIT
14:30:11.256274 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:11.256425 [debug] [MainThread]: On master: Close
14:30:11.256770 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:30:11.257010 [info ] [MainThread]: 
14:30:11.261473 [debug] [Thread-1  ]: Began running node model.first_project.costumers
14:30:11.261810 [info ] [Thread-1  ]: 1 of 3 START view model public.costumers ....................................... [RUN]
14:30:11.261971 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:30:11.263171 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
14:30:11.263381 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:30:11.263576 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
14:30:11.263887 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:30:11.264063 [debug] [Thread-1  ]: Compiling model.first_project.costumers
14:30:11.264222 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:30:11.265131 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
14:30:11.265334 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:30:11.266994 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:30:11.269521 [debug] [Thread-2  ]: finished collecting timing info
14:30:11.269765 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:30:11.286160 [debug] [Thread-1  ]: finished collecting timing info
14:30:11.291816 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
14:30:11.303523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:30:11.314393 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
14:30:11.314885 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:11.315017 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:30:11.315097 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:11.315411 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:11.315983 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
14:30:11.316065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:11.319480 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
14:30:11.319627 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:11.319701 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:30:11.320622 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:30:11.325068 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:11.325368 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:30:11.325559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:11.325730 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:11.325813 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
14:30:11.325932 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:11.327445 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:11.327596 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:11.327784 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:30:11.329954 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:11.330265 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
14:30:11.330486 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:11.330597 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:11.337577 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:11.339207 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:11.339442 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:11.339734 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
14:30:11.339914 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:11.340620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:11.342966 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:30:11.343139 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:11.343212 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:30:11.343835 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:30:11.351709 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:11.351931 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:30:11.352975 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:30:11.354405 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:30:11.354565 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
14:30:11.355274 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:30:11.356456 [debug] [Thread-2  ]: finished collecting timing info
14:30:11.356619 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:11.356874 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:30:11.357955 [debug] [Thread-1  ]: finished collecting timing info
14:30:11.358361 [debug] [Thread-1  ]: On model.first_project.costumers: Close
14:30:11.358723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7734f5790>]}
14:30:11.358991 [info ] [Thread-1  ]: 1 of 3 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.10s]
14:30:11.359267 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
14:30:11.361283 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb770439d90>]}
14:30:11.361573 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
14:30:11.361959 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:30:11.363303 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:30:11.363502 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:30:11.363812 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:30:11.363938 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:30:11.364019 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:30:11.365547 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:30:11.366089 [debug] [Thread-4  ]: finished collecting timing info
14:30:11.366249 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:30:11.367631 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:30:11.367948 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:11.368047 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:30:11.368118 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:30:11.380321 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:30:11.380648 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:11.380798 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:30:11.382181 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:11.384334 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:11.384471 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:30:11.384886 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:11.386131 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:11.386260 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:11.386333 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:11.388487 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:30:11.390050 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:11.390364 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:30:11.390755 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:11.391823 [debug] [Thread-4  ]: finished collecting timing info
14:30:11.392978 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:30:11.394134 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3af6dc03-550e-439a-903f-44c5cb96ee82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7734b9e50>]}
14:30:11.394433 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
14:30:11.394932 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:30:11.396601 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:11.396738 [debug] [MainThread]: Using postgres connection "master"
14:30:11.396802 [debug] [MainThread]: On master: BEGIN
14:30:11.396904 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:11.404082 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:11.404317 [debug] [MainThread]: On master: COMMIT
14:30:11.404394 [debug] [MainThread]: Using postgres connection "master"
14:30:11.404456 [debug] [MainThread]: On master: COMMIT
14:30:11.405797 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:11.405981 [debug] [MainThread]: On master: Close
14:30:11.406388 [info ] [MainThread]: 
14:30:11.406730 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.24s.
14:30:11.407087 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:11.407181 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:30:11.407252 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
14:30:11.407319 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:30:11.411555 [info ] [MainThread]: 
14:30:11.411877 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:11.412117 [info ] [MainThread]: 
14:30:11.412248 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:30:11.412449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7752f7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb77585f1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb775be08e0>]}


============================== 2022-06-04 14:47:41.767025 | df9775f1-f910-4e8f-9169-e7ef4059d0dc ==============================
14:47:41.767039 [info ] [MainThread]: Running with dbt=1.1.0
14:47:41.767376 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:47:41.767464 [debug] [MainThread]: Tracking: tracking
14:47:41.770055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e4e2e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e4e2e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e4e2e2b0>]}
14:47:41.793570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:47:41.794039 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
14:47:41.801952 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
14:47:41.819843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e49000d0>]}
14:47:41.823506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e4dc8f10>]}
14:47:41.823762 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:47:41.823978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e4dc8ee0>]}
14:47:41.825154 [info ] [MainThread]: 
14:47:41.825602 [debug] [MainThread]: Acquiring new postgres connection "master"
14:47:41.826492 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:47:41.833866 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:47:41.834059 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:47:41.834145 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:47:41.843710 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:47:41.844880 [debug] [ThreadPool]: On list_erp_oltp: Close
14:47:41.846110 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:47:41.854107 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:47:41.854284 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:47:41.854359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:47:41.859890 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:47:41.860091 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:47:41.860176 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:47:41.861825 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:47:41.862724 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:47:41.862907 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:47:41.898326 [debug] [MainThread]: Using postgres connection "master"
14:47:41.898603 [debug] [MainThread]: On master: BEGIN
14:47:41.898717 [debug] [MainThread]: Opening a new connection, currently in state init
14:47:41.904736 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:47:41.905043 [debug] [MainThread]: Using postgres connection "master"
14:47:41.905268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:47:41.916266 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:47:41.917288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e66c2df0>]}
14:47:41.917532 [debug] [MainThread]: On master: ROLLBACK
14:47:41.917939 [debug] [MainThread]: Using postgres connection "master"
14:47:41.918050 [debug] [MainThread]: On master: BEGIN
14:47:41.918571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:47:41.918679 [debug] [MainThread]: On master: COMMIT
14:47:41.918748 [debug] [MainThread]: Using postgres connection "master"
14:47:41.918806 [debug] [MainThread]: On master: COMMIT
14:47:41.919175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:47:41.919318 [debug] [MainThread]: On master: Close
14:47:41.919671 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:47:41.919830 [info ] [MainThread]: 
14:47:41.925611 [debug] [Thread-1  ]: Began running node model.first_project.costumers
14:47:41.925930 [info ] [Thread-1  ]: 1 of 3 START view model public.costumers ....................................... [RUN]
14:47:41.926244 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
14:47:41.926333 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
14:47:41.926410 [debug] [Thread-1  ]: Compiling model.first_project.costumers
14:47:41.927188 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
14:47:41.927448 [debug] [Thread-1  ]: finished collecting timing info
14:47:41.927547 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
14:47:41.934945 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:47:41.935248 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:47:41.935567 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:47:41.935654 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:47:41.936715 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:47:41.942985 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:47:41.943525 [debug] [Thread-2  ]: finished collecting timing info
14:47:41.943735 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:47:41.969977 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:47:41.971975 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
14:47:41.973832 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:47:41.974036 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:47:41.974118 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:47:41.974593 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:47:41.974805 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
14:47:41.974902 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:47:41.980398 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:47:41.980595 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:47:41.980669 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:47:41.981673 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:47:41.987268 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:47:41.987424 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:47:41.988010 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:47:41.989952 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:47:41.990096 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:47:41.990241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:47:41.990349 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:47:41.990416 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
14:47:41.990770 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:47:41.998819 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:47:41.999010 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:47:41.999101 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:47:41.999339 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:47:42.001045 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:47:42.001146 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
14:47:42.001911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:47:42.003533 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:47:42.003642 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
14:47:42.004031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:47:42.004896 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:47:42.005001 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:47:42.005074 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
14:47:42.029150 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
14:47:42.033949 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:47:42.034229 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
14:47:42.034411 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:47:42.035435 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
14:47:42.035721 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
14:47:42.037887 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:47:42.038983 [debug] [Thread-2  ]: finished collecting timing info
14:47:42.039189 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:47:42.039454 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:47:42.040825 [debug] [Thread-1  ]: finished collecting timing info
14:47:42.041784 [debug] [Thread-1  ]: On model.first_project.costumers: Close
14:47:42.043705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e486ce80>]}
14:47:42.043965 [info ] [Thread-1  ]: 1 of 3 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.12s]
14:47:42.042121 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e48baf10>]}
14:47:42.044550 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
14:47:42.044757 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:47:42.044323 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
14:47:42.045481 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:47:42.045661 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:47:42.045947 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:47:42.046034 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:47:42.046106 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:47:42.047379 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:47:42.047624 [debug] [Thread-4  ]: finished collecting timing info
14:47:42.047719 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:47:42.049070 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:47:42.049282 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:47:42.049471 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:47:42.049624 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:47:42.058113 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:47:42.058319 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:47:42.058418 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:47:42.059483 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:47:42.061158 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:47:42.061282 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:47:42.061568 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:47:42.063586 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:47:42.063678 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:47:42.063737 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:47:42.066232 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:47:42.067567 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:47:42.067720 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:47:42.067997 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:47:42.068729 [debug] [Thread-4  ]: finished collecting timing info
14:47:42.068845 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:47:42.070092 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df9775f1-f910-4e8f-9169-e7ef4059d0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e7012730>]}
14:47:42.073242 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
14:47:42.074289 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:47:42.078618 [debug] [MainThread]: Acquiring new postgres connection "master"
14:47:42.078832 [debug] [MainThread]: Using postgres connection "master"
14:47:42.078933 [debug] [MainThread]: On master: BEGIN
14:47:42.079012 [debug] [MainThread]: Opening a new connection, currently in state closed
14:47:42.091320 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:47:42.091574 [debug] [MainThread]: On master: COMMIT
14:47:42.091662 [debug] [MainThread]: Using postgres connection "master"
14:47:42.091811 [debug] [MainThread]: On master: COMMIT
14:47:42.092939 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:47:42.093571 [debug] [MainThread]: On master: Close
14:47:42.094096 [info ] [MainThread]: 
14:47:42.094281 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.27s.
14:47:42.094393 [debug] [MainThread]: Connection 'master' was properly closed.
14:47:42.094450 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
14:47:42.094501 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:47:42.094552 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:47:42.097344 [info ] [MainThread]: 
14:47:42.109849 [info ] [MainThread]: [32mCompleted successfully[0m
14:47:42.110129 [info ] [MainThread]: 
14:47:42.110269 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:47:42.110459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e6c2d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e6c2b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e6facc70>]}


============================== 2022-06-04 16:30:18.011014 | 4bad72ae-08f7-440d-80de-7c5a2794cde3 ==============================
16:30:18.011029 [info ] [MainThread]: Running with dbt=1.1.0
16:30:18.011479 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:30:18.011583 [debug] [MainThread]: Tracking: tracking
16:30:18.015427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c6ccf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c6cc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c6cc1f0>]}
16:30:18.030756 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:30:18.031193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c6d3100>]}
16:30:18.039400 [debug] [MainThread]: Parsing macros/catalog.sql
16:30:18.042004 [debug] [MainThread]: Parsing macros/relations.sql
16:30:18.042974 [debug] [MainThread]: Parsing macros/adapters.sql
16:30:18.058929 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:30:18.060077 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:30:18.061549 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:30:18.064445 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:30:18.070918 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:30:18.081165 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:30:18.091471 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:30:18.094433 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:30:18.095451 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:30:18.096352 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:30:18.098042 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:30:18.099987 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:30:18.105042 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:30:18.109490 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:30:18.111356 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:30:18.122267 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:30:18.126182 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:30:18.127347 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:30:18.130488 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:30:18.131723 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:30:18.139522 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:30:18.150170 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:30:18.157094 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:30:18.158256 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:30:18.159851 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:30:18.161056 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:30:18.162044 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:30:18.171683 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:30:18.201801 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:30:18.204260 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:30:18.205807 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:30:18.207407 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:30:18.211862 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:30:18.221915 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:30:18.222709 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:30:18.223272 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:30:18.223655 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:30:18.224511 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:30:18.230389 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:30:18.233113 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:30:18.374701 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
16:30:18.383693 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:30:18.385457 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:30:18.419127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6df96af0>]}
16:30:18.422733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c6cc670>]}
16:30:18.423038 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:30:18.423322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6df96b20>]}
16:30:18.424328 [info ] [MainThread]: 
16:30:18.424698 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:18.425634 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:30:18.433104 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:30:18.433293 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:30:18.433410 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:18.442388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:30:18.443824 [debug] [ThreadPool]: On list_erp_oltp: Close
16:30:18.447556 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:30:18.452865 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:18.453048 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:30:18.453118 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:18.459584 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:30:18.459781 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:18.459857 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:30:18.461574 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:30:18.463487 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:30:18.463994 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:30:18.467993 [debug] [MainThread]: Using postgres connection "master"
16:30:18.468305 [debug] [MainThread]: On master: BEGIN
16:30:18.468443 [debug] [MainThread]: Opening a new connection, currently in state init
16:30:18.474181 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:30:18.474418 [debug] [MainThread]: Using postgres connection "master"
16:30:18.474534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:30:18.484443 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:30:18.485427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c66b400>]}
16:30:18.485698 [debug] [MainThread]: On master: ROLLBACK
16:30:18.486038 [debug] [MainThread]: Using postgres connection "master"
16:30:18.486141 [debug] [MainThread]: On master: BEGIN
16:30:18.486538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:18.486677 [debug] [MainThread]: On master: COMMIT
16:30:18.486769 [debug] [MainThread]: Using postgres connection "master"
16:30:18.486841 [debug] [MainThread]: On master: COMMIT
16:30:18.487105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:18.487246 [debug] [MainThread]: On master: Close
16:30:18.487562 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:30:18.487821 [info ] [MainThread]: 
16:30:18.493020 [debug] [Thread-1  ]: Began running node model.first_project.costumers
16:30:18.493310 [info ] [Thread-1  ]: 1 of 3 START table model public.costumers ...................................... [RUN]
16:30:18.493775 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
16:30:18.493942 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
16:30:18.494039 [debug] [Thread-1  ]: Compiling model.first_project.costumers
16:30:18.495320 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
16:30:18.495721 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:30:18.495961 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:30:18.496699 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:30:18.496980 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:30:18.497078 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:30:18.499631 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:30:18.500034 [debug] [Thread-2  ]: finished collecting timing info
16:30:18.500296 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:30:18.500450 [debug] [Thread-1  ]: finished collecting timing info
16:30:18.517023 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
16:30:18.525304 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:30:18.525687 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
16:30:18.526201 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:30:18.526293 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
16:30:18.526387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:30:18.526778 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:18.526875 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:30:18.526938 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:30:18.533998 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:30:18.534184 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:18.534251 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:30:18.534575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:30:18.534699 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:30:18.534759 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */


  create  table "erp_oltp"."public"."costumers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:30:18.535413 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:30:18.539899 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:18.540051 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:30:18.540570 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:18.541971 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:18.542079 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:30:18.542555 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:18.551386 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.02 seconds
16:30:18.553070 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:30:18.553196 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
16:30:18.553494 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:18.553641 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:18.553822 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:18.554311 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:18.555628 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:30:18.555726 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
16:30:18.555858 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:30:18.558642 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:18.558750 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:18.559713 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
16:30:18.559795 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:30:18.559852 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
16:30:18.558849 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:30:18.561569 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:30:18.562964 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:30:18.563088 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
16:30:18.563275 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:30:18.564583 [debug] [Thread-2  ]: finished collecting timing info
16:30:18.565414 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:30:18.566154 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c1832e0>]}
16:30:18.566505 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.07s]
16:30:18.566674 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:18.567407 [debug] [Thread-1  ]: finished collecting timing info
16:30:18.567500 [debug] [Thread-1  ]: On model.first_project.costumers: Close
16:30:18.567742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c0f9940>]}
16:30:18.567931 [info ] [Thread-1  ]: 1 of 3 OK created table model public.costumers ................................. [[32mSELECT 100[0m in 0.07s]
16:30:18.569442 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:30:18.569589 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
16:30:18.570140 [debug] [Thread-2  ]: Began running node model.first_project.my_second_dbt_model
16:30:18.570353 [info ] [Thread-2  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:30:18.571053 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:30:18.571303 [debug] [Thread-2  ]: Began compiling node model.first_project.my_second_dbt_model
16:30:18.571433 [debug] [Thread-2  ]: Compiling model.first_project.my_second_dbt_model
16:30:18.572982 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:30:18.573261 [debug] [Thread-2  ]: finished collecting timing info
16:30:18.573427 [debug] [Thread-2  ]: Began executing node model.first_project.my_second_dbt_model
16:30:18.587717 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:30:18.588244 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:18.588377 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: BEGIN
16:30:18.588443 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:30:18.592669 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
16:30:18.592829 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:18.592906 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:30:18.593840 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
16:30:18.595325 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:18.595442 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:30:18.596905 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:18.597796 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:18.597919 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:18.598011 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:18.599495 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:30:18.601673 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:18.601934 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:30:18.603208 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:18.604378 [debug] [Thread-2  ]: finished collecting timing info
16:30:18.604512 [debug] [Thread-2  ]: On model.first_project.my_second_dbt_model: Close
16:30:18.604942 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bad72ae-08f7-440d-80de-7c5a2794cde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c157580>]}
16:30:18.605188 [info ] [Thread-2  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
16:30:18.605489 [debug] [Thread-2  ]: Finished running node model.first_project.my_second_dbt_model
16:30:18.606648 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:18.606765 [debug] [MainThread]: Using postgres connection "master"
16:30:18.606831 [debug] [MainThread]: On master: BEGIN
16:30:18.606889 [debug] [MainThread]: Opening a new connection, currently in state closed
16:30:18.610846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:18.611057 [debug] [MainThread]: On master: COMMIT
16:30:18.611137 [debug] [MainThread]: Using postgres connection "master"
16:30:18.611197 [debug] [MainThread]: On master: COMMIT
16:30:18.611323 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:18.611453 [debug] [MainThread]: On master: Close
16:30:18.611757 [info ] [MainThread]: 
16:30:18.611901 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.19s.
16:30:18.612023 [debug] [MainThread]: Connection 'master' was properly closed.
16:30:18.612098 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:30:18.612159 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
16:30:18.620580 [info ] [MainThread]: 
16:30:18.620888 [info ] [MainThread]: [32mCompleted successfully[0m
16:30:18.621101 [info ] [MainThread]: 
16:30:18.621271 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:30:18.621514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c66b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c1f00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca6c14aeb0>]}


============================== 2022-06-04 16:42:09.399990 | 9bb5d6e7-b823-4046-8587-620071040d50 ==============================
16:42:09.400016 [info ] [MainThread]: Running with dbt=1.1.0
16:42:09.400924 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:42:09.401067 [debug] [MainThread]: Tracking: tracking
16:42:09.407220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d58cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d58cfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d58cd60>]}
16:42:09.420330 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:42:09.420600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d5887f0>]}
16:42:09.427529 [debug] [MainThread]: Parsing macros/catalog.sql
16:42:09.430264 [debug] [MainThread]: Parsing macros/relations.sql
16:42:09.431826 [debug] [MainThread]: Parsing macros/adapters.sql
16:42:09.447666 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:42:09.449296 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:42:09.450906 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:42:09.453296 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:42:09.459718 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:42:09.470148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:42:09.481826 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:42:09.484955 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:42:09.485985 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:42:09.486767 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:42:09.488312 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:42:09.490011 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:42:09.494142 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:42:09.498546 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:42:09.500295 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:42:09.514253 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:42:09.518180 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:42:09.519307 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:42:09.521982 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:42:09.523086 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:42:09.530562 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:42:09.540837 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:42:09.548143 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:42:09.549336 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:42:09.551031 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:42:09.552087 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:42:09.552976 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:42:09.558929 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:42:09.565099 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:42:09.567048 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:42:09.568456 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:42:09.570161 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:42:09.574453 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:42:09.577339 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:42:09.577997 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:42:09.578666 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:42:09.579093 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:42:09.580005 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:42:09.585576 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:42:09.588408 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:42:09.732260 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers2.sql
16:42:09.740615 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
16:42:09.742499 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:42:09.744144 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:42:09.777340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d500af0>]}
16:42:09.781400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d58cee0>]}
16:42:09.782031 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:42:09.782248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d500580>]}
16:42:09.783166 [info ] [MainThread]: 
16:42:09.783507 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:09.784255 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:42:09.791079 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:42:09.791239 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:42:09.791325 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:09.799001 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:42:09.800390 [debug] [ThreadPool]: On list_erp_oltp: Close
16:42:09.801811 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:42:09.806218 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:09.806321 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:42:09.806383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:42:09.811437 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:42:09.811655 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:09.811729 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:42:09.813759 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:42:09.815321 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:42:09.815955 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:42:09.820131 [debug] [MainThread]: Using postgres connection "master"
16:42:09.820339 [debug] [MainThread]: On master: BEGIN
16:42:09.820424 [debug] [MainThread]: Opening a new connection, currently in state init
16:42:09.825898 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:42:09.826085 [debug] [MainThread]: Using postgres connection "master"
16:42:09.826162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:42:09.835720 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:42:09.836659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d500a30>]}
16:42:09.836906 [debug] [MainThread]: On master: ROLLBACK
16:42:09.837255 [debug] [MainThread]: Using postgres connection "master"
16:42:09.837374 [debug] [MainThread]: On master: BEGIN
16:42:09.837880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:09.838020 [debug] [MainThread]: On master: COMMIT
16:42:09.838120 [debug] [MainThread]: Using postgres connection "master"
16:42:09.838187 [debug] [MainThread]: On master: COMMIT
16:42:09.838432 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:09.838548 [debug] [MainThread]: On master: Close
16:42:09.838943 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:42:09.839162 [info ] [MainThread]: 
16:42:09.843966 [debug] [Thread-1  ]: Began running node model.first_project.costumers
16:42:09.844205 [info ] [Thread-1  ]: 1 of 4 START view model public.costumers ....................................... [RUN]
16:42:09.844595 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
16:42:09.844819 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
16:42:09.844980 [debug] [Thread-1  ]: Compiling model.first_project.costumers
16:42:09.847013 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
16:42:09.847554 [debug] [Thread-2  ]: Began running node model.first_project.costumers2
16:42:09.847770 [info ] [Thread-2  ]: 2 of 4 START table model public.costumers2 ..................................... [RUN]
16:42:09.848072 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.costumers2"
16:42:09.848238 [debug] [Thread-2  ]: Began compiling node model.first_project.costumers2
16:42:09.848322 [debug] [Thread-2  ]: Compiling model.first_project.costumers2
16:42:09.849951 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.costumers2"
16:42:09.850176 [debug] [Thread-2  ]: finished collecting timing info
16:42:09.850266 [debug] [Thread-2  ]: Began executing node model.first_project.costumers2
16:42:09.856438 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
16:42:09.856798 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
16:42:09.867532 [debug] [Thread-1  ]: finished collecting timing info
16:42:09.867780 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
16:42:09.885142 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
16:42:09.885476 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:42:09.887335 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.costumers2"
16:42:09.887577 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
16:42:09.888071 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
16:42:09.889354 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:42:09.887807 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:42:09.889865 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
16:42:09.889951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:42:09.889530 [debug] [Thread-3  ]: finished collecting timing info
16:42:09.889701 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
16:42:09.890236 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
16:42:09.890857 [debug] [Thread-2  ]: On model.first_project.costumers2: BEGIN
16:42:09.893212 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:42:09.893436 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:42:09.893871 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:09.893988 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
16:42:09.894059 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:42:09.899546 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:42:09.899877 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
16:42:09.899987 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:42:09.899758 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:42:09.900091 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:42:09.900204 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:42:09.901945 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
16:42:09.907072 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
16:42:09.907212 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
16:42:09.907424 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
16:42:09.909033 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:42:09.909391 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
16:42:09.907599 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
16:42:09.909260 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:09.909631 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:42:09.910649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:09.910767 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
16:42:09.914685 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:09.914788 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:42:09.910849 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:09.912743 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:42:09.921035 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
16:42:09.923105 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:09.923199 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:42:09.921574 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
16:42:09.923966 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:09.925043 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:09.925137 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:09.925211 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:09.921296 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
16:42:09.925316 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
16:42:09.925374 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
16:42:09.924091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:09.926329 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
16:42:09.926449 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:42:09.926522 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
16:42:09.927796 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:42:09.931978 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
16:42:09.932131 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
16:42:09.932256 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
16:42:09.933201 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:09.933294 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:42:09.933424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:42:09.933528 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:09.934345 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
16:42:09.936621 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop table if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
16:42:09.935672 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:09.937454 [debug] [Thread-3  ]: finished collecting timing info
16:42:09.937577 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
16:42:09.937987 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813c7acd00>]}
16:42:09.938238 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.05s]
16:42:09.938367 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:09.939265 [debug] [Thread-1  ]: finished collecting timing info
16:42:09.939402 [debug] [Thread-1  ]: On model.first_project.costumers: Close
16:42:09.939679 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
16:42:09.936398 [debug] [Thread-2  ]: finished collecting timing info
16:42:09.940237 [debug] [Thread-2  ]: On model.first_project.costumers2: Close
16:42:09.940515 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d4dd6d0>]}
16:42:09.940857 [info ] [Thread-2  ]: 2 of 4 OK created table model public.costumers2 ................................ [[32mSELECT 100[0m in 0.09s]
16:42:09.941170 [debug] [Thread-2  ]: Finished running node model.first_project.costumers2
16:42:09.941482 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
16:42:09.941696 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
16:42:09.942007 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:42:09.942354 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
16:42:09.942595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813c7b8550>]}
16:42:09.942696 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
16:42:09.943092 [info ] [Thread-1  ]: 1 of 4 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.10s]
16:42:09.944611 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:42:09.945951 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
16:42:09.946380 [debug] [Thread-5  ]: finished collecting timing info
16:42:09.946713 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
16:42:09.948364 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:42:09.948702 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:09.948811 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
16:42:09.948881 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:42:09.953399 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
16:42:09.953555 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:09.953622 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:42:09.954547 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:09.956076 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:09.956174 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:42:09.956442 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:09.957158 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:09.957244 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:09.957302 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:09.958770 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
16:42:09.959834 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:09.959966 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:42:09.960300 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
16:42:09.962775 [debug] [Thread-5  ]: finished collecting timing info
16:42:09.963075 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
16:42:09.963693 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bb5d6e7-b823-4046-8587-620071040d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813c7540d0>]}
16:42:09.964382 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:42:09.964766 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
16:42:09.967106 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:09.967331 [debug] [MainThread]: Using postgres connection "master"
16:42:09.967412 [debug] [MainThread]: On master: BEGIN
16:42:09.967477 [debug] [MainThread]: Opening a new connection, currently in state closed
16:42:09.972632 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:42:09.972860 [debug] [MainThread]: On master: COMMIT
16:42:09.972938 [debug] [MainThread]: Using postgres connection "master"
16:42:09.973001 [debug] [MainThread]: On master: COMMIT
16:42:09.973221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:09.973345 [debug] [MainThread]: On master: Close
16:42:09.973767 [info ] [MainThread]: 
16:42:09.974006 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.19s.
16:42:09.974162 [debug] [MainThread]: Connection 'master' was properly closed.
16:42:09.974232 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
16:42:09.974295 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
16:42:09.974357 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:42:09.974450 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:42:09.980366 [info ] [MainThread]: 
16:42:09.980954 [info ] [MainThread]: [32mCompleted successfully[0m
16:42:09.981285 [info ] [MainThread]: 
16:42:09.982121 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
16:42:09.982424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d5002e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813d500a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813cff0fa0>]}


============================== 2022-06-04 17:02:31.863380 | 7d4d363f-2eef-436e-98dd-746851c71102 ==============================
17:02:31.863396 [info ] [MainThread]: Running with dbt=1.1.0
17:02:31.863762 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:02:31.863850 [debug] [MainThread]: Tracking: tracking
17:02:31.867459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21476bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21476bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21476bd60>]}
17:02:31.888184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:02:31.888821 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/schema.yml
17:02:31.902117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21461b0d0>]}
17:02:31.905922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2146c1fa0>]}
17:02:31.906512 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
17:02:31.906731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2146c1ee0>]}
17:02:31.907761 [info ] [MainThread]: 
17:02:31.908132 [debug] [MainThread]: Acquiring new postgres connection "master"
17:02:31.908934 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:02:31.916491 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:02:31.916656 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:02:31.916761 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:02:31.922928 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:02:31.924017 [debug] [ThreadPool]: On list_erp_oltp: Close
17:02:31.926629 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:02:31.936234 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:02:31.936439 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:02:31.936505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:02:31.941425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:02:31.941784 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:02:31.941901 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:02:31.943702 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:02:31.945643 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:02:31.946008 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:02:31.948720 [debug] [MainThread]: Using postgres connection "master"
17:02:31.948824 [debug] [MainThread]: On master: BEGIN
17:02:31.948892 [debug] [MainThread]: Opening a new connection, currently in state init
17:02:31.954383 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:02:31.954624 [debug] [MainThread]: Using postgres connection "master"
17:02:31.954721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:02:31.964369 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:02:31.965649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2146c1700>]}
17:02:31.965974 [debug] [MainThread]: On master: ROLLBACK
17:02:31.966444 [debug] [MainThread]: Using postgres connection "master"
17:02:31.966633 [debug] [MainThread]: On master: BEGIN
17:02:31.967256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:02:31.967389 [debug] [MainThread]: On master: COMMIT
17:02:31.967466 [debug] [MainThread]: Using postgres connection "master"
17:02:31.967527 [debug] [MainThread]: On master: COMMIT
17:02:31.967880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:02:31.968006 [debug] [MainThread]: On master: Close
17:02:31.968444 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:02:31.968645 [info ] [MainThread]: 
17:02:31.975550 [debug] [Thread-1  ]: Began running node model.first_project.costumers
17:02:31.975823 [info ] [Thread-1  ]: 1 of 4 START view model public.costumers ....................................... [RUN]
17:02:31.976251 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
17:02:31.976371 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
17:02:31.976477 [debug] [Thread-1  ]: Compiling model.first_project.costumers
17:02:32.021370 [debug] [Thread-2  ]: Began running node model.first_project.costumers2
17:02:32.021747 [info ] [Thread-2  ]: 2 of 4 START table model public.costumers2 ..................................... [RUN]
17:02:32.021964 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:02:32.022167 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
17:02:32.022748 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:02:32.022924 [debug] [Thread-2  ]: Began compiling node model.first_project.costumers2
17:02:32.023048 [debug] [Thread-2  ]: Compiling model.first_project.costumers2
17:02:32.025562 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.costumers2"
17:02:32.025931 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:02:32.026123 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:02:32.026261 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:02:32.028855 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:02:32.029705 [debug] [Thread-2  ]: finished collecting timing info
17:02:32.029971 [debug] [Thread-2  ]: Began executing node model.first_project.costumers2
17:02:32.037438 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
17:02:32.038000 [debug] [Thread-3  ]: finished collecting timing info
17:02:32.044460 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:02:32.064208 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:02:32.064545 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:02:32.065602 [debug] [Thread-1  ]: finished collecting timing info
17:02:32.066392 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
17:02:32.066235 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:32.076959 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:02:32.077118 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:02:32.065930 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:02:32.079119 [debug] [Thread-2  ]: On model.first_project.costumers2: BEGIN
17:02:32.078912 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
17:02:32.079224 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:02:32.080264 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:02:32.080373 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
17:02:32.080445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:02:32.082211 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:02:32.082353 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:32.082418 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:02:32.083640 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
17:02:32.088382 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:32.088570 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:02:32.088948 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:02:32.089130 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.089357 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:02:32.089503 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:02:32.091911 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:02:32.091995 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:02:32.091437 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:32.091695 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:02:32.092128 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:02:32.092532 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.100158 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:02:32.100382 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.01 seconds
17:02:32.100553 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:02:32.102391 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:02:32.100749 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:32.104018 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:02:32.104272 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
17:02:32.104568 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
17:02:32.104461 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:02:32.105881 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.107759 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:02:32.107853 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
17:02:32.107971 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.109196 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:02:32.109385 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:02:32.109718 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.109852 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.110782 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
17:02:32.111945 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:02:32.112084 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
17:02:32.111715 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
17:02:32.110858 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:02:32.112283 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:02:32.115300 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:32.115884 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:02:32.115784 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:02:32.115528 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
17:02:32.116751 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:02:32.117436 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
17:02:32.118124 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:02:32.119080 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:02:32.119170 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:02:32.119586 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:02:32.120360 [debug] [Thread-3  ]: finished collecting timing info
17:02:32.120443 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:02:32.121387 [debug] [Thread-2  ]: finished collecting timing info
17:02:32.121520 [debug] [Thread-2  ]: On model.first_project.costumers2: Close
17:02:32.120566 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:02:32.121666 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:02:32.121959 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb214675be0>]}
17:02:32.129318 [debug] [Thread-1  ]: finished collecting timing info
17:02:32.130124 [info ] [Thread-2  ]: 2 of 4 OK created table model public.costumers2 ................................ [[32mSELECT 100[0m in 0.10s]
17:02:32.130672 [debug] [Thread-1  ]: On model.first_project.costumers: Close
17:02:32.131181 [debug] [Thread-2  ]: Finished running node model.first_project.costumers2
17:02:32.131466 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215f33190>]}
17:02:32.131974 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:02:32.132236 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:02:32.133246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21461b2e0>]}
17:02:32.133566 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:02:32.133869 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:02:32.134158 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:02:32.134248 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:02:32.134327 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:02:32.135803 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:02:32.136065 [debug] [Thread-5  ]: finished collecting timing info
17:02:32.136203 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:02:32.137502 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:02:32.137932 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:32.138152 [info ] [Thread-1  ]: 1 of 4 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.16s]
17:02:32.138305 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:02:32.138610 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
17:02:32.138739 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:02:32.150856 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:02:32.151128 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:32.151255 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:02:32.152310 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:02:32.153834 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:32.153924 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:02:32.154235 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:32.156406 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:02:32.156626 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:32.156694 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:02:32.159828 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:02:32.162083 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:32.162361 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:02:32.162854 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:02:32.164327 [debug] [Thread-5  ]: finished collecting timing info
17:02:32.164473 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:02:32.170082 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d4d363f-2eef-436e-98dd-746851c71102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb210527e50>]}
17:02:32.170398 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:02:32.170778 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:02:32.176193 [debug] [MainThread]: Acquiring new postgres connection "master"
17:02:32.176539 [debug] [MainThread]: Using postgres connection "master"
17:02:32.176664 [debug] [MainThread]: On master: BEGIN
17:02:32.176734 [debug] [MainThread]: Opening a new connection, currently in state closed
17:02:32.181730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:02:32.181934 [debug] [MainThread]: On master: COMMIT
17:02:32.182005 [debug] [MainThread]: Using postgres connection "master"
17:02:32.182067 [debug] [MainThread]: On master: COMMIT
17:02:32.182341 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:02:32.182468 [debug] [MainThread]: On master: Close
17:02:32.182812 [info ] [MainThread]: 
17:02:32.183033 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.27s.
17:02:32.183177 [debug] [MainThread]: Connection 'master' was properly closed.
17:02:32.183294 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:02:32.183375 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:02:32.183439 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:02:32.183498 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:02:32.186454 [info ] [MainThread]: 
17:02:32.186741 [info ] [MainThread]: [32mCompleted successfully[0m
17:02:32.186924 [info ] [MainThread]: 
17:02:32.187059 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:02:32.187294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2146c1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2146c1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb21053e670>]}


============================== 2022-06-04 17:03:41.815636 | 4dfe7648-8472-4716-90b3-4d655701722d ==============================
17:03:41.815658 [info ] [MainThread]: Running with dbt=1.1.0
17:03:41.816465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:41.816602 [debug] [MainThread]: Tracking: tracking
17:03:41.819175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d3454c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d345d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d3456d0>]}
17:03:41.838495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:03:41.838797 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/postgres_sample_source/schema.yml
17:03:41.865826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d1f6f40>]}
17:03:41.869153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d2abbb0>]}
17:03:41.869636 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:03:41.869888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d2abe20>]}
17:03:41.871196 [info ] [MainThread]: 
17:03:41.871634 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:41.872447 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:03:41.889309 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:03:41.889588 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:03:41.889673 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:03:41.897560 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:03:41.898579 [debug] [ThreadPool]: On list_erp_oltp: Close
17:03:41.899666 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:03:41.903646 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:41.903835 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:03:41.903916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:03:41.908046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:03:41.908229 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:41.908319 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:03:41.910518 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:03:41.912243 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:03:41.912734 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:03:41.917212 [debug] [MainThread]: Using postgres connection "master"
17:03:41.917391 [debug] [MainThread]: On master: BEGIN
17:03:41.917462 [debug] [MainThread]: Opening a new connection, currently in state init
17:03:41.921623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:03:41.921863 [debug] [MainThread]: Using postgres connection "master"
17:03:41.921991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:03:41.931628 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:03:41.932698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d356730>]}
17:03:41.932937 [debug] [MainThread]: On master: ROLLBACK
17:03:41.933355 [debug] [MainThread]: Using postgres connection "master"
17:03:41.933496 [debug] [MainThread]: On master: BEGIN
17:03:41.934062 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:03:41.934170 [debug] [MainThread]: On master: COMMIT
17:03:41.934240 [debug] [MainThread]: Using postgres connection "master"
17:03:41.934299 [debug] [MainThread]: On master: COMMIT
17:03:41.934610 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:41.934741 [debug] [MainThread]: On master: Close
17:03:41.935034 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:03:41.935195 [info ] [MainThread]: 
17:03:41.986483 [debug] [Thread-1  ]: Began running node model.first_project.costumers
17:03:41.986744 [info ] [Thread-1  ]: 1 of 4 START view model public.costumers ....................................... [RUN]
17:03:41.987052 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
17:03:41.987159 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
17:03:41.987244 [debug] [Thread-1  ]: Compiling model.first_project.costumers
17:03:41.988132 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
17:03:41.988390 [debug] [Thread-1  ]: finished collecting timing info
17:03:41.988527 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
17:03:41.995224 [debug] [Thread-2  ]: Began running node model.first_project.costumers2
17:03:41.995492 [info ] [Thread-2  ]: 2 of 4 START table model public.costumers2 ..................................... [RUN]
17:03:41.995858 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:03:41.995965 [debug] [Thread-2  ]: Began compiling node model.first_project.costumers2
17:03:41.996067 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:03:41.996227 [debug] [Thread-2  ]: Compiling model.first_project.costumers2
17:03:42.008881 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
17:03:42.010893 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.costumers2"
17:03:42.013690 [debug] [Thread-2  ]: finished collecting timing info
17:03:42.012886 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:03:42.013917 [debug] [Thread-2  ]: Began executing node model.first_project.costumers2
17:03:42.012082 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
17:03:42.014117 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:03:42.029575 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:03:42.029841 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:03:42.031686 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:03:42.031902 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:03:42.032048 [debug] [Thread-2  ]: On model.first_project.costumers2: BEGIN
17:03:42.032135 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:03:42.032462 [debug] [Thread-3  ]: finished collecting timing info
17:03:42.032626 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:03:42.037879 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:03:42.038386 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:42.038692 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:03:42.038790 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:03:42.038616 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:03:42.039304 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
17:03:42.039405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:03:42.041236 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:03:42.041416 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:03:42.041488 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:03:42.043719 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
17:03:42.048870 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:03:42.049028 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
17:03:42.049389 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.049561 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:03:42.051466 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:03:42.051238 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:03:42.051560 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:03:42.049682 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:03:42.051675 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
17:03:42.051940 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:42.052187 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:03:42.052433 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.059606 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
17:03:42.059807 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:03:42.059916 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
17:03:42.060039 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:03:42.062326 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:03:42.062463 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
17:03:42.062637 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
17:03:42.064915 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:42.065059 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:03:42.065487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.065645 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:03:42.066793 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:03:42.069768 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:03:42.069923 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:03:42.070078 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.071783 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:42.071981 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:03:42.070263 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
17:03:42.072146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.072922 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
17:03:42.073016 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:03:42.073083 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
17:03:42.073515 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.074653 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:42.074754 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:42.074828 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:42.075515 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:03:42.076675 [debug] [Thread-2  ]: finished collecting timing info
17:03:42.075676 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:03:42.076866 [debug] [Thread-2  ]: On model.first_project.costumers2: Close
17:03:42.083940 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d2d3be0>]}
17:03:42.083251 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:03:42.085211 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:42.085415 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:03:42.082827 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:03:42.086365 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:03:42.090040 [info ] [Thread-2  ]: 2 of 4 OK created table model public.costumers2 ................................ [[32mSELECT 100[0m in 0.09s]
17:03:42.090458 [debug] [Thread-2  ]: Finished running node model.first_project.costumers2
17:03:42.095673 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
17:03:42.096857 [debug] [Thread-1  ]: finished collecting timing info
17:03:42.097058 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
17:03:42.097282 [debug] [Thread-1  ]: On model.first_project.costumers: Close
17:03:42.098127 [debug] [Thread-3  ]: finished collecting timing info
17:03:42.098482 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:03:42.098828 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d1a3040>]}
17:03:42.099097 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
17:03:42.099359 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:03:42.099663 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:03:42.099819 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:03:42.100087 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:03:42.100180 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:03:42.100250 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:03:42.104119 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:03:42.105348 [debug] [Thread-5  ]: finished collecting timing info
17:03:42.105571 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:03:42.112184 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:03:42.113163 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d33f070>]}
17:03:42.113648 [info ] [Thread-1  ]: 1 of 4 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.13s]
17:03:42.114114 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
17:03:42.114611 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:42.114723 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:03:42.114796 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:03:42.120841 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:03:42.121077 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:42.121183 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:03:42.122231 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:03:42.123772 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:42.123921 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:03:42.124240 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:42.125131 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:42.125238 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:42.125298 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:42.126599 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:03:42.128045 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:42.128163 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:03:42.128454 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:03:42.129195 [debug] [Thread-5  ]: finished collecting timing info
17:03:42.132866 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:03:42.134316 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4dfe7648-8472-4716-90b3-4d655701722d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d1a21c0>]}
17:03:42.135693 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:03:42.136122 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:03:42.137345 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:42.137464 [debug] [MainThread]: Using postgres connection "master"
17:03:42.137528 [debug] [MainThread]: On master: BEGIN
17:03:42.137586 [debug] [MainThread]: Opening a new connection, currently in state closed
17:03:42.143147 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:03:42.143350 [debug] [MainThread]: On master: COMMIT
17:03:42.143426 [debug] [MainThread]: Using postgres connection "master"
17:03:42.143488 [debug] [MainThread]: On master: COMMIT
17:03:42.143764 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:42.143913 [debug] [MainThread]: On master: Close
17:03:42.144255 [info ] [MainThread]: 
17:03:42.144404 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.27s.
17:03:42.144513 [debug] [MainThread]: Connection 'master' was properly closed.
17:03:42.144589 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:03:42.144642 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:03:42.144691 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:03:42.144738 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:03:42.147698 [info ] [MainThread]: 
17:03:42.147941 [info ] [MainThread]: [32mCompleted successfully[0m
17:03:42.148115 [info ] [MainThread]: 
17:03:42.148231 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:03:42.148403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057f518c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d1d2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d1d3310>]}


============================== 2022-06-04 17:10:27.128916 | 0733badf-c666-45f2-9930-f056945b9f0a ==============================
17:10:27.128929 [info ] [MainThread]: Running with dbt=1.1.0
17:10:27.129357 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:10:27.129494 [debug] [MainThread]: Tracking: tracking
17:10:27.132282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24415a070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24415a040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa24415a2b0>]}
17:10:27.157068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:10:27.157412 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
17:10:27.166722 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:10:27.181220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa243c1e0d0>]}
17:10:27.185490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2440b1c10>]}
17:10:27.185848 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:10:27.186040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2440b1e20>]}
17:10:27.187106 [info ] [MainThread]: 
17:10:27.187485 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:27.188281 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:10:27.195638 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:10:27.195850 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:10:27.195948 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:27.207835 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:10:27.209180 [debug] [ThreadPool]: On list_erp_oltp: Close
17:10:27.211341 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:10:27.221222 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:27.221512 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:10:27.221634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:10:27.228096 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:10:27.228324 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:27.228452 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:10:27.229918 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:10:27.230902 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:10:27.231315 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:10:27.264200 [debug] [MainThread]: Using postgres connection "master"
17:10:27.264411 [debug] [MainThread]: On master: BEGIN
17:10:27.265533 [debug] [MainThread]: Opening a new connection, currently in state init
17:10:27.269875 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:27.270024 [debug] [MainThread]: Using postgres connection "master"
17:10:27.270090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:10:27.280056 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:10:27.281166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2459e0850>]}
17:10:27.281434 [debug] [MainThread]: On master: ROLLBACK
17:10:27.281694 [debug] [MainThread]: Using postgres connection "master"
17:10:27.281907 [debug] [MainThread]: On master: BEGIN
17:10:27.282191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:27.282284 [debug] [MainThread]: On master: COMMIT
17:10:27.282350 [debug] [MainThread]: Using postgres connection "master"
17:10:27.282408 [debug] [MainThread]: On master: COMMIT
17:10:27.282517 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:27.282602 [debug] [MainThread]: On master: Close
17:10:27.282958 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:10:27.283128 [info ] [MainThread]: 
17:10:27.287855 [debug] [Thread-1  ]: Began running node model.first_project.costumers
17:10:27.288066 [info ] [Thread-1  ]: 1 of 5 START view model public.costumers ....................................... [RUN]
17:10:27.288358 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.costumers"
17:10:27.288497 [debug] [Thread-2  ]: Began running node model.first_project.costumers2
17:10:27.288690 [debug] [Thread-1  ]: Began compiling node model.first_project.costumers
17:10:27.289210 [debug] [Thread-1  ]: Compiling model.first_project.costumers
17:10:27.288786 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:10:27.290333 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
17:10:27.290059 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.costumers"
17:10:27.289020 [info ] [Thread-2  ]: 2 of 5 START table model public.costumers2 ..................................... [RUN]
17:10:27.288857 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
17:10:27.291154 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:10:27.292024 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:10:27.291819 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
17:10:27.292214 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:10:27.291474 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:10:27.298038 [debug] [Thread-2  ]: Began compiling node model.first_project.costumers2
17:10:27.298150 [debug] [Thread-2  ]: Compiling model.first_project.costumers2
17:10:27.299679 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.costumers2"
17:10:27.299957 [debug] [Thread-2  ]: finished collecting timing info
17:10:27.300067 [debug] [Thread-2  ]: Began executing node model.first_project.costumers2
17:10:27.292629 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:10:27.307691 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:10:27.307817 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
17:10:27.294456 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:10:27.314212 [debug] [Thread-3  ]: finished collecting timing info
17:10:27.314427 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:10:27.292726 [debug] [Thread-1  ]: finished collecting timing info
17:10:27.309463 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:10:27.337580 [debug] [Thread-1  ]: Began executing node model.first_project.costumers
17:10:27.339311 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:10:27.351891 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:10:27.353617 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.costumers"
17:10:27.353910 [debug] [Thread-4  ]: finished collecting timing info
17:10:27.354625 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
17:10:27.356029 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:10:27.354137 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:10:27.356184 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:10:27.356442 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:27.356960 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:10:27.357074 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:10:27.356763 [debug] [Thread-1  ]: On model.first_project.costumers: BEGIN
17:10:27.357241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:10:27.356542 [debug] [Thread-2  ]: On model.first_project.costumers2: BEGIN
17:10:27.357843 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:10:27.356650 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:27.358168 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:10:27.358238 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:10:27.363198 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:10:27.363404 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:27.363492 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:10:27.367121 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
17:10:27.372082 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:27.372244 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:10:27.373153 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:10:27.373354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:10:27.373507 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:10:27.373922 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:10:27.374068 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:10:27.374159 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.374405 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:10:27.380624 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.01 seconds
17:10:27.382381 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:10:27.382484 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
17:10:27.382781 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:10:27.382885 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:27.382992 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:10:27.383088 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.384718 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:10:27.384885 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
17:10:27.385858 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.389300 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
17:10:27.389410 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:10:27.389489 [debug] [Thread-2  ]: On model.first_project.costumers2: COMMIT
17:10:27.380323 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:27.389607 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:27.389676 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:27.398189 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.02 seconds
17:10:27.400077 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:27.400208 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:10:27.400317 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
17:10:27.400606 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:10:27.402247 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:10:27.402476 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.406794 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:27.406922 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:10:27.405551 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
17:10:27.402579 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
17:10:27.405420 [debug] [Thread-2  ]: Using postgres connection "model.first_project.costumers2"
17:10:27.408029 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:27.408261 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.408418 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.408618 [debug] [Thread-2  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
17:10:27.408795 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:10:27.410082 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:27.413166 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:27.412955 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:27.414158 [debug] [Thread-4  ]: finished collecting timing info
17:10:27.414281 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
17:10:27.413298 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:27.415624 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa243c2d640>]}
17:10:27.416140 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:10:27.412349 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:10:27.416413 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:10:27.416641 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
17:10:27.417212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.418153 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
17:10:27.418297 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:10:27.418433 [debug] [Thread-1  ]: On model.first_project.costumers: COMMIT
17:10:27.419392 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
17:10:27.420267 [debug] [Thread-2  ]: finished collecting timing info
17:10:27.420366 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:10:27.420482 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:10:27.422759 [debug] [Thread-1  ]: Using postgres connection "model.first_project.costumers"
17:10:27.422856 [debug] [Thread-1  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:10:27.421717 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:27.423000 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:10:27.420667 [debug] [Thread-2  ]: On model.first_project.costumers2: Close
17:10:27.423991 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2463293a0>]}
17:10:27.424311 [info ] [Thread-2  ]: 2 of 5 OK created table model public.costumers2 ................................ [[32mSELECT 100[0m in 0.13s]
17:10:27.425615 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:27.426707 [debug] [Thread-1  ]: finished collecting timing info
17:10:27.434014 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
17:10:27.435056 [debug] [Thread-3  ]: finished collecting timing info
17:10:27.435194 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:10:27.437144 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2463290d0>]}
17:10:27.437508 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
17:10:27.437945 [debug] [Thread-2  ]: Finished running node model.first_project.costumers2
17:10:27.426843 [debug] [Thread-1  ]: On model.first_project.costumers: Close
17:10:27.438481 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:10:27.440421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa243b80910>]}
17:10:27.440783 [info ] [Thread-1  ]: 1 of 5 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.15s]
17:10:27.441187 [debug] [Thread-1  ]: Finished running node model.first_project.costumers
17:10:27.441794 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:10:27.442023 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
17:10:27.442394 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:10:27.442509 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:10:27.442613 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:10:27.444668 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:10:27.445015 [debug] [Thread-6  ]: finished collecting timing info
17:10:27.445178 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:10:27.449048 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:10:27.449584 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:27.449767 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:10:27.449845 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:10:27.454451 [debug] [Thread-6  ]: SQL status: BEGIN in 0.0 seconds
17:10:27.454645 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:27.454725 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:10:27.455680 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:10:27.458157 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:27.458278 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:10:27.458574 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:27.459646 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:27.459860 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:27.459919 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:27.461422 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:10:27.463245 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:27.463366 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:10:27.463656 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:27.464535 [debug] [Thread-6  ]: finished collecting timing info
17:10:27.464689 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:10:27.465129 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0733badf-c666-45f2-9930-f056945b9f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2402b5760>]}
17:10:27.465407 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
17:10:27.465744 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:10:27.467938 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:27.468079 [debug] [MainThread]: Using postgres connection "master"
17:10:27.468144 [debug] [MainThread]: On master: BEGIN
17:10:27.468200 [debug] [MainThread]: Opening a new connection, currently in state closed
17:10:27.472987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:27.473185 [debug] [MainThread]: On master: COMMIT
17:10:27.473266 [debug] [MainThread]: Using postgres connection "master"
17:10:27.473325 [debug] [MainThread]: On master: COMMIT
17:10:27.473568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:27.473709 [debug] [MainThread]: On master: Close
17:10:27.474085 [info ] [MainThread]: 
17:10:27.474262 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0.29s.
17:10:27.474381 [debug] [MainThread]: Connection 'master' was properly closed.
17:10:27.474440 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:10:27.474493 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:10:27.474548 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:10:27.475557 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:10:27.475677 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:10:27.482789 [info ] [MainThread]: 
17:10:27.483125 [info ] [MainThread]: [32mCompleted successfully[0m
17:10:27.483295 [info ] [MainThread]: 
17:10:27.483473 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:10:27.483763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa246073ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2462c9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2459695b0>]}


============================== 2022-06-04 17:20:35.709217 | ce674621-70a8-4ee5-95b5-6a99f1c32af4 ==============================
17:20:35.709238 [info ] [MainThread]: Running with dbt=1.1.0
17:20:35.709794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:20:35.709955 [debug] [MainThread]: Tracking: tracking
17:20:35.712950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3493ab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3493a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3493a940>]}
17:20:35.737941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
17:20:35.738262 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_custumers.sql
17:20:35.738528 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
17:20:35.738669 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers2.sql
17:20:35.749331 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_custumers.sql
17:20:35.758751 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
17:20:35.761334 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers2.sql
17:20:35.768950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d344070d0>]}
17:20:35.772493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3489ebb0>]}
17:20:35.772854 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:20:35.773047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d348afd00>]}
17:20:35.774405 [info ] [MainThread]: 
17:20:35.774805 [debug] [MainThread]: Acquiring new postgres connection "master"
17:20:35.775902 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:20:35.781826 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:20:35.781937 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:20:35.782007 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:20:35.791440 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:20:35.792799 [debug] [ThreadPool]: On list_erp_oltp: Close
17:20:35.794877 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:20:35.799178 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:20:35.799327 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:20:35.799395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:20:35.807641 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:20:35.807895 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:20:35.807970 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:20:35.810081 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:20:35.811194 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:20:35.811609 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:20:35.843749 [debug] [MainThread]: Using postgres connection "master"
17:20:35.843948 [debug] [MainThread]: On master: BEGIN
17:20:35.844020 [debug] [MainThread]: Opening a new connection, currently in state init
17:20:35.848266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:35.848458 [debug] [MainThread]: Using postgres connection "master"
17:20:35.848535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:20:35.876532 [debug] [MainThread]: SQL status: SELECT 4 in 0.03 seconds
17:20:35.877480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3493a940>]}
17:20:35.877831 [debug] [MainThread]: On master: ROLLBACK
17:20:35.878199 [debug] [MainThread]: Using postgres connection "master"
17:20:35.878301 [debug] [MainThread]: On master: BEGIN
17:20:35.878833 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:20:35.878935 [debug] [MainThread]: On master: COMMIT
17:20:35.879002 [debug] [MainThread]: Using postgres connection "master"
17:20:35.879055 [debug] [MainThread]: On master: COMMIT
17:20:35.879283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:20:35.879414 [debug] [MainThread]: On master: Close
17:20:35.879778 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:20:35.879946 [info ] [MainThread]: 
17:20:35.885569 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:20:35.885859 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:20:35.886158 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:20:35.886277 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:20:35.886392 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:20:35.886591 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:20:35.888402 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:20:35.886898 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:20:35.886683 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
17:20:35.888957 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.889298 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_custumers ................................... [RUN]
17:20:35.889828 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
17:20:35.889912 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
17:20:35.889976 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
17:20:35.889468 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:20:35.891054 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:20:35.890814 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
17:20:35.896574 [debug] [Thread-3  ]: finished collecting timing info
17:20:35.895965 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:20:35.896764 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
17:20:35.889118 [debug] [Thread-1  ]: finished collecting timing info
17:20:35.913873 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:20:35.913752 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
17:20:35.919806 [debug] [Thread-2  ]: finished collecting timing info
17:20:35.931783 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:20:35.932034 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:20:35.933827 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:20:35.933981 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
17:20:35.935673 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:20:35.936030 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:20:35.936865 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.936982 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:20:35.937044 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:20:35.936287 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:35.937916 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:20:35.938019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:20:35.943842 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:20:35.944085 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:20:35.944199 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)

select * from customers
  );
17:20:35.944359 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:20:35.944559 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.944731 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:20:35.946724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:20:35.946867 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:35.946943 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:20:35.947123 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:20:35.951597 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:20:35.951755 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:20:35.951860 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:20:35.953892 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:35.956214 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:20:35.955952 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.952014 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
17:20:35.956516 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:20:35.957254 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:35.962160 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:20:35.962354 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:35.962481 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:20:35.965606 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:35.962679 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:20:35.967573 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:20:35.967432 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:20:35.967195 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.968003 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:20:35.969860 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:35.970928 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:20:35.971102 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.971217 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:35.971307 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:20:35.971386 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:20:35.976479 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:20:35.980236 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:35.980377 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:20:35.979865 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:20:35.980648 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
17:20:35.981129 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:35.982530 [debug] [Thread-3  ]: finished collecting timing info
17:20:35.982774 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:20:35.982964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:20:35.985509 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:20:35.984223 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:20:35.983109 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
17:20:35.985645 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:20:35.985901 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:20:35.986416 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36b1e2e0>]}
17:20:35.988650 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.10s]
17:20:35.989185 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
17:20:35.989695 [debug] [Thread-5  ]: Began running node model.first_project.costumers
17:20:35.990011 [info ] [Thread-5  ]: 4 of 6 START view model public.costumers ....................................... [RUN]
17:20:35.990381 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.costumers"
17:20:35.990475 [debug] [Thread-5  ]: Began compiling node model.first_project.costumers
17:20:35.990563 [debug] [Thread-5  ]: Compiling model.first_project.costumers
17:20:35.992395 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.costumers"
17:20:35.993259 [debug] [Thread-6  ]: Began running node model.first_project.costumers2
17:20:35.993522 [info ] [Thread-6  ]: 5 of 6 START table model public.costumers2 ..................................... [RUN]
17:20:35.993951 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:20:35.994326 [debug] [Thread-6  ]: Began compiling node model.first_project.costumers2
17:20:35.994457 [debug] [Thread-6  ]: Compiling model.first_project.costumers2
17:20:35.997184 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.costumers2"
17:20:35.997985 [debug] [Thread-5  ]: finished collecting timing info
17:20:35.998157 [debug] [Thread-5  ]: Began executing node model.first_project.costumers
17:20:36.000217 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.costumers"
17:20:36.000559 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:20:36.000769 [debug] [Thread-5  ]: On model.first_project.costumers: BEGIN
17:20:36.000876 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:20:36.004556 [debug] [Thread-6  ]: finished collecting timing info
17:20:36.004867 [debug] [Thread-6  ]: Began executing node model.first_project.costumers2
17:20:36.007134 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:20:36.007342 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:20:36.007549 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:20:36.008833 [debug] [Thread-1  ]: finished collecting timing info
17:20:36.010593 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:20:36.010202 [debug] [Thread-2  ]: finished collecting timing info
17:20:36.010328 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:20:36.011356 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:20:36.011445 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:20:36.011236 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:20:36.011042 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d34373fa0>]}
17:20:36.012958 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:20:36.009238 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:20:36.013910 [debug] [Thread-6  ]: On model.first_project.costumers2: BEGIN
17:20:36.013634 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36b11c40>]}
17:20:36.014011 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:20:36.013339 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:20:36.015520 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:20:36.015689 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:20:36.016048 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:20:36.016134 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:20:36.016212 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:20:36.020065 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:20:36.020538 [debug] [Thread-8  ]: finished collecting timing info
17:20:36.020891 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:20:36.023075 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:20:36.023405 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:36.014264 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:20:36.024411 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.01 seconds
17:20:36.025139 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:20:36.028598 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:20:36.029094 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:20:36.025601 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:20:36.029314 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:20:36.029562 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers" rename to "costumers__dbt_backup"
17:20:36.029965 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:20:36.030184 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:20:36.031471 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:36.034485 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:20:36.035603 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:20:36.036280 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:36.037167 [debug] [Thread-5  ]: On model.first_project.costumers: COMMIT
17:20:36.037313 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:20:36.037394 [debug] [Thread-5  ]: On model.first_project.costumers: COMMIT
17:20:36.037527 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
17:20:36.039380 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:20:36.039519 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
17:20:36.039668 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:20:36.041057 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:20:36.041192 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:20:36.041360 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:36.043602 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:20:36.043781 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
17:20:36.044070 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:36.046357 [debug] [Thread-5  ]: finished collecting timing info
17:20:36.046579 [debug] [Thread-5  ]: On model.first_project.costumers: Close
17:20:36.046779 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:36.048629 [debug] [Thread-6  ]: On model.first_project.costumers2: COMMIT
17:20:36.048805 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:20:36.048891 [debug] [Thread-6  ]: On model.first_project.costumers2: COMMIT
17:20:36.057069 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d34301df0>]}
17:20:36.057510 [info ] [Thread-5  ]: 4 of 6 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.07s]
17:20:36.057908 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:20:36.058473 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
17:20:36.061304 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:36.061462 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:20:36.061961 [debug] [Thread-5  ]: Finished running node model.first_project.costumers
17:20:36.060932 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:20:36.062266 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
17:20:36.063057 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:20:36.068639 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:36.068885 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:20:36.070194 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
17:20:36.072023 [debug] [Thread-6  ]: finished collecting timing info
17:20:36.072228 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:20:36.072447 [debug] [Thread-6  ]: On model.first_project.costumers2: Close
17:20:36.073460 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:20:36.073798 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:36.073927 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:20:36.076292 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d34311640>]}
17:20:36.076986 [info ] [Thread-6  ]: 5 of 6 OK created table model public.costumers2 ................................ [[32mSELECT 100[0m in 0.08s]
17:20:36.077957 [debug] [Thread-6  ]: Finished running node model.first_project.costumers2
17:20:36.078148 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:20:36.079339 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:20:36.079441 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:20:36.079720 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:20:36.080613 [debug] [Thread-8  ]: finished collecting timing info
17:20:36.080762 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:20:36.081959 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce674621-70a8-4ee5-95b5-6a99f1c32af4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d34393160>]}
17:20:36.082192 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
17:20:36.082525 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:20:36.089271 [debug] [MainThread]: Acquiring new postgres connection "master"
17:20:36.089515 [debug] [MainThread]: Using postgres connection "master"
17:20:36.089625 [debug] [MainThread]: On master: BEGIN
17:20:36.089771 [debug] [MainThread]: Opening a new connection, currently in state closed
17:20:36.095926 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:20:36.096154 [debug] [MainThread]: On master: COMMIT
17:20:36.096241 [debug] [MainThread]: Using postgres connection "master"
17:20:36.096310 [debug] [MainThread]: On master: COMMIT
17:20:36.096466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:20:36.096575 [debug] [MainThread]: On master: Close
17:20:36.096924 [info ] [MainThread]: 
17:20:36.097099 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.32s.
17:20:36.097224 [debug] [MainThread]: Connection 'master' was properly closed.
17:20:36.097288 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:20:36.097347 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:20:36.097406 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
17:20:36.097463 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:20:36.097520 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:20:36.097576 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:20:36.103769 [info ] [MainThread]: 
17:20:36.104035 [info ] [MainThread]: [32mCompleted successfully[0m
17:20:36.104213 [info ] [MainThread]: 
17:20:36.104341 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:20:36.105641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d343e1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d3439b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d36b2feb0>]}


============================== 2022-06-04 17:37:29.798505 | 2d65711d-0b7d-4a02-ac79-5fe446d8c78f ==============================
17:37:29.798519 [info ] [MainThread]: Running with dbt=1.1.0
17:37:29.798997 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:37:29.799212 [debug] [MainThread]: Tracking: tracking
17:37:29.802389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acced6100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acced6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acced6e20>]}
17:37:29.828484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:37:29.828659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:37:29.832819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d65711d-0b7d-4a02-ac79-5fe446d8c78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acce020d0>]}
17:37:29.836431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d65711d-0b7d-4a02-ac79-5fe446d8c78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acce4de80>]}
17:37:29.839447 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:37:29.839755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d65711d-0b7d-4a02-ac79-5fe446d8c78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acce4ddf0>]}
17:37:29.841435 [info ] [MainThread]: 
17:37:29.842030 [debug] [MainThread]: Acquiring new postgres connection "master"
17:37:29.843140 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:37:29.850647 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:37:29.850806 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:37:29.850895 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:37:29.862994 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:37:29.863277 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:37:29.863413 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:37:29.868253 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:37:29.871420 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:37:29.871844 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:37:29.875865 [debug] [MainThread]: Using postgres connection "master"
17:37:29.876077 [debug] [MainThread]: On master: BEGIN
17:37:29.876155 [debug] [MainThread]: Opening a new connection, currently in state init
17:37:29.880010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:37:29.880203 [debug] [MainThread]: Using postgres connection "master"
17:37:29.880320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:37:29.890453 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:37:29.891703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d65711d-0b7d-4a02-ac79-5fe446d8c78f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acce4dbb0>]}
17:37:29.891969 [debug] [MainThread]: On master: ROLLBACK
17:37:29.892326 [debug] [MainThread]: Using postgres connection "master"
17:37:29.892440 [debug] [MainThread]: On master: BEGIN
17:37:29.892889 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:37:29.893002 [debug] [MainThread]: On master: COMMIT
17:37:29.893073 [debug] [MainThread]: Using postgres connection "master"
17:37:29.893131 [debug] [MainThread]: On master: COMMIT
17:37:29.893362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:37:29.893491 [debug] [MainThread]: On master: Close
17:37:29.893892 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:37:29.894122 [info ] [MainThread]: 
17:37:29.899172 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:37:29.899359 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:37:29.899761 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:37:29.899898 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:37:29.899993 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:37:29.909544 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:37:29.909690 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:37:29.910125 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
17:37:29.910427 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:37:29.910524 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:37:29.910604 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:37:29.909828 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:37:29.915494 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
17:37:29.915768 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:37:29.915861 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:37:29.915157 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:37:29.915961 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:37:29.914333 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:37:29.909967 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:37:29.925362 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:37:29.920940 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:37:29.925520 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:37:29.926018 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:37:29.925772 [debug] [Thread-1  ]: finished collecting timing info
17:37:29.931970 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:37:29.963618 [debug] [Thread-4  ]: finished collecting timing info
17:37:29.971675 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:37:29.977508 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:37:29.965636 [debug] [Thread-3  ]: finished collecting timing info
17:37:29.978046 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:37:29.979017 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:37:29.977880 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:37:29.965250 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:37:29.979750 [debug] [Thread-2  ]: finished collecting timing info
17:37:29.979842 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:37:29.979317 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:37:29.980906 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:37:29.980729 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:37:29.981222 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:37:29.981306 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:37:29.981363 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:37:29.979545 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:37:29.981753 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:37:29.981827 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:37:29.976329 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:37:29.982782 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:37:29.982975 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:37:29.983058 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:37:29.988135 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:37:29.988292 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:37:29.988365 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:37:29.988501 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:37:29.988620 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:37:29.988686 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:37:29.989408 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:37:29.991101 [debug] [Thread-4  ]: finished collecting timing info
17:37:29.991242 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:37:29.991402 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:37:29.992299 [debug] [Thread-2  ]: finished collecting timing info
17:37:29.992421 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:37:29.992544 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:37:29.992626 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:37:29.992696 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:37:29.992842 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:37:29.993146 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:37:29.993469 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:37:29.993651 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:37:29.994575 [debug] [Thread-3  ]: finished collecting timing info
17:37:29.994690 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:37:29.995527 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:37:29.995818 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
17:37:29.996069 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:37:29.996362 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:37:29.996587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:37:29.996916 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
17:37:29.997053 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:37:29.997364 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:37:29.997471 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:37:30.000058 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:37:30.001116 [debug] [Thread-1  ]: finished collecting timing info
17:37:30.001317 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:37:30.001532 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:37:30.001910 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
17:37:30.002292 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:37:30.003549 [debug] [MainThread]: Acquiring new postgres connection "master"
17:37:30.003674 [debug] [MainThread]: Using postgres connection "master"
17:37:30.003740 [debug] [MainThread]: On master: BEGIN
17:37:30.003804 [debug] [MainThread]: Opening a new connection, currently in state closed
17:37:30.014450 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:37:30.014745 [debug] [MainThread]: On master: COMMIT
17:37:30.014835 [debug] [MainThread]: Using postgres connection "master"
17:37:30.014902 [debug] [MainThread]: On master: COMMIT
17:37:30.015634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:37:30.015759 [debug] [MainThread]: On master: Close
17:37:30.016067 [info ] [MainThread]: 
17:37:30.016216 [info ] [MainThread]: Finished running 4 tests in 0.17s.
17:37:30.016327 [debug] [MainThread]: Connection 'master' was properly closed.
17:37:30.016383 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:37:30.016434 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:37:30.016484 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:37:30.016585 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:37:30.019692 [info ] [MainThread]: 
17:37:30.019891 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:37:30.020049 [info ] [MainThread]: 
17:37:30.020151 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:37:30.020257 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:37:30.020345 [info ] [MainThread]: 
17:37:30.020458 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:37:30.020600 [info ] [MainThread]: 
17:37:30.020705 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
17:37:30.020869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acce4d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aced98e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2acc53e460>]}


============================== 2022-06-04 17:44:21.489968 | 6930e74b-cee2-4ebf-8d75-3705399a68f3 ==============================
17:44:21.489983 [info ] [MainThread]: Running with dbt=1.1.0
17:44:21.490568 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:44:21.490720 [debug] [MainThread]: Tracking: tracking
17:44:21.493409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1b784c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1b78d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1b786d0>]}
17:44:21.524073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:44:21.524748 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/schema.yml
17:44:21.556535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6930e74b-cee2-4ebf-8d75-3705399a68f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a19ff0d0>]}
17:44:21.560185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6930e74b-cee2-4ebf-8d75-3705399a68f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1aeee50>]}
17:44:21.560435 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:44:21.560601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6930e74b-cee2-4ebf-8d75-3705399a68f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1aeedf0>]}
17:44:21.561957 [info ] [MainThread]: 
17:44:21.562332 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:21.563243 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:44:21.571770 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:44:21.571948 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:44:21.572040 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:44:21.582506 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:44:21.582711 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:44:21.582795 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:44:21.584349 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:44:21.585584 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:44:21.585861 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:44:21.593586 [debug] [MainThread]: Using postgres connection "master"
17:44:21.593813 [debug] [MainThread]: On master: BEGIN
17:44:21.593931 [debug] [MainThread]: Opening a new connection, currently in state init
17:44:21.598453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:21.598714 [debug] [MainThread]: Using postgres connection "master"
17:44:21.598923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:44:21.610788 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:44:21.611849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6930e74b-cee2-4ebf-8d75-3705399a68f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1b7f070>]}
17:44:21.612189 [debug] [MainThread]: On master: ROLLBACK
17:44:21.612645 [debug] [MainThread]: Using postgres connection "master"
17:44:21.612771 [debug] [MainThread]: On master: BEGIN
17:44:21.613234 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:21.613472 [debug] [MainThread]: On master: COMMIT
17:44:21.613583 [debug] [MainThread]: Using postgres connection "master"
17:44:21.613654 [debug] [MainThread]: On master: COMMIT
17:44:21.613913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:21.614036 [debug] [MainThread]: On master: Close
17:44:21.614359 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:44:21.614625 [info ] [MainThread]: 
17:44:21.647147 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_custumer_id.4c53a0ab58
17:44:21.647350 [info ] [Thread-1  ]: 1 of 5 START test not_null_costumers_custumer_id ............................... [RUN]
17:44:21.647664 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_custumer_id.4c53a0ab58"
17:44:21.647773 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_custumer_id.4c53a0ab58
17:44:21.647856 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_custumer_id.4c53a0ab58
17:44:21.658042 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_custumer_id.4c53a0ab58"
17:44:21.658249 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:21.658435 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:44:21.658725 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:21.658819 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:21.658930 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:21.664307 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:21.664587 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:21.666394 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:44:21.667030 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:21.665404 [debug] [Thread-1  ]: finished collecting timing info
17:44:21.667499 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_custumer_id.4c53a0ab58
17:44:21.667251 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:21.678065 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:21.664925 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:21.684233 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:44:21.684583 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:21.680441 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_custumer_id.4c53a0ab58"
17:44:21.685067 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_custumer_id.4c53a0ab58"
17:44:21.685175 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_custumer_id.4c53a0ab58: BEGIN
17:44:21.685246 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:44:21.664806 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:21.685629 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:44:21.686225 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:21.686430 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:21.686585 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:21.684709 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:21.696265 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:21.683024 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:21.704370 [debug] [Thread-3  ]: finished collecting timing info
17:44:21.705495 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:21.666002 [debug] [Thread-2  ]: finished collecting timing info
17:44:21.707165 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:21.703345 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:21.708673 [debug] [Thread-5  ]: finished collecting timing info
17:44:21.708799 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:21.704013 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:44:21.709956 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_custumer_id.4c53a0ab58"
17:44:21.709814 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:21.703781 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:21.710419 [debug] [Thread-4  ]: finished collecting timing info
17:44:21.710533 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:21.710076 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_custumer_id.4c53a0ab58: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_custumer_id.4c53a0ab58"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select custumer_id
from "erp_oltp"."public"."costumers"
where custumer_id is null



      
    ) dbt_internal_test
17:44:21.711420 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:21.706948 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:21.715569 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:21.715708 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:44:21.714120 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "custumer_id" does not exist
LINE 13: select custumer_id
                ^
HINT:  Perhaps you meant to reference the column "costumers.customer_id".

17:44:21.714390 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:21.716905 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:44:21.716988 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:44:21.716612 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:44:21.716763 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_custumer_id.4c53a0ab58: ROLLBACK
17:44:21.708291 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:21.718299 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:21.718443 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:44:21.718518 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:44:21.721761 [debug] [Thread-1  ]: finished collecting timing info
17:44:21.722014 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_custumer_id.4c53a0ab58: Close
17:44:21.711673 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:21.722607 [debug] [Thread-1  ]: Database Error in test not_null_costumers_custumer_id (models/erp/schema.yml)
  column "custumer_id" does not exist
  LINE 13: select custumer_id
                  ^
  HINT:  Perhaps you meant to reference the column "costumers.customer_id".
  compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_costumers_custumer_id.sql
17:44:21.722793 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:44:21.723086 [error] [Thread-1  ]: 1 of 5 ERROR not_null_costumers_custumer_id .................................... [[31mERROR[0m in 0.08s]
17:44:21.723403 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:44:21.723878 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_custumer_id.4c53a0ab58
17:44:21.729016 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:44:21.729183 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:21.729259 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:44:21.729942 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:21.731365 [debug] [Thread-3  ]: finished collecting timing info
17:44:21.731501 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:44:21.731914 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:44:21.732316 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:44:21.732721 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:21.734290 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:44:21.734658 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:21.734765 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:44:21.734485 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:44:21.735546 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:21.735639 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:44:21.736499 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:21.737661 [debug] [Thread-2  ]: finished collecting timing info
17:44:21.737917 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:44:21.738038 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:21.739187 [debug] [Thread-4  ]: finished collecting timing info
17:44:21.739357 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:44:21.740145 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:44:21.740282 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:44:21.740676 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:44:21.741051 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:21.741274 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:44:21.741748 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:21.751831 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
17:44:21.752093 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:21.752181 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:44:21.753157 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:21.754347 [debug] [Thread-5  ]: finished collecting timing info
17:44:21.754517 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:44:21.755483 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:44:21.755966 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:44:21.756307 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:21.757713 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:21.757898 [debug] [MainThread]: Using postgres connection "master"
17:44:21.757975 [debug] [MainThread]: On master: BEGIN
17:44:21.758041 [debug] [MainThread]: Opening a new connection, currently in state closed
17:44:21.762666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:21.762854 [debug] [MainThread]: On master: COMMIT
17:44:21.762930 [debug] [MainThread]: Using postgres connection "master"
17:44:21.762997 [debug] [MainThread]: On master: COMMIT
17:44:21.763181 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:21.763313 [debug] [MainThread]: On master: Close
17:44:21.763623 [info ] [MainThread]: 
17:44:21.763866 [info ] [MainThread]: Finished running 5 tests in 0.20s.
17:44:21.764031 [debug] [MainThread]: Connection 'master' was properly closed.
17:44:21.764100 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_custumer_id.4c53a0ab58' was properly closed.
17:44:21.764174 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:44:21.764288 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:44:21.764365 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:44:21.764426 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:44:21.769113 [info ] [MainThread]: 
17:44:21.769433 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:44:21.769633 [info ] [MainThread]: 
17:44:21.770002 [error] [MainThread]: [33mDatabase Error in test not_null_costumers_custumer_id (models/erp/schema.yml)[0m
17:44:21.770180 [error] [MainThread]:   column "custumer_id" does not exist
17:44:21.770320 [error] [MainThread]:   LINE 13: select custumer_id
17:44:21.770456 [error] [MainThread]:                   ^
17:44:21.770589 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "costumers.customer_id".
17:44:21.770724 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_costumers_custumer_id.sql
17:44:21.770866 [info ] [MainThread]: 
17:44:21.771060 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:44:21.771228 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:44:21.771371 [info ] [MainThread]: 
17:44:21.771513 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:44:21.771669 [info ] [MainThread]: 
17:44:21.771811 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
17:44:21.772067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1a248e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a1a248b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75a015f550>]}


============================== 2022-06-04 17:47:33.482958 | 320e872a-0ad1-41cb-a0be-be36f7913bf0 ==============================
17:47:33.482971 [info ] [MainThread]: Running with dbt=1.1.0
17:47:33.483323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:47:33.483442 [debug] [MainThread]: Tracking: tracking
17:47:33.485752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e83d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e83d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e83d2b0>]}
17:47:33.503611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:47:33.504757 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:47:33.513798 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
17:47:33.539644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '320e872a-0ad1-41cb-a0be-be36f7913bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e2c2f40>]}
17:47:33.543786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '320e872a-0ad1-41cb-a0be-be36f7913bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e83f490>]}
17:47:33.544081 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:47:33.544237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '320e872a-0ad1-41cb-a0be-be36f7913bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e317af0>]}
17:47:33.545255 [info ] [MainThread]: 
17:47:33.545567 [debug] [MainThread]: Acquiring new postgres connection "master"
17:47:33.546547 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:47:33.596174 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:47:33.596432 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:47:33.596501 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:47:33.603318 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:47:33.603496 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:47:33.603566 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:47:33.605643 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:47:33.607101 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:47:33.607479 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:47:33.611643 [debug] [MainThread]: Using postgres connection "master"
17:47:33.611785 [debug] [MainThread]: On master: BEGIN
17:47:33.611852 [debug] [MainThread]: Opening a new connection, currently in state init
17:47:33.616426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:47:33.616666 [debug] [MainThread]: Using postgres connection "master"
17:47:33.616730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:47:33.627306 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:47:33.628291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '320e872a-0ad1-41cb-a0be-be36f7913bf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e317070>]}
17:47:33.628533 [debug] [MainThread]: On master: ROLLBACK
17:47:33.628751 [debug] [MainThread]: Using postgres connection "master"
17:47:33.628838 [debug] [MainThread]: On master: BEGIN
17:47:33.629017 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:47:33.629151 [debug] [MainThread]: On master: COMMIT
17:47:33.629240 [debug] [MainThread]: Using postgres connection "master"
17:47:33.629312 [debug] [MainThread]: On master: COMMIT
17:47:33.629470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:47:33.629559 [debug] [MainThread]: On master: Close
17:47:33.629879 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:47:33.630052 [info ] [MainThread]: 
17:47:33.634556 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_costumer_id.3babb0e87e
17:47:33.634689 [info ] [Thread-1  ]: 1 of 5 START test not_null_costumers_costumer_id ............................... [RUN]
17:47:33.634965 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_costumer_id.3babb0e87e"
17:47:33.635061 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_costumer_id.3babb0e87e
17:47:33.635139 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_costumer_id.3babb0e87e
17:47:33.642940 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:33.643199 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:47:33.643561 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:33.643762 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:33.643877 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:33.648154 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:33.648352 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:33.648885 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:33.648983 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:33.650526 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_costumer_id.3babb0e87e"
17:47:33.650841 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:47:33.651082 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:47:33.651282 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:47:33.652923 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:33.653025 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:33.652514 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:33.653323 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:33.653096 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:33.652091 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:33.657623 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:33.657758 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:33.660458 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:33.661261 [debug] [Thread-3  ]: finished collecting timing info
17:47:33.657387 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:33.661902 [debug] [Thread-5  ]: finished collecting timing info
17:47:33.662088 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:33.653440 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:33.652598 [debug] [Thread-1  ]: finished collecting timing info
17:47:33.661521 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:33.680062 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:33.677066 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:33.677969 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:33.678242 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_costumer_id.3babb0e87e
17:47:33.680387 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:33.682423 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:47:33.680906 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:33.681179 [debug] [Thread-4  ]: finished collecting timing info
17:47:33.682216 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_costumer_id.3babb0e87e"
17:47:33.682548 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:47:33.683500 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_costumer_id.3babb0e87e"
17:47:33.683606 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_costumer_id.3babb0e87e: BEGIN
17:47:33.683673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:47:33.682759 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:47:33.684004 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:47:33.682965 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:33.686547 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:33.686826 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:33.686967 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:47:33.687037 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:47:33.651523 [debug] [Thread-2  ]: finished collecting timing info
17:47:33.687824 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:33.687945 [debug] [Thread-5  ]: SQL status: BEGIN in 0.0 seconds
17:47:33.689605 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:33.689199 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:33.689786 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:47:33.690130 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:33.690275 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:47:33.690449 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:47:33.691022 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:33.692435 [debug] [Thread-5  ]: finished collecting timing info
17:47:33.692547 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:47:33.692831 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:47:33.693113 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
17:47:33.693449 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:33.698774 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:47:33.698980 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:33.699090 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:47:33.699779 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:33.700791 [debug] [Thread-3  ]: finished collecting timing info
17:47:33.700919 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:47:33.701087 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:47:33.701450 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.05s]
17:47:33.701768 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:33.703788 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:47:33.703944 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_costumer_id.3babb0e87e"
17:47:33.704019 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_costumer_id.3babb0e87e: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_costumer_id.3babb0e87e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select costumer_id
from "erp_oltp"."public"."costumers"
where costumer_id is null



      
    ) dbt_internal_test
17:47:33.707123 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "costumer_id" does not exist
LINE 13: select costumer_id
                ^
HINT:  Perhaps you meant to reference the column "costumers.customer_id".

17:47:33.707300 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_costumer_id.3babb0e87e: ROLLBACK
17:47:33.707673 [debug] [Thread-1  ]: finished collecting timing info
17:47:33.707793 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_costumer_id.3babb0e87e: Close
17:47:33.708100 [debug] [Thread-1  ]: Database Error in test not_null_costumers_costumer_id (models/erp/schema.yml)
  column "costumer_id" does not exist
  LINE 13: select costumer_id
                  ^
  HINT:  Perhaps you meant to reference the column "costumers.customer_id".
  compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_costumers_costumer_id.sql
17:47:33.708262 [error] [Thread-1  ]: 1 of 5 ERROR not_null_costumers_costumer_id .................................... [[31mERROR[0m in 0.07s]
17:47:33.708573 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_costumer_id.3babb0e87e
17:47:33.709480 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:47:33.709586 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:33.709654 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:47:33.710717 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:33.711641 [debug] [Thread-4  ]: finished collecting timing info
17:47:33.711784 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:47:33.715502 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:47:33.715983 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:47:33.716280 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:33.718031 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:47:33.718189 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:33.718262 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:47:33.718885 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:33.720112 [debug] [Thread-2  ]: finished collecting timing info
17:47:33.720256 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:47:33.720892 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:47:33.721228 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:47:33.721508 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:33.722891 [debug] [MainThread]: Acquiring new postgres connection "master"
17:47:33.723041 [debug] [MainThread]: Using postgres connection "master"
17:47:33.723114 [debug] [MainThread]: On master: BEGIN
17:47:33.723177 [debug] [MainThread]: Opening a new connection, currently in state closed
17:47:33.732703 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:47:33.732901 [debug] [MainThread]: On master: COMMIT
17:47:33.732971 [debug] [MainThread]: Using postgres connection "master"
17:47:33.733030 [debug] [MainThread]: On master: COMMIT
17:47:33.733360 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:47:33.733491 [debug] [MainThread]: On master: Close
17:47:33.733890 [info ] [MainThread]: 
17:47:33.734229 [info ] [MainThread]: Finished running 5 tests in 0.19s.
17:47:33.734379 [debug] [MainThread]: Connection 'master' was properly closed.
17:47:33.734440 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_costumer_id.3babb0e87e' was properly closed.
17:47:33.734501 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:47:33.734558 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:47:33.734610 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:47:33.734661 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:47:33.737547 [info ] [MainThread]: 
17:47:33.737842 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:47:33.738006 [info ] [MainThread]: 
17:47:33.738156 [error] [MainThread]: [33mDatabase Error in test not_null_costumers_costumer_id (models/erp/schema.yml)[0m
17:47:33.738286 [error] [MainThread]:   column "costumer_id" does not exist
17:47:33.738402 [error] [MainThread]:   LINE 13: select costumer_id
17:47:33.738512 [error] [MainThread]:                   ^
17:47:33.738622 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "costumers.customer_id".
17:47:33.738777 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_costumers_costumer_id.sql
17:47:33.738949 [info ] [MainThread]: 
17:47:33.739162 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:47:33.739337 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:47:33.739468 [info ] [MainThread]: 
17:47:33.739601 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:47:33.739744 [info ] [MainThread]: 
17:47:33.739874 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
17:47:33.740263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e29c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e79ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5e831040>]}


============================== 2022-06-04 17:48:51.896303 | f62ddcc3-192e-4701-8f2e-88dcc2ba2cb4 ==============================
17:48:51.896331 [info ] [MainThread]: Running with dbt=1.1.0
17:48:51.897146 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:48:51.897285 [debug] [MainThread]: Tracking: tracking
17:48:51.912138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd978e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd978340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd978220>]}
17:48:51.940091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:48:51.940726 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:48:51.947762 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
17:48:51.972181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f62ddcc3-192e-4701-8f2e-88dcc2ba2cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd3acfd0>]}
17:48:51.976268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f62ddcc3-192e-4701-8f2e-88dcc2ba2cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd4541c0>]}
17:48:51.976557 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:48:51.976726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62ddcc3-192e-4701-8f2e-88dcc2ba2cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd454910>]}
17:48:51.977711 [info ] [MainThread]: 
17:48:51.978039 [debug] [MainThread]: Acquiring new postgres connection "master"
17:48:51.978833 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:48:52.019527 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:48:52.019763 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:48:52.019840 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:48:52.027200 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:48:52.027402 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:48:52.027496 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:48:52.029197 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:48:52.030213 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:48:52.030530 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:48:52.033315 [debug] [MainThread]: Using postgres connection "master"
17:48:52.033432 [debug] [MainThread]: On master: BEGIN
17:48:52.033500 [debug] [MainThread]: Opening a new connection, currently in state init
17:48:52.039684 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:48:52.040034 [debug] [MainThread]: Using postgres connection "master"
17:48:52.040113 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:48:52.051281 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:48:52.052328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62ddcc3-192e-4701-8f2e-88dcc2ba2cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cfb581c0>]}
17:48:52.052553 [debug] [MainThread]: On master: ROLLBACK
17:48:52.052901 [debug] [MainThread]: Using postgres connection "master"
17:48:52.053004 [debug] [MainThread]: On master: BEGIN
17:48:52.053483 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:48:52.053585 [debug] [MainThread]: On master: COMMIT
17:48:52.053657 [debug] [MainThread]: Using postgres connection "master"
17:48:52.053762 [debug] [MainThread]: On master: COMMIT
17:48:52.053999 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:48:52.054121 [debug] [MainThread]: On master: Close
17:48:52.054468 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:48:52.054634 [info ] [MainThread]: 
17:48:52.057881 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:48:52.058034 [info ] [Thread-1  ]: 1 of 5 START test not_null_costumers_customer_id ............................... [RUN]
17:48:52.058359 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:48:52.058469 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:48:52.058550 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:48:52.066254 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:48:52.066413 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:52.066781 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:48:52.067024 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:52.067103 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:52.067169 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:52.066487 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:52.069285 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:52.066549 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:52.069953 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:48:52.069581 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:48:52.070241 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:52.070998 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:52.071104 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:52.070764 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:52.066607 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:52.077501 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:48:52.077833 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:52.077924 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:52.077336 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:52.078001 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:52.080853 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:52.081205 [debug] [Thread-5  ]: finished collecting timing info
17:48:52.081393 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:52.078208 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:52.078081 [debug] [Thread-2  ]: finished collecting timing info
17:48:52.093056 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:52.075323 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:52.092671 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:52.069791 [debug] [Thread-1  ]: finished collecting timing info
17:48:52.099625 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:48:52.099426 [debug] [Thread-4  ]: finished collecting timing info
17:48:52.106424 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:52.115320 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:48:52.116122 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:52.116383 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:52.116474 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:48:52.116565 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:48:52.116747 [debug] [Thread-3  ]: finished collecting timing info
17:48:52.116881 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:52.117962 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:52.119809 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:52.119950 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:48:52.121708 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:52.122160 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:52.122907 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:48:52.122613 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:48:52.123281 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:48:52.123014 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:48:52.123854 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:52.124080 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:48:52.124211 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:48:52.123992 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:52.124550 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:48:52.122487 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:48:52.124633 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:48:52.125755 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:52.126077 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:48:52.127396 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:52.128631 [debug] [Thread-4  ]: finished collecting timing info
17:48:52.128770 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:48:52.129025 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:48:52.129349 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:48:52.129594 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:52.130877 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:48:52.131025 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:52.131105 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:48:52.132182 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:52.133190 [debug] [Thread-5  ]: finished collecting timing info
17:48:52.133376 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:48:52.135735 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:48:52.136144 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
17:48:52.136391 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:48:52.136467 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:52.136532 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:48:52.136738 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:52.137159 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:52.138023 [debug] [Thread-3  ]: finished collecting timing info
17:48:52.138124 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:48:52.138466 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:48:52.138812 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:48:52.139345 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:52.139955 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:48:52.140053 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:48:52.140116 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:48:52.142812 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:52.143733 [debug] [Thread-1  ]: finished collecting timing info
17:48:52.143856 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:48:52.144730 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:48:52.145053 [info ] [Thread-1  ]: 1 of 5 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.09s]
17:48:52.145305 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:48:52.151175 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:48:52.151350 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:52.151466 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:48:52.152456 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:52.153683 [debug] [Thread-2  ]: finished collecting timing info
17:48:52.153895 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:48:52.154308 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:48:52.155713 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
17:48:52.158358 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:52.160270 [debug] [MainThread]: Acquiring new postgres connection "master"
17:48:52.160443 [debug] [MainThread]: Using postgres connection "master"
17:48:52.160509 [debug] [MainThread]: On master: BEGIN
17:48:52.160566 [debug] [MainThread]: Opening a new connection, currently in state closed
17:48:52.164875 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:48:52.165111 [debug] [MainThread]: On master: COMMIT
17:48:52.165202 [debug] [MainThread]: Using postgres connection "master"
17:48:52.165287 [debug] [MainThread]: On master: COMMIT
17:48:52.165459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:48:52.165580 [debug] [MainThread]: On master: Close
17:48:52.165998 [info ] [MainThread]: 
17:48:52.166238 [info ] [MainThread]: Finished running 5 tests in 0.19s.
17:48:52.166387 [debug] [MainThread]: Connection 'master' was properly closed.
17:48:52.166448 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:48:52.166505 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:48:52.166561 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:48:52.166619 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:48:52.166678 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:48:52.170400 [info ] [MainThread]: 
17:48:52.170620 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:48:52.170747 [info ] [MainThread]: 
17:48:52.170847 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:48:52.171042 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:48:52.171473 [info ] [MainThread]: 
17:48:52.171576 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:48:52.171681 [info ] [MainThread]: 
17:48:52.171775 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:48:52.172005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cf1948e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd42ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5cd93a400>]}


============================== 2022-06-04 17:49:57.061586 | 085caf51-2b4b-4036-be37-b4e656d8c0ed ==============================
17:49:57.061601 [info ] [MainThread]: Running with dbt=1.1.0
17:49:57.062018 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:49:57.062109 [debug] [MainThread]: Tracking: tracking
17:49:57.064932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa703b76040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa703b76f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa703b76070>]}
17:49:57.086739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:49:57.087477 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:49:57.097069 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
17:49:57.126248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '085caf51-2b4b-4036-be37-b4e656d8c0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7036080d0>]}
17:49:57.130418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '085caf51-2b4b-4036-be37-b4e656d8c0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7036514f0>]}
17:49:57.130710 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:49:57.130917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '085caf51-2b4b-4036-be37-b4e656d8c0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa703651520>]}
17:49:57.132008 [info ] [MainThread]: 
17:49:57.132320 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:57.133112 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:49:57.181587 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:49:57.181803 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:49:57.181947 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:49:57.188494 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:49:57.188748 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:49:57.188862 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:49:57.190654 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:49:57.191752 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:49:57.192052 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:49:57.194907 [debug] [MainThread]: Using postgres connection "master"
17:49:57.195021 [debug] [MainThread]: On master: BEGIN
17:49:57.195083 [debug] [MainThread]: Opening a new connection, currently in state init
17:49:57.199103 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:57.199285 [debug] [MainThread]: Using postgres connection "master"
17:49:57.199373 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:49:57.209469 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:49:57.210532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '085caf51-2b4b-4036-be37-b4e656d8c0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70362bdf0>]}
17:49:57.210774 [debug] [MainThread]: On master: ROLLBACK
17:49:57.211117 [debug] [MainThread]: Using postgres connection "master"
17:49:57.211247 [debug] [MainThread]: On master: BEGIN
17:49:57.211645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:57.211739 [debug] [MainThread]: On master: COMMIT
17:49:57.211803 [debug] [MainThread]: Using postgres connection "master"
17:49:57.211869 [debug] [MainThread]: On master: COMMIT
17:49:57.212028 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:57.212153 [debug] [MainThread]: On master: Close
17:49:57.212489 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:49:57.212655 [info ] [MainThread]: 
17:49:57.216496 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:49:57.216627 [info ] [Thread-1  ]: 1 of 6 START test not_null_costumers_customer_id ............................... [RUN]
17:49:57.216902 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:49:57.217007 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:49:57.217090 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:49:57.226930 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:57.227105 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:49:57.227365 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:57.227446 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:57.227516 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:57.229652 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:57.229840 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:57.230006 [debug] [Thread-4  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
17:49:57.230163 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:57.230782 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:49:57.231068 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:57.230554 [info ] [Thread-4  ]: 4 of 6 START test unique_costumers_customer_id ................................. [RUN]
17:49:57.230290 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:49:57.231810 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:57.231958 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:57.231511 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:49:57.230374 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:57.236340 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:49:57.232051 [debug] [Thread-2  ]: finished collecting timing info
17:49:57.237157 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:57.235808 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:57.236095 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
17:49:57.231231 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:57.251749 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:57.226733 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:49:57.245017 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:57.245532 [debug] [Thread-4  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
17:49:57.260576 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:49:57.236832 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:57.263251 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:57.263335 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:57.260805 [debug] [Thread-4  ]: finished collecting timing info
17:49:57.257551 [debug] [Thread-1  ]: finished collecting timing info
17:49:57.266096 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:49:57.265425 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:57.263117 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:57.265818 [debug] [Thread-3  ]: finished collecting timing info
17:49:57.256870 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:57.267037 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:49:57.265998 [debug] [Thread-4  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
17:49:57.269403 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:49:57.269625 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:49:57.269743 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
17:49:57.268157 [debug] [Thread-5  ]: finished collecting timing info
17:49:57.268355 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:49:57.270167 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:49:57.268027 [debug] [Thread-6  ]: finished collecting timing info
17:49:57.269815 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:49:57.267671 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:57.271054 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:49:57.270259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:49:57.267515 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:57.270379 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:57.271157 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:49:57.273087 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:57.269979 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:57.274368 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:57.275881 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:57.276378 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:57.276576 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:57.277125 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:49:57.277004 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:49:57.277214 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:49:57.276734 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:57.277743 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:49:57.277818 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:49:57.277336 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:49:57.282221 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:49:57.282433 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:57.282513 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:49:57.282864 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:49:57.283102 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:49:57.283184 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:49:57.283012 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:49:57.283289 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:49:57.283343 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:49:57.284080 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:57.285584 [debug] [Thread-2  ]: finished collecting timing info
17:49:57.285822 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:49:57.286749 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:57.287633 [debug] [Thread-4  ]: finished collecting timing info
17:49:57.287744 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
17:49:57.287861 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:57.288729 [debug] [Thread-1  ]: finished collecting timing info
17:49:57.288849 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:49:57.289144 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
17:49:57.289542 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_costumers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
17:49:57.289895 [debug] [Thread-4  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
17:49:57.290172 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:49:57.290515 [info ] [Thread-1  ]: 1 of 6 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.07s]
17:49:57.290784 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:49:57.291239 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:49:57.291593 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
17:49:57.291814 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:57.295271 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:49:57.295414 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:57.295485 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:49:57.296115 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:57.296273 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:49:57.297344 [debug] [Thread-3  ]: finished collecting timing info
17:49:57.297585 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:57.297819 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:49:57.298016 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:49:57.298237 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:49:57.298530 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:49:57.298781 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:57.298963 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:57.299095 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:49:57.300122 [debug] [Thread-6  ]: finished collecting timing info
17:49:57.300331 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:57.300539 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:49:57.300658 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:49:57.300994 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:49:57.301284 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
17:49:57.301507 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:57.306599 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
17:49:57.307788 [debug] [Thread-5  ]: finished collecting timing info
17:49:57.307952 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:49:57.308481 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:49:57.308866 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
17:49:57.309199 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:57.313222 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:57.313469 [debug] [MainThread]: Using postgres connection "master"
17:49:57.313555 [debug] [MainThread]: On master: BEGIN
17:49:57.313623 [debug] [MainThread]: Opening a new connection, currently in state closed
17:49:57.317955 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:57.318157 [debug] [MainThread]: On master: COMMIT
17:49:57.318273 [debug] [MainThread]: Using postgres connection "master"
17:49:57.318342 [debug] [MainThread]: On master: COMMIT
17:49:57.318479 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:57.318585 [debug] [MainThread]: On master: Close
17:49:57.318914 [info ] [MainThread]: 
17:49:57.319087 [info ] [MainThread]: Finished running 6 tests in 0.19s.
17:49:57.319250 [debug] [MainThread]: Connection 'master' was properly closed.
17:49:57.319311 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:49:57.319368 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:49:57.319423 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:49:57.319478 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
17:49:57.319532 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:49:57.319588 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:49:57.323783 [info ] [MainThread]: 
17:49:57.324069 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:49:57.324275 [info ] [MainThread]: 
17:49:57.324426 [error] [MainThread]: [31mFailure in test unique_costumers_customer_id (models/erp/schema.yml)[0m
17:49:57.324552 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:49:57.324651 [info ] [MainThread]: 
17:49:57.324751 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_costumers_customer_id.sql
17:49:57.324858 [info ] [MainThread]: 
17:49:57.324954 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:49:57.325117 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:49:57.325211 [info ] [MainThread]: 
17:49:57.325303 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:49:57.325405 [info ] [MainThread]: 
17:49:57.325507 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:49:57.325750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa703602790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7053f3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa70356dcd0>]}


============================== 2022-06-04 17:52:55.785615 | 98599ae2-6ade-469c-a4bb-1ee30390d6d7 ==============================
17:52:55.785635 [info ] [MainThread]: Running with dbt=1.1.0
17:52:55.786207 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:52:55.786323 [debug] [MainThread]: Tracking: tracking
17:52:55.789057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6be5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6be5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6be5d60>]}
17:52:55.816257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:52:55.816666 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_custumers.sql
17:52:55.827540 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_custumers.sql
17:52:55.841803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98599ae2-6ade-469c-a4bb-1ee30390d6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6651f40>]}
17:52:55.845838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98599ae2-6ade-469c-a4bb-1ee30390d6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6ac6e80>]}
17:52:55.846173 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:52:55.846464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98599ae2-6ade-469c-a4bb-1ee30390d6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6acff40>]}
17:52:55.847634 [info ] [MainThread]: 
17:52:55.848011 [debug] [MainThread]: Acquiring new postgres connection "master"
17:52:55.848897 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:52:55.856171 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:52:55.856364 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:52:55.856440 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:52:55.862330 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:52:55.862512 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:52:55.862581 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:52:55.864023 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:52:55.865208 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:52:55.866033 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:52:55.873008 [debug] [MainThread]: Using postgres connection "master"
17:52:55.873192 [debug] [MainThread]: On master: BEGIN
17:52:55.873264 [debug] [MainThread]: Opening a new connection, currently in state init
17:52:55.881005 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:52:55.881234 [debug] [MainThread]: Using postgres connection "master"
17:52:55.881362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:52:55.892687 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:52:55.893949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98599ae2-6ade-469c-a4bb-1ee30390d6d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6670190>]}
17:52:55.894249 [debug] [MainThread]: On master: ROLLBACK
17:52:55.894594 [debug] [MainThread]: Using postgres connection "master"
17:52:55.894728 [debug] [MainThread]: On master: BEGIN
17:52:55.896009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:52:55.896239 [debug] [MainThread]: On master: COMMIT
17:52:55.896324 [debug] [MainThread]: Using postgres connection "master"
17:52:55.896396 [debug] [MainThread]: On master: COMMIT
17:52:55.896673 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:52:55.896815 [debug] [MainThread]: On master: Close
17:52:55.897142 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:52:55.897308 [info ] [MainThread]: 
17:52:55.932162 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:52:55.932656 [info ] [Thread-1  ]: 1 of 6 START test not_null_costumers_customer_id ............................... [RUN]
17:52:55.932939 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:52:55.933027 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:52:55.933101 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:52:55.941882 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:52:55.942213 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:52:55.942449 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:52:55.949552 [debug] [Thread-4  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
17:52:55.949400 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:52:55.949742 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:52:55.951124 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:52:55.950339 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:52:55.951341 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:52:55.950634 [info ] [Thread-4  ]: 4 of 6 START test unique_costumers_customer_id ................................. [RUN]
17:52:55.951768 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:52:55.951943 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
17:52:55.952034 [debug] [Thread-4  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
17:52:55.950428 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:52:55.956271 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:52:55.956531 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:52:55.956016 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:52:55.949873 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:52:55.951439 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:52:55.951216 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:52:55.956612 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:52:55.959904 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:52:55.957044 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:52:55.962663 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:52:55.959450 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:52:55.959677 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:52:55.957213 [debug] [Thread-4  ]: finished collecting timing info
17:52:55.962021 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:52:55.962878 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:52:55.956766 [debug] [Thread-1  ]: finished collecting timing info
17:52:55.967076 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:52:55.966403 [debug] [Thread-2  ]: finished collecting timing info
17:52:55.966807 [debug] [Thread-6  ]: finished collecting timing info
17:52:55.966600 [debug] [Thread-4  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
17:52:55.966944 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:52:55.980798 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:52:55.972622 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:52:55.966066 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:52:55.977367 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:52:55.978571 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:52:55.977029 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:52:55.982090 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:52:55.985298 [debug] [Thread-5  ]: finished collecting timing info
17:52:55.987720 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:52:55.988495 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:52:55.989837 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
17:52:55.989925 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:52:55.989338 [debug] [Thread-3  ]: finished collecting timing info
17:52:55.990267 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:52:55.988872 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:52:55.992117 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:52:55.992245 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:52:55.989165 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:52:55.994652 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:52:55.991893 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:52:55.989661 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:52:55.995080 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:52:55.995707 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:52:55.996452 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:52:55.996179 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:52:55.996678 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:52:55.996550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:52:55.995994 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:52:55.996784 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:52:55.996327 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:52:55.997779 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:52:55.997238 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:52:56.002563 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:52:56.002851 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:52:56.003009 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:52:56.003617 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:52:56.004978 [debug] [Thread-2  ]: finished collecting timing info
17:52:56.005139 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:52:56.006454 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:52:56.006933 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
17:52:56.007513 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:52:56.009573 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:52:56.009682 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:52:56.009821 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:52:56.011144 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:52:56.012281 [debug] [Thread-4  ]: finished collecting timing info
17:52:56.012711 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
17:52:56.012900 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:52:56.013163 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:52:56.013236 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:52:56.013033 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:52:56.013378 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:52:56.013442 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:52:56.013596 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
17:52:56.013998 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_costumers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
17:52:56.014276 [debug] [Thread-4  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
17:52:56.015757 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:52:56.016758 [debug] [Thread-3  ]: finished collecting timing info
17:52:56.016877 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:52:56.017068 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:52:56.017344 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:52:56.017627 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:52:56.019076 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
17:52:56.020162 [debug] [Thread-5  ]: finished collecting timing info
17:52:56.020299 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:52:56.021063 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:52:56.021207 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:52:56.021286 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:52:56.021481 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:52:56.022043 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:52:56.022403 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:52:56.023115 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:52:56.024087 [debug] [Thread-1  ]: finished collecting timing info
17:52:56.024207 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:52:56.028603 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
17:52:56.028878 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:52:56.028963 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:52:56.029936 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:52:56.030407 [info ] [Thread-1  ]: 1 of 6 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.10s]
17:52:56.030787 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:52:56.033184 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:52:56.034285 [debug] [Thread-6  ]: finished collecting timing info
17:52:56.034445 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:52:56.034699 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:52:56.035050 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
17:52:56.035295 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:52:56.040987 [debug] [MainThread]: Acquiring new postgres connection "master"
17:52:56.041198 [debug] [MainThread]: Using postgres connection "master"
17:52:56.041273 [debug] [MainThread]: On master: BEGIN
17:52:56.041336 [debug] [MainThread]: Opening a new connection, currently in state closed
17:52:56.046580 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:52:56.046790 [debug] [MainThread]: On master: COMMIT
17:52:56.046869 [debug] [MainThread]: Using postgres connection "master"
17:52:56.046933 [debug] [MainThread]: On master: COMMIT
17:52:56.047069 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:52:56.047171 [debug] [MainThread]: On master: Close
17:52:56.047513 [info ] [MainThread]: 
17:52:56.047735 [info ] [MainThread]: Finished running 6 tests in 0.20s.
17:52:56.047892 [debug] [MainThread]: Connection 'master' was properly closed.
17:52:56.047959 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:52:56.048039 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:52:56.048110 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:52:56.048168 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
17:52:56.048285 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:52:56.048364 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:52:56.051752 [info ] [MainThread]: 
17:52:56.052043 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:52:56.052265 [info ] [MainThread]: 
17:52:56.052428 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:52:56.052570 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:52:56.052693 [info ] [MainThread]: 
17:52:56.052815 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:52:56.052939 [info ] [MainThread]: 
17:52:56.053059 [error] [MainThread]: [31mFailure in test unique_costumers_customer_id (models/erp/schema.yml)[0m
17:52:56.053213 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:52:56.053337 [info ] [MainThread]: 
17:52:56.053454 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_costumers_customer_id.sql
17:52:56.053582 [info ] [MainThread]: 
17:52:56.053760 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:52:56.053974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a45a6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a45a83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6a6aeaa90>]}


============================== 2022-06-04 17:53:11.710087 | 51b1a17a-9133-4b57-a8a0-42517959f79f ==============================
17:53:11.710100 [info ] [MainThread]: Running with dbt=1.1.0
17:53:11.710506 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:53:11.710615 [debug] [MainThread]: Tracking: tracking
17:53:11.713646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab8e5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab8e5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab8e5070>]}
17:53:11.736657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:53:11.736937 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:53:11.742056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51b1a17a-9133-4b57-a8a0-42517959f79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab8110d0>]}
17:53:11.750636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51b1a17a-9133-4b57-a8a0-42517959f79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab85c430>]}
17:53:11.751126 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:53:11.751400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b1a17a-9133-4b57-a8a0-42517959f79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab85c400>]}
17:53:11.753145 [info ] [MainThread]: 
17:53:11.753794 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:11.756662 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:53:11.764315 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:11.764493 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:53:11.764581 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:11.773180 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:53:11.773377 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:11.773456 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:53:11.776057 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:53:11.777320 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:53:11.777777 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:53:11.782351 [debug] [MainThread]: Using postgres connection "master"
17:53:11.782565 [debug] [MainThread]: On master: BEGIN
17:53:11.782679 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:11.797480 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:11.797895 [debug] [MainThread]: Using postgres connection "master"
17:53:11.798071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:53:11.808249 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:53:11.809420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b1a17a-9133-4b57-a8a0-42517959f79f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab7dff40>]}
17:53:11.809736 [debug] [MainThread]: On master: ROLLBACK
17:53:11.810160 [debug] [MainThread]: Using postgres connection "master"
17:53:11.810276 [debug] [MainThread]: On master: BEGIN
17:53:11.810812 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:11.810987 [debug] [MainThread]: On master: COMMIT
17:53:11.811126 [debug] [MainThread]: Using postgres connection "master"
17:53:11.811221 [debug] [MainThread]: On master: COMMIT
17:53:11.811667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:11.811840 [debug] [MainThread]: On master: Close
17:53:11.812287 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:53:11.812463 [info ] [MainThread]: 
17:53:11.818365 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:53:11.818564 [info ] [Thread-1  ]: 1 of 6 START test not_null_costumers_customer_id ............................... [RUN]
17:53:11.819003 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:53:11.819121 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:53:11.819211 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:53:11.827182 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:53:11.827327 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:53:11.829176 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:53:11.829522 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:53:11.829627 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:53:11.828564 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:53:11.830099 [debug] [Thread-1  ]: finished collecting timing info
17:53:11.830294 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:53:11.827491 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:53:11.835736 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:53:11.836145 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:53:11.836251 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:53:11.836336 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:53:11.827561 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:53:11.827403 [debug] [Thread-4  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
17:53:11.884069 [info ] [Thread-4  ]: 4 of 6 START test unique_costumers_customer_id ................................. [RUN]
17:53:11.829730 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:53:11.878162 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:53:11.880605 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:53:11.887247 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:53:11.887351 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:53:11.887464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:53:11.828998 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:53:11.888020 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:53:11.888116 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:53:11.888199 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:53:11.886917 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:53:11.892193 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:53:11.892321 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:53:11.884379 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:53:11.897434 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
17:53:11.897564 [debug] [Thread-4  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
17:53:11.886560 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:53:11.883775 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:53:11.895043 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:53:11.903006 [debug] [Thread-6  ]: finished collecting timing info
17:53:11.900199 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:53:11.902034 [debug] [Thread-3  ]: finished collecting timing info
17:53:11.902350 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:53:11.905519 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:53:11.905671 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:53:11.905276 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:53:11.903178 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:53:11.907218 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:53:11.891859 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:53:11.908504 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:53:11.909534 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:53:11.908842 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:53:11.909871 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:53:11.916642 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:53:11.911931 [debug] [Thread-1  ]: finished collecting timing info
17:53:11.908654 [debug] [Thread-5  ]: finished collecting timing info
17:53:11.912201 [debug] [Thread-4  ]: finished collecting timing info
17:53:11.917882 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:53:11.912120 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:53:11.918219 [debug] [Thread-2  ]: finished collecting timing info
17:53:11.919174 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:53:11.918985 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:53:11.921385 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:53:11.921025 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:53:11.918508 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:53:11.921192 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:53:11.923836 [info ] [Thread-1  ]: 1 of 6 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.11s]
17:53:11.923373 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:53:11.924101 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:53:11.918772 [debug] [Thread-4  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
17:53:11.924237 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:53:11.926628 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:53:11.926472 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:53:11.926759 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:53:11.924592 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:53:11.927128 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:53:11.927746 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:53:11.927884 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
17:53:11.928065 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:53:11.928279 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:53:11.929225 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:53:11.929330 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:53:11.929395 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:53:11.930279 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:53:11.931511 [debug] [Thread-6  ]: finished collecting timing info
17:53:11.931711 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:53:11.931847 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:53:11.931959 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:53:11.932057 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:53:11.932196 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:53:11.932468 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.05s]
17:53:11.932853 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:53:11.933042 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:53:11.934026 [debug] [Thread-3  ]: finished collecting timing info
17:53:11.934135 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:53:11.934514 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:53:11.934819 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.11s]
17:53:11.935054 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:53:11.938498 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:53:11.938766 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:53:11.939068 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:53:11.940170 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:53:11.941095 [debug] [Thread-2  ]: finished collecting timing info
17:53:11.941216 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:53:11.942089 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:53:11.942197 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:53:11.942270 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:53:11.942370 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:53:11.942783 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.05s]
17:53:11.944937 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:53:11.945951 [debug] [Thread-4  ]: finished collecting timing info
17:53:11.946124 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
17:53:11.946297 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
17:53:11.946610 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_costumers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
17:53:11.946999 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:53:11.947095 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:53:11.947257 [debug] [Thread-4  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
17:53:11.947474 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:53:11.947917 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:53:11.949283 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:53:11.950181 [debug] [Thread-5  ]: finished collecting timing info
17:53:11.950287 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:53:11.950495 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:53:11.950891 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.11s]
17:53:11.951222 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:53:11.952584 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:11.952751 [debug] [MainThread]: Using postgres connection "master"
17:53:11.952838 [debug] [MainThread]: On master: BEGIN
17:53:11.952895 [debug] [MainThread]: Opening a new connection, currently in state closed
17:53:11.960230 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:11.960451 [debug] [MainThread]: On master: COMMIT
17:53:11.960561 [debug] [MainThread]: Using postgres connection "master"
17:53:11.960642 [debug] [MainThread]: On master: COMMIT
17:53:11.960804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:11.960939 [debug] [MainThread]: On master: Close
17:53:11.961403 [info ] [MainThread]: 
17:53:11.961643 [info ] [MainThread]: Finished running 6 tests in 0.21s.
17:53:11.961864 [debug] [MainThread]: Connection 'master' was properly closed.
17:53:11.961952 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:53:11.962033 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:53:11.962092 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:53:11.962162 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
17:53:11.962220 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:53:11.962277 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:53:11.966176 [info ] [MainThread]: 
17:53:11.966411 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:53:11.966548 [info ] [MainThread]: 
17:53:11.966651 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:53:11.966760 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:53:11.966858 [info ] [MainThread]: 
17:53:11.966957 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:53:11.967055 [info ] [MainThread]: 
17:53:11.967151 [error] [MainThread]: [31mFailure in test unique_costumers_customer_id (models/erp/schema.yml)[0m
17:53:11.967251 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:53:11.967384 [info ] [MainThread]: 
17:53:11.967493 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_costumers_customer_id.sql
17:53:11.967608 [info ] [MainThread]: 
17:53:11.967704 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:53:11.967868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab7c4bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab85c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedab75ab50>]}


============================== 2022-06-04 17:53:34.907288 | 387fb558-03aa-4565-8e55-9115da4d4a56 ==============================
17:53:34.907303 [info ] [MainThread]: Running with dbt=1.1.0
17:53:34.907637 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:53:34.907811 [debug] [MainThread]: Tracking: tracking
17:53:34.910579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ee11f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ee11400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ee111f0>]}
17:53:34.953258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:53:34.953452 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:53:34.963360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ed410d0>]}
17:53:34.968607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ed97460>]}
17:53:34.968974 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:53:34.969150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ed97430>]}
17:53:34.970855 [info ] [MainThread]: 
17:53:34.971472 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:34.972434 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:53:34.993634 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:53:34.994009 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:53:34.994102 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:35.006227 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:53:35.007464 [debug] [ThreadPool]: On list_erp_oltp: Close
17:53:35.008702 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:53:35.013203 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:35.013451 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:53:35.013551 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:35.017895 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:53:35.018054 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:35.018128 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:53:35.019557 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:53:35.020437 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:53:35.020628 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:53:35.024258 [debug] [MainThread]: Using postgres connection "master"
17:53:35.024665 [debug] [MainThread]: On master: BEGIN
17:53:35.024756 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:35.028885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:35.029068 [debug] [MainThread]: Using postgres connection "master"
17:53:35.029136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:53:35.040164 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:53:35.041159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ed10fd0>]}
17:53:35.041409 [debug] [MainThread]: On master: ROLLBACK
17:53:35.041669 [debug] [MainThread]: Using postgres connection "master"
17:53:35.041819 [debug] [MainThread]: On master: BEGIN
17:53:35.042157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:35.042256 [debug] [MainThread]: On master: COMMIT
17:53:35.042321 [debug] [MainThread]: Using postgres connection "master"
17:53:35.042379 [debug] [MainThread]: On master: COMMIT
17:53:35.042525 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:35.042613 [debug] [MainThread]: On master: Close
17:53:35.042891 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:53:35.043140 [info ] [MainThread]: 
17:53:35.048164 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:53:35.048457 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:53:35.048809 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:53:35.048909 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:53:35.048992 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:53:35.051071 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:53:35.051351 [debug] [Thread-1  ]: finished collecting timing info
17:53:35.051547 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:53:35.063051 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:53:35.063333 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:53:35.063612 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.063703 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:53:35.063771 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:53:35.101855 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
17:53:35.102169 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_custumers ................................... [RUN]
17:53:35.102505 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
17:53:35.102723 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
17:53:35.102818 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
17:53:35.103457 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
17:53:35.109955 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:53:35.110224 [debug] [Thread-3  ]: finished collecting timing info
17:53:35.118105 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
17:53:35.128860 [debug] [Thread-2  ]: finished collecting timing info
17:53:35.129181 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:53:35.139927 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
17:53:35.141386 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:53:35.148311 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:53:35.149314 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.149494 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:53:35.148716 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:53:35.149570 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:53:35.149685 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:35.150039 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:53:35.150124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:53:35.149842 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
17:53:35.151351 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:53:35.154234 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
17:53:35.154405 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.154473 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:53:35.158126 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:35.166255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:53:35.168241 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.168487 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:35.169148 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:53:35.168972 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:53:35.168747 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:53:35.169411 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:53:35.169492 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:53:35.169900 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.171391 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.171572 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:53:35.171987 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:53:35.172118 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.173639 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:35.180237 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:53:35.179975 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:35.173908 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:35.180405 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.181882 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:53:35.182023 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:35.182133 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
17:53:35.182390 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.184331 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:35.184482 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.186240 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:53:35.186359 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
17:53:35.184600 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:53:35.187007 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.186461 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:53:35.192551 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:35.192833 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:53:35.197911 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:35.199289 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:53:35.199684 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:53:35.199492 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:53:35.199782 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:53:35.198242 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:35.200062 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:35.201429 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:53:35.203360 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:35.203471 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:53:35.203616 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:35.204929 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:53:35.209149 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
17:53:35.203774 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:53:35.212576 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:35.213703 [debug] [Thread-3  ]: finished collecting timing info
17:53:35.208952 [debug] [Thread-2  ]: finished collecting timing info
17:53:35.213896 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
17:53:35.214041 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:53:35.216092 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980cd3880>]}
17:53:35.216437 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.11s]
17:53:35.217002 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c4574c0>]}
17:53:35.217244 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
17:53:35.217338 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:53:35.217590 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
17:53:35.218005 [debug] [Thread-5  ]: Began running node model.first_project.costumers
17:53:35.218987 [debug] [Thread-6  ]: Began running node model.first_project.costumers2
17:53:35.219551 [info ] [Thread-6  ]: 5 of 6 START table model public.costumers2 ..................................... [RUN]
17:53:35.219354 [info ] [Thread-5  ]: 4 of 6 START view model public.costumers ....................................... [RUN]
17:53:35.221033 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.costumers"
17:53:35.221132 [debug] [Thread-5  ]: Began compiling node model.first_project.costumers
17:53:35.221213 [debug] [Thread-5  ]: Compiling model.first_project.costumers
17:53:35.223423 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.costumers"
17:53:35.223739 [debug] [Thread-5  ]: finished collecting timing info
17:53:35.223907 [debug] [Thread-5  ]: Began executing node model.first_project.costumers
17:53:35.225548 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.costumers"
17:53:35.226149 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:53:35.226308 [debug] [Thread-5  ]: On model.first_project.costumers: BEGIN
17:53:35.226391 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:53:35.219742 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:53:35.220056 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:53:35.230443 [debug] [Thread-6  ]: Began compiling node model.first_project.costumers2
17:53:35.230561 [debug] [Thread-6  ]: Compiling model.first_project.costumers2
17:53:35.232211 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.costumers2"
17:53:35.232527 [debug] [Thread-6  ]: finished collecting timing info
17:53:35.232645 [debug] [Thread-6  ]: Began executing node model.first_project.costumers2
17:53:35.234281 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:53:35.234488 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:53:35.234624 [debug] [Thread-6  ]: On model.first_project.costumers2: BEGIN
17:53:35.234725 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:53:35.218861 [debug] [Thread-1  ]: finished collecting timing info
17:53:35.237529 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:53:35.238429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c448dc0>]}
17:53:35.239623 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.19s]
17:53:35.241476 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:53:35.241989 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:53:35.242197 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:53:35.242596 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:53:35.242784 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:53:35.242948 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:53:35.249098 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:53:35.249785 [debug] [Thread-8  ]: finished collecting timing info
17:53:35.250138 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:53:35.262871 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:53:35.263339 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:35.264059 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:53:35.264157 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:53:35.265128 [debug] [Thread-5  ]: SQL status: BEGIN in 0.04 seconds
17:53:35.265259 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:53:35.265326 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:53:35.265772 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
17:53:35.265913 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:53:35.265984 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:53:35.267733 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:35.270017 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:53:35.270166 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:53:35.270282 [debug] [Thread-6  ]: SQL status: SELECT 50 in 0.0 seconds
17:53:35.272072 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:53:35.272271 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
17:53:35.273174 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.279160 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:53:35.279348 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:35.279995 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:53:35.280150 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.01 seconds
17:53:35.284000 [debug] [Thread-5  ]: On model.first_project.costumers: COMMIT
17:53:35.284569 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:53:35.284294 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:35.284751 [debug] [Thread-5  ]: On model.first_project.costumers: COMMIT
17:53:35.279862 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:53:35.286541 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
17:53:35.286238 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:35.287098 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:53:35.287304 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.288744 [debug] [Thread-6  ]: On model.first_project.costumers2: COMMIT
17:53:35.288983 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:35.289137 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:53:35.291953 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:53:35.292069 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:53:35.290645 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:35.289261 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:53:35.292582 [debug] [Thread-6  ]: On model.first_project.costumers2: COMMIT
17:53:35.292234 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:35.292444 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:35.292987 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:35.298266 [debug] [Thread-5  ]: finished collecting timing info
17:53:35.298478 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
17:53:35.301031 [debug] [Thread-5  ]: On model.first_project.costumers: Close
17:53:35.306845 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c3f0d30>]}
17:53:35.303550 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:53:35.303186 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:53:35.307233 [info ] [Thread-5  ]: 4 of 6 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.09s]
17:53:35.309367 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:35.310493 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:53:35.309644 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
17:53:35.311556 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:35.312981 [debug] [Thread-8  ]: finished collecting timing info
17:53:35.313132 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
17:53:35.313698 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:53:35.313889 [debug] [Thread-5  ]: Finished running node model.first_project.costumers
17:53:35.315186 [debug] [Thread-6  ]: finished collecting timing info
17:53:35.317009 [debug] [Thread-6  ]: On model.first_project.costumers2: Close
17:53:35.317552 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c3e6ac0>]}
17:53:35.317932 [info ] [Thread-6  ]: 5 of 6 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.10s]
17:53:35.318218 [debug] [Thread-6  ]: Finished running node model.first_project.costumers2
17:53:35.318986 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387fb558-03aa-4565-8e55-9115da4d4a56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c3ce520>]}
17:53:35.319635 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
17:53:35.320184 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:53:35.326285 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:35.326777 [debug] [MainThread]: Using postgres connection "master"
17:53:35.326907 [debug] [MainThread]: On master: BEGIN
17:53:35.326973 [debug] [MainThread]: Opening a new connection, currently in state closed
17:53:35.334218 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:35.334411 [debug] [MainThread]: On master: COMMIT
17:53:35.334481 [debug] [MainThread]: Using postgres connection "master"
17:53:35.334595 [debug] [MainThread]: On master: COMMIT
17:53:35.334752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:35.334840 [debug] [MainThread]: On master: Close
17:53:35.335181 [info ] [MainThread]: 
17:53:35.335380 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.36s.
17:53:35.335531 [debug] [MainThread]: Connection 'master' was properly closed.
17:53:35.335599 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:53:35.335655 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:53:35.335713 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
17:53:35.335770 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:53:35.335826 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:53:35.335883 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:53:35.352303 [info ] [MainThread]: 
17:53:35.352735 [info ] [MainThread]: [32mCompleted successfully[0m
17:53:35.352925 [info ] [MainThread]: 
17:53:35.353344 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:53:35.353646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c448dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597ed10dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f597c36ec70>]}


============================== 2022-06-04 17:55:39.823719 | 11325071-7903-4883-bd4d-8c920963948a ==============================
17:55:39.823736 [info ] [MainThread]: Running with dbt=1.1.0
17:55:39.824196 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:55:39.824317 [debug] [MainThread]: Tracking: tracking
17:55:39.827171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834f18d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834f18dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834f18d6d0>]}
17:55:39.855128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
17:55:39.855541 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers2.sql
17:55:39.855745 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
17:55:39.867198 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers2.sql
17:55:39.875989 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
17:55:39.896548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834ec5f9d0>]}
17:55:39.923934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8351364c40>]}
17:55:39.924238 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:55:39.924496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8351371340>]}
17:55:39.925479 [info ] [MainThread]: 
17:55:39.925886 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:39.926683 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:55:39.932646 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:55:39.932783 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:55:39.932851 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:39.946408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:55:39.947367 [debug] [ThreadPool]: On list_erp_oltp: Close
17:55:39.948413 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:55:39.953530 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:39.953734 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:55:39.953909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:55:39.958749 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:55:39.959121 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:39.959298 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:55:39.964623 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:55:39.966075 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:55:39.966557 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:55:39.969906 [debug] [MainThread]: Using postgres connection "master"
17:55:39.970073 [debug] [MainThread]: On master: BEGIN
17:55:39.970142 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:39.975174 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:39.975377 [debug] [MainThread]: Using postgres connection "master"
17:55:39.975447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:39.985028 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:55:39.986065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8351371700>]}
17:55:39.986295 [debug] [MainThread]: On master: ROLLBACK
17:55:39.986588 [debug] [MainThread]: Using postgres connection "master"
17:55:39.986692 [debug] [MainThread]: On master: BEGIN
17:55:39.987084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:55:39.987190 [debug] [MainThread]: On master: COMMIT
17:55:39.987260 [debug] [MainThread]: Using postgres connection "master"
17:55:39.987316 [debug] [MainThread]: On master: COMMIT
17:55:39.987543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:39.987652 [debug] [MainThread]: On master: Close
17:55:39.988111 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:55:39.988571 [info ] [MainThread]: 
17:55:39.993714 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:55:39.993990 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:55:39.994282 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:55:39.994372 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:55:39.994483 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:55:39.996118 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:55:39.996417 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:55:39.996701 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:55:39.997030 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:55:39.997122 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:55:39.997199 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:55:39.998806 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:55:39.999025 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
17:55:39.999205 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_custumers ................................... [RUN]
17:55:39.999439 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
17:55:39.999556 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
17:55:39.999629 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
17:55:40.000259 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
17:55:40.000510 [debug] [Thread-3  ]: finished collecting timing info
17:55:40.000668 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
17:55:40.007577 [debug] [Thread-2  ]: finished collecting timing info
17:55:40.007928 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:55:40.013333 [debug] [Thread-1  ]: finished collecting timing info
17:55:40.013535 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:55:40.037205 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:55:40.049356 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
17:55:40.049751 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:40.049926 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:55:40.049996 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:55:40.052018 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:55:40.052289 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:40.052417 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:55:40.052492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:40.053164 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:55:40.053279 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
17:55:40.053364 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:55:40.054214 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
17:55:40.054317 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:40.054406 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:55:40.055885 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:40.063737 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:55:40.063942 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:40.064028 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:55:40.065556 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:40.065897 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:55:40.070442 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:40.070597 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:55:40.068171 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:55:40.070762 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:55:40.070866 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:55:40.068768 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:55:40.070990 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:40.072624 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:40.075725 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:40.077151 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:55:40.077356 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:40.078757 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:40.077541 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
17:55:40.077441 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:55:40.078913 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:55:40.079410 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:40.079514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:40.080668 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:55:40.086532 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:55:40.090341 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:40.089312 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
17:55:40.090473 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:40.090720 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:40.089131 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:40.090875 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:40.090948 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:40.091315 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:40.092078 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:55:40.092191 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:55:40.092289 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:55:40.093454 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:55:40.097269 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:40.097370 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:55:40.097473 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:55:40.098427 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:40.098573 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:55:40.099232 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:55:40.100155 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:55:40.100325 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
17:55:40.100490 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:40.101550 [debug] [Thread-2  ]: finished collecting timing info
17:55:40.101745 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:55:40.102120 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834ebfb5b0>]}
17:55:40.102429 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:55:40.102784 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:55:40.103056 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:55:40.103953 [debug] [Thread-1  ]: finished collecting timing info
17:55:40.104077 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:55:40.104373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834f188820>]}
17:55:40.105545 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:55:40.105949 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:55:40.106230 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:55:40.106957 [debug] [Thread-3  ]: finished collecting timing info
17:55:40.107072 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
17:55:40.107467 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834ebe8fa0>]}
17:55:40.107673 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.11s]
17:55:40.107966 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
17:55:40.108128 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:55:40.108292 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:55:40.108580 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:55:40.108712 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:55:40.108796 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:55:40.110224 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:55:40.110468 [debug] [Thread-5  ]: finished collecting timing info
17:55:40.110559 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:55:40.112681 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:55:40.113199 [debug] [Thread-7  ]: Began running node model.first_project.costumers
17:55:40.113427 [info ] [Thread-7  ]: 5 of 6 START view model public.costumers ....................................... [RUN]
17:55:40.113798 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.costumers"
17:55:40.113880 [debug] [Thread-7  ]: Began compiling node model.first_project.costumers
17:55:40.113947 [debug] [Thread-7  ]: Compiling model.first_project.costumers
17:55:40.115311 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.costumers"
17:55:40.115646 [debug] [Thread-7  ]: finished collecting timing info
17:55:40.115779 [debug] [Thread-7  ]: Began executing node model.first_project.costumers
17:55:40.117093 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.costumers"
17:55:40.117340 [debug] [Thread-8  ]: Began running node model.first_project.costumers2
17:55:40.117655 [info ] [Thread-8  ]: 6 of 6 START table model public.costumers2 ..................................... [RUN]
17:55:40.117869 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:55:40.118229 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:55:40.118669 [debug] [Thread-8  ]: Began compiling node model.first_project.costumers2
17:55:40.118543 [debug] [Thread-7  ]: On model.first_project.costumers: BEGIN
17:55:40.118760 [debug] [Thread-8  ]: Compiling model.first_project.costumers2
17:55:40.120529 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.costumers2"
17:55:40.118859 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:55:40.120741 [debug] [Thread-8  ]: finished collecting timing info
17:55:40.121037 [debug] [Thread-8  ]: Began executing node model.first_project.costumers2
17:55:40.122845 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:55:40.123131 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:55:40.123334 [debug] [Thread-8  ]: On model.first_project.costumers2: BEGIN
17:55:40.123442 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:55:40.118352 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:40.123849 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:55:40.123932 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:55:40.125838 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
17:55:40.125970 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:55:40.126055 [debug] [Thread-7  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customer_state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:55:40.129823 [debug] [Thread-7  ]: Postgres adapter: Postgres error: column "customer_state" does not exist
LINE 28:     customer_state
             ^

17:55:40.130118 [debug] [Thread-7  ]: On model.first_project.costumers: ROLLBACK
17:55:40.130487 [debug] [Thread-7  ]: finished collecting timing info
17:55:40.130659 [debug] [Thread-7  ]: On model.first_project.costumers: Close
17:55:40.131014 [debug] [Thread-7  ]: Database Error in model costumers (models/erp/costumers.sql)
  column "customer_state" does not exist
  LINE 28:     customer_state
               ^
  compiled SQL at target/run/first_project/models/erp/costumers.sql
17:55:40.131332 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835104d9a0>]}
17:55:40.131604 [error] [Thread-7  ]: 5 of 6 ERROR creating view model public.costumers .............................. [[31mERROR[0m in 0.02s]
17:55:40.131895 [debug] [Thread-7  ]: Finished running node model.first_project.costumers
17:55:40.136228 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:55:40.136411 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:55:40.136482 [debug] [Thread-8  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customer_state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:55:40.137246 [debug] [Thread-8  ]: Postgres adapter: Postgres error: column "customer_state" does not exist
LINE 32:     customer_state
             ^

17:55:40.137423 [debug] [Thread-8  ]: On model.first_project.costumers2: ROLLBACK
17:55:40.137796 [debug] [Thread-8  ]: finished collecting timing info
17:55:40.137982 [debug] [Thread-8  ]: On model.first_project.costumers2: Close
17:55:40.138428 [debug] [Thread-8  ]: Database Error in model costumers2 (models/erp/costumers2.sql)
  column "customer_state" does not exist
  LINE 32:     customer_state
               ^
  compiled SQL at target/run/first_project/models/erp/costumers2.sql
17:55:40.138711 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f835104da90>]}
17:55:40.138977 [error] [Thread-8  ]: 6 of 6 ERROR creating table model public.costumers2 ............................ [[31mERROR[0m in 0.02s]
17:55:40.139261 [debug] [Thread-8  ]: Finished running node model.first_project.costumers2
17:55:40.142723 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:55:40.142861 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:40.142928 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:55:40.147104 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:40.149172 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:40.149320 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:55:40.149833 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:40.150626 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:40.150717 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:40.150776 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:40.152444 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:55:40.153659 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:40.153874 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:55:40.154615 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:40.155813 [debug] [Thread-5  ]: finished collecting timing info
17:55:40.155977 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:55:40.156303 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11325071-7903-4883-bd4d-8c920963948a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834c348d00>]}
17:55:40.156527 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:55:40.156772 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:55:40.157895 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:40.158010 [debug] [MainThread]: Using postgres connection "master"
17:55:40.158074 [debug] [MainThread]: On master: BEGIN
17:55:40.158131 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:40.166921 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:40.167187 [debug] [MainThread]: On master: COMMIT
17:55:40.167288 [debug] [MainThread]: Using postgres connection "master"
17:55:40.167378 [debug] [MainThread]: On master: COMMIT
17:55:40.167596 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:40.167768 [debug] [MainThread]: On master: Close
17:55:40.168246 [info ] [MainThread]: 
17:55:40.168449 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.24s.
17:55:40.168669 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:40.168764 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:55:40.168825 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:55:40.168884 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
17:55:40.168940 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:55:40.168996 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:55:40.169054 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:55:40.173050 [info ] [MainThread]: 
17:55:40.173308 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:55:40.173455 [info ] [MainThread]: 
17:55:40.173570 [error] [MainThread]: [33mDatabase Error in model costumers (models/erp/costumers.sql)[0m
17:55:40.173771 [error] [MainThread]:   column "customer_state" does not exist
17:55:40.173889 [error] [MainThread]:   LINE 28:     customer_state
17:55:40.173985 [error] [MainThread]:                ^
17:55:40.174078 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/costumers.sql
17:55:40.174178 [info ] [MainThread]: 
17:55:40.174279 [error] [MainThread]: [33mDatabase Error in model costumers2 (models/erp/costumers2.sql)[0m
17:55:40.174378 [error] [MainThread]:   column "customer_state" does not exist
17:55:40.174469 [error] [MainThread]:   LINE 32:     customer_state
17:55:40.174585 [error] [MainThread]:                ^
17:55:40.174705 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/costumers2.sql
17:55:40.174811 [info ] [MainThread]: 
17:55:40.174909 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:55:40.175075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f834ec52ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83509b1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8350f912e0>]}


============================== 2022-06-04 17:56:26.676540 | 8ecbf7b2-06d4-4dba-98fa-f618ca706517 ==============================
17:56:26.676554 [info ] [MainThread]: Running with dbt=1.1.0
17:56:26.676953 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:56:26.677060 [debug] [MainThread]: Tracking: tracking
17:56:26.679725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c575070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c575040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c5752b0>]}
17:56:26.706364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:56:26.708115 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
17:56:26.717650 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
17:56:26.745911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f87fe60d0>]}
17:56:26.749863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c4dd160>]}
17:56:26.750105 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:56:26.750334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c047fd0>]}
17:56:26.751338 [info ] [MainThread]: 
17:56:26.751669 [debug] [MainThread]: Acquiring new postgres connection "master"
17:56:26.752539 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:56:26.793831 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:56:26.794031 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:56:26.794128 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:56:26.799483 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:56:26.800551 [debug] [ThreadPool]: On list_erp_oltp: Close
17:56:26.801736 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:56:26.806503 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:56:26.806796 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:56:26.806884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:56:26.811026 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:56:26.811201 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:56:26.811296 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:56:26.812923 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:56:26.813889 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:56:26.814081 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:56:26.816881 [debug] [MainThread]: Using postgres connection "master"
17:56:26.817005 [debug] [MainThread]: On master: BEGIN
17:56:26.817072 [debug] [MainThread]: Opening a new connection, currently in state init
17:56:26.821345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:56:26.821545 [debug] [MainThread]: Using postgres connection "master"
17:56:26.821628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:56:26.832826 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:56:26.833761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8e7532e0>]}
17:56:26.834026 [debug] [MainThread]: On master: ROLLBACK
17:56:26.834227 [debug] [MainThread]: Using postgres connection "master"
17:56:26.834315 [debug] [MainThread]: On master: BEGIN
17:56:26.835560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:56:26.835644 [debug] [MainThread]: On master: COMMIT
17:56:26.835706 [debug] [MainThread]: Using postgres connection "master"
17:56:26.835763 [debug] [MainThread]: On master: COMMIT
17:56:26.835928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:56:26.836012 [debug] [MainThread]: On master: Close
17:56:26.836278 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:56:26.836488 [info ] [MainThread]: 
17:56:26.839506 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:56:26.839743 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:56:26.840027 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:56:26.840105 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:56:26.840178 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:56:26.841628 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:56:26.841929 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:56:26.842071 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
17:56:26.842310 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:56:26.842563 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_custumers ................................... [RUN]
17:56:26.843472 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
17:56:26.842989 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.843625 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
17:56:26.843891 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
17:56:26.843764 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:56:26.844815 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:56:26.844636 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
17:56:26.846377 [debug] [Thread-3  ]: finished collecting timing info
17:56:26.846118 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:56:26.846548 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
17:56:26.842679 [debug] [Thread-1  ]: finished collecting timing info
17:56:26.857628 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:56:26.857387 [debug] [Thread-2  ]: finished collecting timing info
17:56:26.874083 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:56:26.881412 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:56:26.873381 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
17:56:26.883406 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:56:26.884185 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:56:26.884478 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.886043 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:56:26.885754 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
17:56:26.886155 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:56:26.884886 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:56:26.886276 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:56:26.887301 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:56:26.887626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:56:26.892743 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:56:26.892909 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:56:26.892980 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:56:26.893206 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:56:26.893319 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.893395 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:56:26.894712 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:56:26.894819 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:56:26.894883 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:56:26.897748 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:56:26.901790 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:56:26.901962 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:56:26.903636 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.903728 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:56:26.902229 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:56:26.902102 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:56:26.905218 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:56:26.905308 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
17:56:26.905915 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.907142 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.907319 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:56:26.907455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.907580 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.908918 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:56:26.910116 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:56:26.910589 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
17:56:26.910337 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.910485 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:56:26.914454 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:56:26.914932 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.915014 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:56:26.915118 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.915819 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:56:26.915919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.916090 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:56:26.919597 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:56:26.919993 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:56:26.919891 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:56:26.919800 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:56:26.920065 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:56:26.924085 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:56:26.924626 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:56:26.925834 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:56:26.926971 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:56:26.927065 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
17:56:26.927273 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:56:26.928491 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:56:26.928667 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:56:26.928799 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:56:26.930451 [debug] [Thread-3  ]: finished collecting timing info
17:56:26.930592 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
17:56:26.930929 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f87fb1f70>]}
17:56:26.931185 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.09s]
17:56:26.932757 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:56:26.933609 [debug] [Thread-1  ]: finished collecting timing info
17:56:26.933775 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:56:26.934142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f87fb3610>]}
17:56:26.934378 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
17:56:26.935559 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
17:56:26.935740 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:56:26.936688 [debug] [Thread-2  ]: finished collecting timing info
17:56:26.936809 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:56:26.937465 [debug] [Thread-5  ]: Began running node model.first_project.costumers
17:56:26.937722 [info ] [Thread-5  ]: 4 of 6 START view model public.costumers ....................................... [RUN]
17:56:26.938198 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.costumers"
17:56:26.938410 [debug] [Thread-5  ]: Began compiling node model.first_project.costumers
17:56:26.938509 [debug] [Thread-5  ]: Compiling model.first_project.costumers
17:56:26.940098 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.costumers"
17:56:26.940369 [debug] [Thread-5  ]: finished collecting timing info
17:56:26.940514 [debug] [Thread-5  ]: Began executing node model.first_project.costumers
17:56:26.937103 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:56:26.947945 [debug] [Thread-6  ]: Began running node model.first_project.costumers2
17:56:26.949166 [info ] [Thread-6  ]: 5 of 6 START table model public.costumers2 ..................................... [RUN]
17:56:26.949588 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:56:26.949811 [debug] [Thread-6  ]: Began compiling node model.first_project.costumers2
17:56:26.949920 [debug] [Thread-6  ]: Compiling model.first_project.costumers2
17:56:26.951918 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.costumers2"
17:56:26.943673 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.costumers"
17:56:26.952898 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:56:26.952273 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:56:26.952601 [debug] [Thread-6  ]: finished collecting timing info
17:56:26.953474 [debug] [Thread-6  ]: Began executing node model.first_project.costumers2
17:56:26.953023 [debug] [Thread-5  ]: On model.first_project.costumers: BEGIN
17:56:26.953183 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:56:26.956305 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:56:26.955833 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:56:26.956398 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:56:26.956649 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:56:26.958072 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:56:26.958323 [debug] [Thread-8  ]: finished collecting timing info
17:56:26.958789 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:56:26.961368 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:56:26.961776 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:56:26.961956 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:56:26.962173 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:56:26.955985 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:56:26.948532 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f847567c0>]}
17:56:26.963199 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:56:26.962077 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:56:26.963582 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:56:26.963669 [debug] [Thread-6  ]: On model.first_project.costumers2: BEGIN
17:56:26.963902 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:56:26.966940 [debug] [Thread-8  ]: SQL status: BEGIN in 0.0 seconds
17:56:26.967087 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:56:26.967156 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:56:26.972935 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
17:56:26.975724 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:56:26.975908 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:56:26.977081 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.978553 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:56:26.978749 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:56:26.978830 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:56:26.981234 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:56:26.982628 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:56:26.982761 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:56:26.983013 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:56:26.983798 [debug] [Thread-8  ]: finished collecting timing info
17:56:26.983913 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:56:26.984184 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f846d1ca0>]}
17:56:26.984394 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:56:26.986172 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
17:56:26.986383 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:56:26.986457 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:56:26.987169 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:56:26.992746 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
17:56:26.992950 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers2"
17:56:26.993024 [debug] [Thread-6  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customer_state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:56:26.993606 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.01 seconds
17:56:26.995217 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:56:26.995358 [debug] [Thread-6  ]: Postgres adapter: Postgres error: column "customer_state" does not exist
LINE 32:     customer_state
             ^

17:56:26.995516 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:56:26.995705 [debug] [Thread-6  ]: On model.first_project.costumers2: ROLLBACK
17:56:26.996138 [debug] [Thread-6  ]: finished collecting timing info
17:56:26.996232 [debug] [Thread-6  ]: On model.first_project.costumers2: Close
17:56:26.996461 [debug] [Thread-6  ]: Database Error in model costumers2 (models/erp/costumers2.sql)
  column "customer_state" does not exist
  LINE 32:     customer_state
               ^
  compiled SQL at target/run/first_project/models/erp/costumers2.sql
17:56:26.996622 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c534490>]}
17:56:26.996811 [error] [Thread-6  ]: 5 of 6 ERROR creating table model public.costumers2 ............................ [[31mERROR[0m in 0.05s]
17:56:26.997091 [debug] [Thread-6  ]: Finished running node model.first_project.costumers2
17:56:26.998835 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:56:26.999769 [debug] [Thread-5  ]: On model.first_project.costumers: COMMIT
17:56:26.999882 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:56:26.999971 [debug] [Thread-5  ]: On model.first_project.costumers: COMMIT
17:56:27.001839 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:56:27.006900 [debug] [Thread-5  ]: Using postgres connection "model.first_project.costumers"
17:56:27.007211 [debug] [Thread-5  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:56:27.007916 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:56:27.008926 [debug] [Thread-5  ]: finished collecting timing info
17:56:27.009087 [debug] [Thread-5  ]: On model.first_project.costumers: Close
17:56:27.009418 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ecbf7b2-06d4-4dba-98fa-f618ca706517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f87f98700>]}
17:56:27.010978 [info ] [Thread-5  ]: 4 of 6 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.07s]
17:56:27.011320 [debug] [Thread-5  ]: Finished running node model.first_project.costumers
17:56:27.012656 [debug] [MainThread]: Acquiring new postgres connection "master"
17:56:27.012771 [debug] [MainThread]: Using postgres connection "master"
17:56:27.012835 [debug] [MainThread]: On master: BEGIN
17:56:27.012892 [debug] [MainThread]: Opening a new connection, currently in state closed
17:56:27.018327 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:56:27.018657 [debug] [MainThread]: On master: COMMIT
17:56:27.018822 [debug] [MainThread]: Using postgres connection "master"
17:56:27.018917 [debug] [MainThread]: On master: COMMIT
17:56:27.019266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:56:27.019400 [debug] [MainThread]: On master: Close
17:56:27.026073 [info ] [MainThread]: 
17:56:27.026565 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.27s.
17:56:27.026779 [debug] [MainThread]: Connection 'master' was properly closed.
17:56:27.026854 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:56:27.026917 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:56:27.026977 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
17:56:27.027037 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:56:27.027095 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:56:27.027151 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:56:27.030931 [info ] [MainThread]: 
17:56:27.031233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:56:27.031400 [info ] [MainThread]: 
17:56:27.031507 [error] [MainThread]: [33mDatabase Error in model costumers2 (models/erp/costumers2.sql)[0m
17:56:27.031617 [error] [MainThread]:   column "customer_state" does not exist
17:56:27.031712 [error] [MainThread]:   LINE 32:     customer_state
17:56:27.031806 [error] [MainThread]:                ^
17:56:27.031900 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/costumers2.sql
17:56:27.032003 [info ] [MainThread]: 
17:56:27.032107 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
17:56:27.032319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c047040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c047610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f8c579f10>]}


============================== 2022-06-04 17:57:15.819479 | d07feeab-6ae8-4920-a855-31b485c0c903 ==============================
17:57:15.819493 [info ] [MainThread]: Running with dbt=1.1.0
17:57:15.819821 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:57:15.819907 [debug] [MainThread]: Tracking: tracking
17:57:15.822502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d987040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d987f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d987070>]}
17:57:15.841381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:57:15.841769 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers2.sql
17:57:15.858887 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers2.sql
17:57:15.872546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d408ee0>]}
17:57:15.875999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d980760>]}
17:57:15.876249 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:57:15.876412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d881fd0>]}
17:57:15.877887 [info ] [MainThread]: 
17:57:15.878507 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:15.879634 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:57:15.889561 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:57:15.889838 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:57:15.889928 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:57:15.897758 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:57:15.899030 [debug] [ThreadPool]: On list_erp_oltp: Close
17:57:15.900401 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:57:15.904587 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:57:15.904785 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:57:15.904863 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:57:15.915539 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:57:15.915807 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:57:15.915903 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:57:15.917500 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:57:15.918526 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:57:15.918720 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:57:15.962661 [debug] [MainThread]: Using postgres connection "master"
17:57:15.962859 [debug] [MainThread]: On master: BEGIN
17:57:15.962933 [debug] [MainThread]: Opening a new connection, currently in state init
17:57:15.967924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:15.968141 [debug] [MainThread]: Using postgres connection "master"
17:57:15.968250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:57:15.979216 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:57:15.980227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d98b400>]}
17:57:15.980478 [debug] [MainThread]: On master: ROLLBACK
17:57:15.980818 [debug] [MainThread]: Using postgres connection "master"
17:57:15.980928 [debug] [MainThread]: On master: BEGIN
17:57:15.981278 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:15.981376 [debug] [MainThread]: On master: COMMIT
17:57:15.981438 [debug] [MainThread]: Using postgres connection "master"
17:57:15.981496 [debug] [MainThread]: On master: COMMIT
17:57:15.981769 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:15.981878 [debug] [MainThread]: On master: Close
17:57:15.982210 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:57:15.982484 [info ] [MainThread]: 
17:57:15.987463 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:57:15.987765 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:57:15.988213 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:57:15.988356 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:57:15.988484 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:57:15.990016 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:57:15.990284 [debug] [Thread-1  ]: finished collecting timing info
17:57:15.990421 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:57:15.999646 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:57:15.999960 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
17:57:16.000260 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:57:16.011011 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_custumers ................................... [RUN]
17:57:16.011655 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.011914 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
17:57:16.014489 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
17:57:16.014594 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
17:57:16.015375 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
17:57:16.014370 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:57:16.015692 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:57:16.017464 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:57:16.014263 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:57:16.018016 [debug] [Thread-3  ]: finished collecting timing info
17:57:16.018236 [debug] [Thread-2  ]: finished collecting timing info
17:57:16.018649 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
17:57:16.018902 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:57:16.019098 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:57:16.039564 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
17:57:16.039818 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:57:16.043438 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:57:16.044176 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:57:16.045321 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.045420 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:57:16.045480 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:57:16.050945 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:57:16.051443 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
17:57:16.051549 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:57:16.053869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:57:16.054062 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:57:16.054137 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:57:16.056025 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:57:16.060372 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:57:16.060586 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:57:16.060780 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:57:16.060895 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.060997 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:57:16.062332 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:57:16.062577 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
17:57:16.062748 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:57:16.062841 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:57:16.063063 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.063132 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:57:16.063338 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.069829 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:57:16.071491 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.071654 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:57:16.075688 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:57:16.075996 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:57:16.076186 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:57:16.077609 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:57:16.078041 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
17:57:16.077948 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.077835 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:57:16.079284 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.079523 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:57:16.079897 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.081380 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:57:16.081493 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
17:57:16.081926 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.082661 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:57:16.082831 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:57:16.082898 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
17:57:16.082769 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.083557 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:57:16.083647 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.083709 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:57:16.086827 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:57:16.090436 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:57:16.090622 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:57:16.090813 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:57:16.090945 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:57:16.091982 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:57:16.093258 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
17:57:16.093750 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
17:57:16.093557 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:57:16.093381 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:57:16.095292 [debug] [Thread-1  ]: finished collecting timing info
17:57:16.095445 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:57:16.095814 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d97e6d0>]}
17:57:16.096120 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:57:16.096859 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:57:16.097004 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:57:16.097437 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:57:16.098590 [debug] [Thread-2  ]: finished collecting timing info
17:57:16.099368 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:57:16.099145 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:57:16.098894 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:57:16.101107 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:57:16.102001 [debug] [Thread-3  ]: finished collecting timing info
17:57:16.102802 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
17:57:16.102509 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:57:16.103065 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:57:16.102281 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d3a79d0>]}
17:57:16.104851 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:57:16.105218 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d3911c0>]}
17:57:16.105516 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
17:57:16.105991 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.09s]
17:57:16.106423 [debug] [Thread-5  ]: finished collecting timing info
17:57:16.106843 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:57:16.108282 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:57:16.108670 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:57:16.108771 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:57:16.108896 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:57:16.106606 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:57:16.114175 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
17:57:16.115945 [debug] [Thread-7  ]: Began running node model.first_project.costumers
17:57:16.116231 [info ] [Thread-7  ]: 5 of 6 START view model public.costumers ....................................... [RUN]
17:57:16.116637 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.costumers"
17:57:16.116731 [debug] [Thread-7  ]: Began compiling node model.first_project.costumers
17:57:16.116814 [debug] [Thread-7  ]: Compiling model.first_project.costumers
17:57:16.118626 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.costumers"
17:57:16.118960 [debug] [Thread-7  ]: finished collecting timing info
17:57:16.119097 [debug] [Thread-7  ]: Began executing node model.first_project.costumers
17:57:16.120547 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.costumers"
17:57:16.123893 [debug] [Thread-8  ]: Began running node model.first_project.costumers2
17:57:16.124294 [info ] [Thread-8  ]: 6 of 6 START table model public.costumers2 ..................................... [RUN]
17:57:16.124638 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.costumers2"
17:57:16.125763 [debug] [Thread-8  ]: Began compiling node model.first_project.costumers2
17:57:16.125882 [debug] [Thread-8  ]: Compiling model.first_project.costumers2
17:57:16.128073 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.costumers2"
17:57:16.128360 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:57:16.128511 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:57:16.129249 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:57:16.130022 [debug] [Thread-8  ]: finished collecting timing info
17:57:16.130267 [debug] [Thread-8  ]: Began executing node model.first_project.costumers2
17:57:16.132086 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.costumers2"
17:57:16.138100 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:57:16.138300 [debug] [Thread-8  ]: On model.first_project.costumers2: BEGIN
17:57:16.138388 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:57:16.132232 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:57:16.137406 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:57:16.142409 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:57:16.142670 [debug] [Thread-7  ]: On model.first_project.costumers: BEGIN
17:57:16.146064 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:57:16.146272 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:57:16.147447 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.148410 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:57:16.148616 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:57:16.148697 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:57:16.148794 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:57:16.148893 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:57:16.148961 [debug] [Thread-8  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:57:16.150898 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:57:16.152826 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:57:16.153008 [debug] [Thread-8  ]: SQL status: SELECT 50 in 0.0 seconds
17:57:16.153357 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:57:16.156058 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:57:16.155577 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:57:16.156869 [debug] [Thread-5  ]: finished collecting timing info
17:57:16.157180 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:57:16.157016 [debug] [Thread-8  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
17:57:16.162117 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d3a7a00>]}
17:57:16.163008 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:57:16.163229 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.163705 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:57:16.166555 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:57:16.167188 [debug] [Thread-8  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
17:57:16.167527 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.168587 [debug] [Thread-8  ]: On model.first_project.costumers2: COMMIT
17:57:16.168691 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:57:16.168764 [debug] [Thread-8  ]: On model.first_project.costumers2: COMMIT
17:57:16.168918 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
17:57:16.169059 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:57:16.169153 [debug] [Thread-7  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:57:16.170559 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:57:16.171954 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers2"
17:57:16.172113 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:57:16.173497 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:57:16.172241 [debug] [Thread-8  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
17:57:16.173643 [debug] [Thread-7  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
17:57:16.174439 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:57:16.175187 [debug] [Thread-7  ]: On model.first_project.costumers: COMMIT
17:57:16.175276 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:57:16.175560 [debug] [Thread-7  ]: On model.first_project.costumers: COMMIT
17:57:16.176976 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
17:57:16.177823 [debug] [Thread-8  ]: finished collecting timing info
17:57:16.177946 [debug] [Thread-8  ]: On model.first_project.costumers2: Close
17:57:16.178300 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4c2cdf70>]}
17:57:16.178586 [info ] [Thread-8  ]: 6 of 6 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.05s]
17:57:16.178886 [debug] [Thread-8  ]: Finished running node model.first_project.costumers2
17:57:16.179749 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
17:57:16.180805 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers"
17:57:16.180899 [debug] [Thread-7  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
17:57:16.181184 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:57:16.181891 [debug] [Thread-7  ]: finished collecting timing info
17:57:16.181997 [debug] [Thread-7  ]: On model.first_project.costumers: Close
17:57:16.182238 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd07feeab-6ae8-4920-a855-31b485c0c903', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d8a09a0>]}
17:57:16.182464 [info ] [Thread-7  ]: 5 of 6 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.07s]
17:57:16.182775 [debug] [Thread-7  ]: Finished running node model.first_project.costumers
17:57:16.184501 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:16.184728 [debug] [MainThread]: Using postgres connection "master"
17:57:16.184799 [debug] [MainThread]: On master: BEGIN
17:57:16.184856 [debug] [MainThread]: Opening a new connection, currently in state closed
17:57:16.190094 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:16.190330 [debug] [MainThread]: On master: COMMIT
17:57:16.190398 [debug] [MainThread]: Using postgres connection "master"
17:57:16.190458 [debug] [MainThread]: On master: COMMIT
17:57:16.190599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:16.190696 [debug] [MainThread]: On master: Close
17:57:16.191054 [info ] [MainThread]: 
17:57:16.191244 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.31s.
17:57:16.191350 [debug] [MainThread]: Connection 'master' was properly closed.
17:57:16.191403 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:57:16.191452 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:57:16.191512 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
17:57:16.191561 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:57:16.191609 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
17:57:16.191657 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
17:57:16.195681 [info ] [MainThread]: 
17:57:16.195891 [info ] [MainThread]: [32mCompleted successfully[0m
17:57:16.196098 [info ] [MainThread]: 
17:57:16.196219 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:57:16.196395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d948490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4d390490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e4fb77970>]}


============================== 2022-06-04 17:57:23.183444 | 99aecaaa-c0d0-4d6c-aae6-fc56b4ebef5c ==============================
17:57:23.183457 [info ] [MainThread]: Running with dbt=1.1.0
17:57:23.183818 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:57:23.183909 [debug] [MainThread]: Tracking: tracking
17:57:23.186753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af919aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af919a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af919abe0>]}
17:57:23.209144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:57:23.209331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:57:23.213443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99aecaaa-c0d0-4d6c-aae6-fc56b4ebef5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af90c80d0>]}
17:57:23.217950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99aecaaa-c0d0-4d6c-aae6-fc56b4ebef5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af911d400>]}
17:57:23.218269 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:57:23.218542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99aecaaa-c0d0-4d6c-aae6-fc56b4ebef5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af911d430>]}
17:57:23.219632 [info ] [MainThread]: 
17:57:23.219951 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:23.223665 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:57:23.231957 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:57:23.232185 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:57:23.232298 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:57:23.238596 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:57:23.238859 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:57:23.238955 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:57:23.242049 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:57:23.243427 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:57:23.243674 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:57:23.246589 [debug] [MainThread]: Using postgres connection "master"
17:57:23.246726 [debug] [MainThread]: On master: BEGIN
17:57:23.246793 [debug] [MainThread]: Opening a new connection, currently in state init
17:57:23.252205 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:23.252377 [debug] [MainThread]: Using postgres connection "master"
17:57:23.252514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:57:23.265480 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:57:23.266837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99aecaaa-c0d0-4d6c-aae6-fc56b4ebef5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af9096e80>]}
17:57:23.267139 [debug] [MainThread]: On master: ROLLBACK
17:57:23.267409 [debug] [MainThread]: Using postgres connection "master"
17:57:23.267514 [debug] [MainThread]: On master: BEGIN
17:57:23.267732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:23.267823 [debug] [MainThread]: On master: COMMIT
17:57:23.267883 [debug] [MainThread]: Using postgres connection "master"
17:57:23.267998 [debug] [MainThread]: On master: COMMIT
17:57:23.268142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:23.268242 [debug] [MainThread]: On master: Close
17:57:23.268528 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:57:23.268706 [info ] [MainThread]: 
17:57:23.279720 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:23.280048 [info ] [Thread-1  ]: 1 of 6 START test not_null_costumers_customer_id ............................... [RUN]
17:57:23.280526 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:23.280684 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:23.280772 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:23.287096 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:23.287331 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:23.291682 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:57:23.291958 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:23.292037 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:23.291453 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:57:23.292421 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:23.292109 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:23.287496 [debug] [Thread-4  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:23.287654 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:23.295701 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:57:23.292505 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:23.287800 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:23.294731 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:23.295499 [info ] [Thread-4  ]: 4 of 6 START test unique_costumers_customer_id ................................. [RUN]
17:57:23.296647 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:23.296748 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:23.296126 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:23.296930 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:23.296825 [debug] [Thread-4  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
17:57:23.295891 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:23.291288 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:23.297038 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:23.296267 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:57:23.301731 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:23.334814 [debug] [Thread-3  ]: finished collecting timing info
17:57:23.337112 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:23.339940 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:23.340450 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:23.340677 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:23.340924 [debug] [Thread-1  ]: finished collecting timing info
17:57:23.350624 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:23.341428 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:23.351804 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:23.341172 [debug] [Thread-4  ]: finished collecting timing info
17:57:23.354537 [debug] [Thread-4  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:23.351669 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:23.354209 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:23.358942 [debug] [Thread-6  ]: finished collecting timing info
17:57:23.359288 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:23.355743 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:23.350422 [debug] [Thread-5  ]: finished collecting timing info
17:57:23.361559 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:23.362735 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:23.360660 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:23.363488 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:23.363583 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:57:23.363649 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:57:23.363028 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:23.363237 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:23.364099 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:57:23.364212 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:57:23.363831 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
17:57:23.364463 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:57:23.361005 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:23.365615 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:57:23.365754 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:57:23.350232 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:23.361154 [debug] [Thread-2  ]: finished collecting timing info
17:57:23.368742 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:23.369394 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:23.375938 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:57:23.375652 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:57:23.376289 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:23.376407 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:57:23.376146 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:57:23.371116 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:23.377554 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:23.378045 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:57:23.378639 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:57:23.380901 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:23.382739 [debug] [Thread-4  ]: finished collecting timing info
17:57:23.383042 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
17:57:23.383324 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:57:23.383489 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
17:57:23.383621 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:23.383962 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:57:23.383746 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:57:23.384440 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:23.384279 [info ] [Thread-4  ]: 4 of 6 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.09s]
17:57:23.384862 [debug] [Thread-4  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:23.383813 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:57:23.385714 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:23.385803 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:57:23.384558 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:57:23.385990 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:23.386998 [debug] [Thread-6  ]: finished collecting timing info
17:57:23.387109 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:57:23.387237 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:23.388118 [debug] [Thread-5  ]: finished collecting timing info
17:57:23.388285 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:57:23.388775 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:57:23.389111 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
17:57:23.389435 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:23.389868 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:57:23.390121 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.05s]
17:57:23.390479 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:23.391820 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
17:57:23.392959 [debug] [Thread-1  ]: finished collecting timing info
17:57:23.393067 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:57:23.393925 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:57:23.394253 [info ] [Thread-1  ]: 1 of 6 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.11s]
17:57:23.394626 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:23.395687 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:57:23.395775 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:23.395837 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:57:23.396584 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:23.397475 [debug] [Thread-3  ]: finished collecting timing info
17:57:23.398287 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:57:23.399822 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:57:23.400218 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.11s]
17:57:23.400529 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:23.406074 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:57:23.406295 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:23.406380 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:57:23.407043 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:23.408314 [debug] [Thread-2  ]: finished collecting timing info
17:57:23.408536 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:57:23.408795 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:57:23.409127 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
17:57:23.409419 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:23.410734 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:23.410863 [debug] [MainThread]: Using postgres connection "master"
17:57:23.410931 [debug] [MainThread]: On master: BEGIN
17:57:23.410990 [debug] [MainThread]: Opening a new connection, currently in state closed
17:57:23.416334 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:23.416561 [debug] [MainThread]: On master: COMMIT
17:57:23.416681 [debug] [MainThread]: Using postgres connection "master"
17:57:23.416742 [debug] [MainThread]: On master: COMMIT
17:57:23.416927 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:23.417031 [debug] [MainThread]: On master: Close
17:57:23.417336 [info ] [MainThread]: 
17:57:23.417544 [info ] [MainThread]: Finished running 6 tests in 0.20s.
17:57:23.417737 [debug] [MainThread]: Connection 'master' was properly closed.
17:57:23.417812 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:57:23.417875 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:57:23.417933 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:57:23.417990 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:57:23.418047 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
17:57:23.418106 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:57:23.421569 [info ] [MainThread]: 
17:57:23.421913 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:57:23.422083 [info ] [MainThread]: 
17:57:23.422194 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:57:23.422400 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:57:23.422577 [info ] [MainThread]: 
17:57:23.422724 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:57:23.422851 [info ] [MainThread]: 
17:57:23.422953 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
17:57:23.423131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af911d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af9192700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0af87d2ca0>]}


============================== 2022-06-04 17:57:56.632845 | f14def81-0c5e-4756-a036-1f66f93e9ce1 ==============================
17:57:56.632858 [info ] [MainThread]: Running with dbt=1.1.0
17:57:56.633273 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:57:56.633369 [debug] [MainThread]: Tracking: tracking
17:57:56.636181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fefdb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fefdbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fefdb070>]}
17:57:56.658766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:57:56.659133 [debug] [MainThread]: Partial parsing: updated file: first_project://models/example/my_first_dbt_model.sql
17:57:56.667827 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
17:57:56.698418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14def81-0c5e-4756-a036-1f66f93e9ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fea4c0d0>]}
17:57:56.702362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14def81-0c5e-4756-a036-1f66f93e9ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fefd5760>]}
17:57:56.702669 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:57:56.702832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14def81-0c5e-4756-a036-1f66f93e9ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32feab2fa0>]}
17:57:56.704036 [info ] [MainThread]: 
17:57:56.704533 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:56.705672 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:57:56.762214 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:57:56.762413 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:57:56.762484 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:57:56.769349 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:57:56.769553 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:57:56.769624 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:57:56.771085 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:57:56.772256 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:57:56.772650 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:57:56.775900 [debug] [MainThread]: Using postgres connection "master"
17:57:56.776036 [debug] [MainThread]: On master: BEGIN
17:57:56.776102 [debug] [MainThread]: Opening a new connection, currently in state init
17:57:56.780392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:56.780577 [debug] [MainThread]: Using postgres connection "master"
17:57:56.780653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:57:56.790931 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:57:56.791976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14def81-0c5e-4756-a036-1f66f93e9ce1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fef06b50>]}
17:57:56.792212 [debug] [MainThread]: On master: ROLLBACK
17:57:56.792519 [debug] [MainThread]: Using postgres connection "master"
17:57:56.792623 [debug] [MainThread]: On master: BEGIN
17:57:56.793055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:57:56.793166 [debug] [MainThread]: On master: COMMIT
17:57:56.793257 [debug] [MainThread]: Using postgres connection "master"
17:57:56.793323 [debug] [MainThread]: On master: COMMIT
17:57:56.794334 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:56.794548 [debug] [MainThread]: On master: Close
17:57:56.795019 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:57:56.795193 [info ] [MainThread]: 
17:57:56.800024 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:56.800200 [info ] [Thread-1  ]: 1 of 6 START test not_null_costumers_customer_id ............................... [RUN]
17:57:56.800530 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:56.800643 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:56.800731 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:56.814307 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:56.815210 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:57:56.814787 [debug] [Thread-4  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:56.815881 [info ] [Thread-4  ]: 4 of 6 START test unique_costumers_customer_id ................................. [RUN]
17:57:56.816199 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:56.816274 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:56.816352 [debug] [Thread-4  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
17:57:56.815691 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:56.814960 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:56.820981 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:57:56.821373 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:56.821505 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:56.821630 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:56.820560 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:56.824612 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:56.827055 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:56.814885 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:56.827431 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:57:56.827756 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:56.827847 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:56.827917 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:56.814647 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:56.830757 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:57:56.820797 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:56.831009 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:56.831819 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:56.831942 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:56.834440 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:56.831284 [debug] [Thread-2  ]: finished collecting timing info
17:57:56.830597 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:56.835225 [debug] [Thread-5  ]: finished collecting timing info
17:57:56.835536 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:56.834758 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:56.834911 [debug] [Thread-1  ]: finished collecting timing info
17:57:56.855230 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:56.856874 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:56.846848 [debug] [Thread-3  ]: finished collecting timing info
17:57:56.860000 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:56.824335 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:56.820373 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:56.864039 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:56.865117 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:56.862154 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:56.865387 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:57:56.864532 [debug] [Thread-4  ]: finished collecting timing info
17:57:56.864701 [debug] [Thread-6  ]: finished collecting timing info
17:57:56.852927 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:56.866183 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:56.865480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:57:56.865256 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:57:56.866847 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:57:56.865859 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:56.865645 [debug] [Thread-4  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:56.869298 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:56.869576 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:56.868101 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:56.870108 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
17:57:56.870372 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:57:56.861899 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:56.866313 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:57:56.870516 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:56.871785 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:56.872380 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:57:56.872239 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:57:56.872475 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:57:56.872102 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:57:56.872608 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:57:56.873676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:57:56.873810 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:57:56.873879 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:57:56.875032 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:56.876401 [debug] [Thread-1  ]: finished collecting timing info
17:57:56.876518 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:57:56.876884 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:57:56.877185 [info ] [Thread-1  ]: 1 of 6 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.08s]
17:57:56.877464 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:57:56.878850 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:57:56.878974 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:57:56.879040 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:57:56.883577 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:56.884796 [debug] [Thread-4  ]: finished collecting timing info
17:57:56.884987 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
17:57:56.887039 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:57:56.887201 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:57:56.887324 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:57:56.887480 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
17:57:56.888468 [info ] [Thread-4  ]: 4 of 6 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.07s]
17:57:56.888901 [debug] [Thread-4  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
17:57:56.889366 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:56.890453 [debug] [Thread-2  ]: finished collecting timing info
17:57:56.890588 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:57:56.890907 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:57:56.891283 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:57:56.891575 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:57:56.893576 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:57:56.893774 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:57:56.893857 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:57:56.893942 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:57:56.894157 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:57:56.894256 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:57:56.894351 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:57:56.894425 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:57:56.894515 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:57:56.895514 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:57:56.896440 [debug] [Thread-5  ]: finished collecting timing info
17:57:56.896562 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:57:56.896812 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:57:56.897151 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
17:57:56.897446 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:57:56.902566 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.01 seconds
17:57:56.904079 [debug] [Thread-6  ]: finished collecting timing info
17:57:56.904334 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:57:56.905525 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.01 seconds
17:57:56.906680 [debug] [Thread-3  ]: finished collecting timing info
17:57:56.906839 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:57:56.907085 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:57:56.907417 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
17:57:56.907697 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:57:56.908092 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:57:56.908618 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.09s]
17:57:56.908919 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:57:56.910394 [debug] [MainThread]: Acquiring new postgres connection "master"
17:57:56.910526 [debug] [MainThread]: Using postgres connection "master"
17:57:56.910598 [debug] [MainThread]: On master: BEGIN
17:57:56.910661 [debug] [MainThread]: Opening a new connection, currently in state closed
17:57:56.916453 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:57:56.916678 [debug] [MainThread]: On master: COMMIT
17:57:56.916796 [debug] [MainThread]: Using postgres connection "master"
17:57:56.916874 [debug] [MainThread]: On master: COMMIT
17:57:56.917031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:57:56.917151 [debug] [MainThread]: On master: Close
17:57:56.917666 [info ] [MainThread]: 
17:57:56.917952 [info ] [MainThread]: Finished running 6 tests in 0.21s.
17:57:56.918076 [debug] [MainThread]: Connection 'master' was properly closed.
17:57:56.918138 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:57:56.918197 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:57:56.918255 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
17:57:56.918312 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:57:56.918368 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:57:56.918435 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:57:56.928930 [info ] [MainThread]: 
17:57:56.929565 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:57:56.929847 [info ] [MainThread]: 
17:57:56.930055 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:57:56.930292 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:57:56.930430 [info ] [MainThread]: 
17:57:56.930637 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:57:56.930819 [info ] [MainThread]: 
17:57:56.930987 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
17:57:56.931310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fef06be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33007fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32fea4c790>]}


============================== 2022-06-04 17:58:12.981934 | 5613f664-6d26-435a-b3eb-73c7aeb9a728 ==============================
17:58:12.981947 [info ] [MainThread]: Running with dbt=1.1.0
17:58:12.982452 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:58:12.982636 [debug] [MainThread]: Tracking: tracking
17:58:12.985240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3d3ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3d3e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3d3e220>]}
17:58:13.010730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:58:13.010904 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:58:13.015261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5613f664-6d26-435a-b3eb-73c7aeb9a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3c6b0d0>]}
17:58:13.019164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5613f664-6d26-435a-b3eb-73c7aeb9a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3ccf460>]}
17:58:13.019411 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:58:13.022468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5613f664-6d26-435a-b3eb-73c7aeb9a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3ccf430>]}
17:58:13.024052 [info ] [MainThread]: 
17:58:13.024704 [debug] [MainThread]: Acquiring new postgres connection "master"
17:58:13.025667 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:58:13.032440 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:58:13.032645 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:58:13.032725 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:58:13.042868 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:58:13.043077 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:58:13.043201 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:58:13.045790 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:58:13.046824 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:58:13.047200 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:58:13.050233 [debug] [MainThread]: Using postgres connection "master"
17:58:13.050379 [debug] [MainThread]: On master: BEGIN
17:58:13.050447 [debug] [MainThread]: Opening a new connection, currently in state init
17:58:13.057904 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:58:13.058121 [debug] [MainThread]: Using postgres connection "master"
17:58:13.058190 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:58:13.068319 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:58:13.069385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5613f664-6d26-435a-b3eb-73c7aeb9a728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3c39ee0>]}
17:58:13.069639 [debug] [MainThread]: On master: ROLLBACK
17:58:13.069956 [debug] [MainThread]: Using postgres connection "master"
17:58:13.070076 [debug] [MainThread]: On master: BEGIN
17:58:13.070557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:58:13.070666 [debug] [MainThread]: On master: COMMIT
17:58:13.070744 [debug] [MainThread]: Using postgres connection "master"
17:58:13.070836 [debug] [MainThread]: On master: COMMIT
17:58:13.071167 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:58:13.071291 [debug] [MainThread]: On master: Close
17:58:13.071817 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:58:13.072068 [info ] [MainThread]: 
17:58:13.076604 [debug] [Thread-1  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:58:13.076763 [info ] [Thread-1  ]: 1 of 6 START test not_null_costumers_customer_id ............................... [RUN]
17:58:13.077183 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:58:13.077332 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
17:58:13.077415 [debug] [Thread-1  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
17:58:13.087003 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:13.087200 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:58:13.087651 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:13.087770 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:13.087905 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:13.095582 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:13.095921 [debug] [Thread-4  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
17:58:13.096496 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:58:13.104118 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:13.104252 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:13.104335 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:13.102076 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:13.140361 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:58:13.101912 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:58:13.102168 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:13.141177 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:58:13.140068 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:13.140809 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:13.142001 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:13.142138 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:13.103701 [info ] [Thread-4  ]: 4 of 6 START test unique_costumers_customer_id ................................. [RUN]
17:58:13.141733 [debug] [Thread-1  ]: finished collecting timing info
17:58:13.141495 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:13.103502 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:13.146228 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:13.146933 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
17:58:13.147131 [debug] [Thread-3  ]: finished collecting timing info
17:58:13.147471 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:13.157969 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:13.160038 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:13.157488 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:58:13.157817 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:13.147793 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:58:13.161893 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
17:58:13.160441 [debug] [Thread-6  ]: finished collecting timing info
17:58:13.164598 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:13.166030 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:13.166340 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:13.166504 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:58:13.166580 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:58:13.161651 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:13.167796 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:13.167953 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:58:13.168025 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:58:13.161985 [debug] [Thread-4  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
17:58:13.162090 [debug] [Thread-2  ]: finished collecting timing info
17:58:13.172348 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:58:13.153507 [debug] [Thread-5  ]: finished collecting timing info
17:58:13.174274 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:13.173339 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:13.173765 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:58:13.174138 [debug] [Thread-4  ]: finished collecting timing info
17:58:13.178013 [debug] [Thread-4  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
17:58:13.178996 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
17:58:13.177798 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:58:13.175581 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:13.179593 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:13.179672 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:58:13.179225 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:58:13.179402 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:58:13.179992 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
17:58:13.180140 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:58:13.162293 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:58:13.180705 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
17:58:13.180924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:58:13.179741 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:58:13.177594 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:13.182142 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:13.184064 [debug] [Thread-6  ]: finished collecting timing info
17:58:13.184211 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:58:13.184729 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:13.185611 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:58:13.186129 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
17:58:13.186503 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:58:13.185731 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:58:13.188029 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:58:13.188416 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:58:13.188832 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:58:13.188917 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:58:13.188714 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
17:58:13.189057 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:58:13.188296 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:58:13.188547 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:58:13.189375 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
17:58:13.189460 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
17:58:13.190744 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:13.191737 [debug] [Thread-3  ]: finished collecting timing info
17:58:13.192417 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:58:13.192769 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:58:13.193078 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
17:58:13.193393 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:58:13.191872 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:13.194760 [debug] [Thread-4  ]: finished collecting timing info
17:58:13.194872 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
17:58:13.200738 [debug] [Thread-4  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
17:58:13.201391 [info ] [Thread-4  ]: 4 of 6 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.05s]
17:58:13.201788 [debug] [Thread-4  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
17:58:13.202348 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
17:58:13.203439 [debug] [Thread-1  ]: finished collecting timing info
17:58:13.203606 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:58:13.203953 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
17:58:13.204136 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:58:13.204372 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:58:13.204491 [debug] [Thread-1  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
17:58:13.204952 [info ] [Thread-1  ]: 1 of 6 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.13s]
17:58:13.205229 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
17:58:13.206438 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:13.207425 [debug] [Thread-2  ]: finished collecting timing info
17:58:13.207562 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:58:13.208340 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:58:13.208633 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
17:58:13.208992 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:58:13.209952 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
17:58:13.210064 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:58:13.210138 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:58:13.210851 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:58:13.211894 [debug] [Thread-5  ]: finished collecting timing info
17:58:13.212008 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:58:13.212215 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:58:13.212510 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
17:58:13.212798 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:58:13.214451 [debug] [MainThread]: Acquiring new postgres connection "master"
17:58:13.214702 [debug] [MainThread]: Using postgres connection "master"
17:58:13.214798 [debug] [MainThread]: On master: BEGIN
17:58:13.214862 [debug] [MainThread]: Opening a new connection, currently in state closed
17:58:13.219015 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:58:13.219183 [debug] [MainThread]: On master: COMMIT
17:58:13.219260 [debug] [MainThread]: Using postgres connection "master"
17:58:13.219321 [debug] [MainThread]: On master: COMMIT
17:58:13.219441 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:58:13.219568 [debug] [MainThread]: On master: Close
17:58:13.219854 [info ] [MainThread]: 
17:58:13.220014 [info ] [MainThread]: Finished running 6 tests in 0.20s.
17:58:13.220129 [debug] [MainThread]: Connection 'master' was properly closed.
17:58:13.220184 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
17:58:13.220234 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:58:13.220285 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:58:13.220332 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:58:13.220382 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:58:13.220430 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
17:58:13.224099 [info ] [MainThread]: 
17:58:13.224326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:58:13.224507 [info ] [MainThread]: 
17:58:13.224610 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:58:13.224715 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:58:13.224805 [info ] [MainThread]: 
17:58:13.224896 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:58:13.224995 [info ] [MainThread]: 
17:58:13.225087 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
17:58:13.225261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a3ccf160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a698d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3a036db80>]}


============================== 2022-06-04 18:00:07.173171 | 7eb02c97-761d-4059-8f9f-4321d7868bbd ==============================
18:00:07.173185 [info ] [MainThread]: Running with dbt=1.1.0
18:00:07.173723 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:07.173831 [debug] [MainThread]: Tracking: tracking
18:00:07.176727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55af8b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55af8bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55af8be20>]}
18:00:07.190982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55af8f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55ae86940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55ae86670>]}


============================== 2022-06-04 18:00:22.300438 | 48c78208-59c1-4119-9868-c2dc920b9949 ==============================
18:00:22.300452 [info ] [MainThread]: Running with dbt=1.1.0
18:00:22.300780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:22.300862 [debug] [MainThread]: Tracking: tracking
18:00:22.303298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2306de8f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2306de8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2306de81f0>]}
18:00:22.320941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2306dfc760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2306ce8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2306ce8670>]}


============================== 2022-06-04 18:00:56.329130 | f8fa6d29-fffd-4b00-9e10-9f7df5d84b31 ==============================
18:00:56.329145 [info ] [MainThread]: Running with dbt=1.1.0
18:00:56.329464 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:56.329552 [debug] [MainThread]: Tracking: tracking
18:00:56.332027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93812e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93812ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93812e6d0>]}
18:00:56.353402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
18:00:56.353828 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:00:56.354044 [debug] [MainThread]: Partial parsing: updated file: first_project://models/example/my_first_dbt_model.sql
18:00:56.364995 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
18:00:56.374026 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
18:00:56.432537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8fa6d29-fffd-4b00-9e10-9f7df5d84b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93813a910>]}
18:00:56.435935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8fa6d29-fffd-4b00-9e10-9f7df5d84b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93802a6d0>]}
18:00:56.436173 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:00:56.436356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8fa6d29-fffd-4b00-9e10-9f7df5d84b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93802adf0>]}
18:00:56.437454 [info ] [MainThread]: 
18:00:56.437853 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:56.438686 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:00:56.445879 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:56.446083 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:00:56.446179 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:56.454252 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:00:56.454558 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:56.454655 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:56.456406 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:00:56.457464 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:00:56.457662 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:00:56.460380 [debug] [MainThread]: Using postgres connection "master"
18:00:56.460489 [debug] [MainThread]: On master: BEGIN
18:00:56.460567 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:56.465319 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:56.465506 [debug] [MainThread]: Using postgres connection "master"
18:00:56.465608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:56.478858 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:00:56.479993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8fa6d29-fffd-4b00-9e10-9f7df5d84b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff93802a8b0>]}
18:00:56.480288 [debug] [MainThread]: On master: ROLLBACK
18:00:56.480520 [debug] [MainThread]: Using postgres connection "master"
18:00:56.480612 [debug] [MainThread]: On master: BEGIN
18:00:56.480797 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:56.480884 [debug] [MainThread]: On master: COMMIT
18:00:56.480948 [debug] [MainThread]: Using postgres connection "master"
18:00:56.481006 [debug] [MainThread]: On master: COMMIT
18:00:56.481145 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:56.481231 [debug] [MainThread]: On master: Close
18:00:56.481489 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:00:56.481636 [info ] [MainThread]: 
18:00:56.486015 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:00:56.486177 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:00:56.486518 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:00:56.486628 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:00:56.486702 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:00:56.491810 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:00:56.491976 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:00:56.492455 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:00:56.492707 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:00:56.492842 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:00:56.492961 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:00:56.492168 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:00:56.503619 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:00:56.503914 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:00:56.503994 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:00:56.504062 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:00:56.503253 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:00:56.492050 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:56.509858 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:00:56.510158 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:56.510249 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:56.510356 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:56.509571 [debug] [Thread-1  ]: finished collecting timing info
18:00:56.512556 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:56.492289 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:56.513277 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:00:56.513525 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:56.513601 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:56.513670 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:56.513049 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:00:56.512874 [debug] [Thread-2  ]: finished collecting timing info
18:00:56.515693 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:56.531003 [debug] [Thread-7  ]: finished collecting timing info
18:00:56.531208 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:56.532379 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:56.532635 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:56.532756 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:00:56.532851 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:00:56.492226 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:56.533327 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:00:56.533592 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:56.533725 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:56.533804 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:56.535923 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:56.536125 [debug] [Thread-6  ]: finished collecting timing info
18:00:56.536216 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:56.537112 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:56.537310 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:56.537395 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:00:56.537495 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:00:56.492109 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:56.515956 [debug] [Thread-3  ]: finished collecting timing info
18:00:56.537820 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:00:56.509307 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:00:56.537981 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:56.530259 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:00:56.538608 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:56.540283 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:56.542435 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:56.541757 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:56.542588 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:00:56.543136 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:00:56.542716 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:56.530552 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:00:56.549740 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:00:56.552562 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: BEGIN
18:00:56.552201 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:00:56.552664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:56.553534 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:00:56.553633 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:00:56.552856 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:00:56.552985 [debug] [Thread-5  ]: finished collecting timing info
18:00:56.550866 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:56.553723 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:00:56.552755 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:00:56.555387 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:56.555473 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:56.554214 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:56.555913 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:56.554757 [debug] [Thread-4  ]: finished collecting timing info
18:00:56.556063 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:56.554422 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:00:56.557281 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:56.559225 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:00:56.559375 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:56.561537 [debug] [Thread-6  ]: finished collecting timing info
18:00:56.561659 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:00:56.560037 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:56.559868 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:00:56.563716 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:00:56.563795 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:00:56.563591 [debug] [Thread-7  ]: finished collecting timing info
18:00:56.564112 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:00:56.562611 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:00:56.564339 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:56.564448 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:56.561901 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:00:56.564812 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.03s]
18:00:56.565073 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:56.560150 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:56.565561 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:00:56.565634 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:00:56.568957 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:00:56.569419 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:00:56.569610 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:56.571352 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:56.572474 [debug] [Thread-3  ]: finished collecting timing info
18:00:56.572895 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:00:56.573222 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:00:56.573581 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
18:00:56.573972 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:56.577620 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:00:56.577811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:00:56.577981 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:00:56.578188 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:00:56.578341 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:00:56.578502 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:00:56.579692 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:00:56.579791 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:00:56.579857 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:00:56.579954 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:00:56.580058 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:56.580124 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:56.580856 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:56.581906 [debug] [Thread-2  ]: finished collecting timing info
18:00:56.582035 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:00:56.582170 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:56.582296 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:56.583137 [debug] [Thread-5  ]: finished collecting timing info
18:00:56.584322 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:00:56.583216 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:00:56.584168 [debug] [Thread-4  ]: finished collecting timing info
18:00:56.584511 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:00:56.584784 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.09s]
18:00:56.587813 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:00:56.588087 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:00:56.588373 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:00:56.588679 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.08s]
18:00:56.589297 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.05s]
18:00:56.589635 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:00:56.589928 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:56.590469 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:56.591470 [debug] [Thread-1  ]: finished collecting timing info
18:00:56.591604 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: ROLLBACK
18:00:56.591868 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: Close
18:00:56.592299 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.11s]
18:00:56.592585 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:00:56.596710 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:56.596912 [debug] [MainThread]: Using postgres connection "master"
18:00:56.597027 [debug] [MainThread]: On master: BEGIN
18:00:56.597098 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:56.601637 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:56.601965 [debug] [MainThread]: On master: COMMIT
18:00:56.602122 [debug] [MainThread]: Using postgres connection "master"
18:00:56.602245 [debug] [MainThread]: On master: COMMIT
18:00:56.602399 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:56.602492 [debug] [MainThread]: On master: Close
18:00:56.602849 [info ] [MainThread]: 
18:00:56.603027 [info ] [MainThread]: Finished running 7 tests in 0.17s.
18:00:56.603149 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:56.603214 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b' was properly closed.
18:00:56.603276 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:00:56.603336 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:00:56.603397 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:00:56.603454 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:00:56.603503 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:00:56.603553 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:00:56.608438 [info ] [MainThread]: 
18:00:56.608781 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:00:56.608945 [info ] [MainThread]: 
18:00:56.609075 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:00:56.609211 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:00:56.609328 [info ] [MainThread]: 
18:00:56.609446 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:00:56.609610 [info ] [MainThread]: 
18:00:56.609881 [error] [MainThread]: [31mFailure in test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:00:56.610009 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:00:56.610123 [info ] [MainThread]: 
18:00:56.610237 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_costumers_15dc3e0603e21b47c18d5f8bcf15e569.sql
18:00:56.610368 [info ] [MainThread]: 
18:00:56.610522 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:00:56.610780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9381415b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff939f302b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff938128190>]}


============================== 2022-06-04 18:03:49.228865 | 405ce073-3161-4e9e-94a6-f74667829326 ==============================
18:03:49.228878 [info ] [MainThread]: Running with dbt=1.1.0
18:03:49.229218 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:03:49.229305 [debug] [MainThread]: Tracking: tracking
18:03:49.231891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b463d9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b463d9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b463d9e80>]}
18:03:49.251532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:03:49.251842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:03:49.256540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '405ce073-3161-4e9e-94a6-f74667829326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b4628a0d0>]}
18:03:49.261402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '405ce073-3161-4e9e-94a6-f74667829326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b463766d0>]}
18:03:49.261798 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:03:49.262004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405ce073-3161-4e9e-94a6-f74667829326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46376610>]}
18:03:49.263173 [info ] [MainThread]: 
18:03:49.263518 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:49.265542 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:03:49.272261 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:03:49.272450 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:03:49.272534 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:03:49.279411 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:03:49.279630 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:03:49.279711 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:03:49.281343 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:03:49.282650 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:03:49.282984 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:03:49.286059 [debug] [MainThread]: Using postgres connection "master"
18:03:49.286192 [debug] [MainThread]: On master: BEGIN
18:03:49.286261 [debug] [MainThread]: Opening a new connection, currently in state init
18:03:49.292389 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:49.292606 [debug] [MainThread]: Using postgres connection "master"
18:03:49.292705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:03:49.303564 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:03:49.304889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405ce073-3161-4e9e-94a6-f74667829326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b462d4c40>]}
18:03:49.305173 [debug] [MainThread]: On master: ROLLBACK
18:03:49.305478 [debug] [MainThread]: Using postgres connection "master"
18:03:49.305600 [debug] [MainThread]: On master: BEGIN
18:03:49.305901 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:03:49.306004 [debug] [MainThread]: On master: COMMIT
18:03:49.306074 [debug] [MainThread]: Using postgres connection "master"
18:03:49.306130 [debug] [MainThread]: On master: COMMIT
18:03:49.306246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:49.306366 [debug] [MainThread]: On master: Close
18:03:49.306741 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:03:49.306907 [info ] [MainThread]: 
18:03:49.312975 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:03:49.313225 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:03:49.313628 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:03:49.313933 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:03:49.314778 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:03:49.315120 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:03:49.315230 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:03:49.315326 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:03:49.314460 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:49.325539 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:03:49.325927 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:49.326040 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:49.326120 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:49.314171 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:49.325282 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:03:49.314246 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:49.332467 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:03:49.332969 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:49.314068 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:03:49.333232 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:03:49.331724 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:49.368999 [debug] [Thread-6  ]: finished collecting timing info
18:03:49.333078 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:49.314388 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:03:49.332032 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:03:49.314562 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:49.374750 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:03:49.375008 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:49.375086 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:49.375151 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:49.373891 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:49.374526 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:49.379820 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:49.379913 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:49.369429 [debug] [Thread-2  ]: finished collecting timing info
18:03:49.382492 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:03:49.377314 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:49.379569 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:49.374115 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:03:49.369272 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:49.382198 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:49.395770 [debug] [Thread-3  ]: finished collecting timing info
18:03:49.393009 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:03:49.393846 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:03:49.396224 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:03:49.395360 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:49.396539 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:49.395936 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:49.373654 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:03:49.396315 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:03:49.401068 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:03:49.395485 [debug] [Thread-4  ]: finished collecting timing info
18:03:49.394212 [debug] [Thread-7  ]: finished collecting timing info
18:03:49.402324 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:49.403630 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:49.401373 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:49.396667 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:03:49.401983 [debug] [Thread-1  ]: finished collecting timing info
18:03:49.402212 [debug] [Thread-5  ]: finished collecting timing info
18:03:49.396780 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:03:49.406858 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:03:49.406952 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:03:49.405963 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:49.406197 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:03:49.411545 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:03:49.411736 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:49.411823 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:03:49.406672 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:03:49.413228 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:03:49.413580 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:03:49.413736 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:03:49.398435 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:49.413811 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:03:49.403914 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:49.414673 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:49.415608 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:03:49.415683 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:03:49.415495 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:03:49.415849 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:03:49.416199 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:49.406467 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:03:49.418846 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:03:49.417651 [debug] [Thread-6  ]: finished collecting timing info
18:03:49.419134 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:03:49.415261 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:49.419263 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:03:49.419352 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:03:49.419447 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:03:49.420384 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:03:49.420598 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: BEGIN
18:03:49.420669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:03:49.421036 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
18:03:49.421301 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:49.428228 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
18:03:49.428426 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:03:49.429132 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:49.428809 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:03:49.429047 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:03:49.428594 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:49.429216 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:03:49.429369 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:03:49.429504 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:03:49.429645 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:03:49.429818 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:03:49.429914 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:03:49.430796 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:49.432299 [debug] [Thread-7  ]: finished collecting timing info
18:03:49.432473 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:49.432658 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:49.434839 [debug] [Thread-5  ]: finished collecting timing info
18:03:49.433992 [debug] [Thread-3  ]: finished collecting timing info
18:03:49.435075 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:03:49.434949 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:03:49.432778 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:03:49.435533 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:03:49.435899 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
18:03:49.436020 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:03:49.436326 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:49.436738 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:03:49.436979 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:49.438407 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:03:49.438838 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.05s]
18:03:49.439120 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:03:49.439556 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:03:49.440483 [debug] [Thread-2  ]: finished collecting timing info
18:03:49.440659 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:03:49.441037 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:03:49.441359 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.13s]
18:03:49.441591 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:03:49.445019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:03:49.445224 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"
18:03:49.445310 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:03:49.445500 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:03:49.445645 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:49.445752 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:03:49.447358 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:49.448784 [debug] [Thread-4  ]: finished collecting timing info
18:03:49.448946 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:03:49.449103 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:49.450008 [debug] [Thread-1  ]: finished collecting timing info
18:03:49.450165 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: ROLLBACK
18:03:49.450323 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:03:49.450624 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.12s]
18:03:49.450792 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b: Close
18:03:49.451062 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.14s]
18:03:49.451544 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:49.451778 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b
18:03:49.453049 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:49.453172 [debug] [MainThread]: Using postgres connection "master"
18:03:49.453237 [debug] [MainThread]: On master: BEGIN
18:03:49.453292 [debug] [MainThread]: Opening a new connection, currently in state closed
18:03:49.460065 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:49.460262 [debug] [MainThread]: On master: COMMIT
18:03:49.460332 [debug] [MainThread]: Using postgres connection "master"
18:03:49.460390 [debug] [MainThread]: On master: COMMIT
18:03:49.460703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:49.460839 [debug] [MainThread]: On master: Close
18:03:49.461155 [info ] [MainThread]: 
18:03:49.461302 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:03:49.461433 [debug] [MainThread]: Connection 'master' was properly closed.
18:03:49.461497 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.e7eea0738b' was properly closed.
18:03:49.461549 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:03:49.461597 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:03:49.461652 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:03:49.461801 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:03:49.461891 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:03:49.461967 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:03:49.466980 [info ] [MainThread]: 
18:03:49.467328 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:03:49.467589 [info ] [MainThread]: 
18:03:49.467816 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:03:49.468039 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:03:49.468200 [info ] [MainThread]: 
18:03:49.468333 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:03:49.468466 [info ] [MainThread]: 
18:03:49.468737 [error] [MainThread]: [31mFailure in test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:03:49.468893 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:03:49.469025 [info ] [MainThread]: 
18:03:49.469152 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_costumers_15dc3e0603e21b47c18d5f8bcf15e569.sql
18:03:49.469292 [info ] [MainThread]: 
18:03:49.469423 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:03:49.469790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b442276a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b462618b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b46261e80>]}


============================== 2022-06-04 18:07:57.996680 | dc48b8c8-ea32-4580-82b5-b3aa0015223f ==============================
18:07:57.996702 [info ] [MainThread]: Running with dbt=1.1.0
18:07:57.997400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:07:57.997621 [debug] [MainThread]: Tracking: tracking
18:07:58.001431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e6ff1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e6ff1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e6ff1e20>]}
18:07:58.026065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:07:58.026643 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:07:58.034471 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
18:07:58.104896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc48b8c8-ea32-4580-82b5-b3aa0015223f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e880d850>]}
18:07:58.111051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc48b8c8-ea32-4580-82b5-b3aa0015223f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e6eebf40>]}
18:07:58.111307 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:07:58.111529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc48b8c8-ea32-4580-82b5-b3aa0015223f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e6eebe50>]}
18:07:58.112515 [info ] [MainThread]: 
18:07:58.112884 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:58.113840 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:07:58.121228 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:07:58.121392 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:07:58.121464 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:07:58.128885 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:07:58.129137 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:07:58.129216 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:07:58.132553 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:07:58.133892 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:07:58.134283 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:07:58.138708 [debug] [MainThread]: Using postgres connection "master"
18:07:58.138913 [debug] [MainThread]: On master: BEGIN
18:07:58.138985 [debug] [MainThread]: Opening a new connection, currently in state init
18:07:58.142987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:58.143149 [debug] [MainThread]: Using postgres connection "master"
18:07:58.143219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:07:58.154970 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:07:58.155983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc48b8c8-ea32-4580-82b5-b3aa0015223f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e6eebd00>]}
18:07:58.156228 [debug] [MainThread]: On master: ROLLBACK
18:07:58.156538 [debug] [MainThread]: Using postgres connection "master"
18:07:58.156659 [debug] [MainThread]: On master: BEGIN
18:07:58.157137 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:58.157243 [debug] [MainThread]: On master: COMMIT
18:07:58.157310 [debug] [MainThread]: Using postgres connection "master"
18:07:58.157366 [debug] [MainThread]: On master: COMMIT
18:07:58.157637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:58.157772 [debug] [MainThread]: On master: Close
18:07:58.158067 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:07:58.158276 [info ] [MainThread]: 
18:07:58.162849 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:07:58.163019 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:07:58.163338 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:07:58.163451 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:07:58.163538 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:07:58.170358 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:07:58.170598 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:07:58.171275 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:07:58.171542 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:07:58.171621 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:07:58.171688 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:07:58.170694 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:07:58.170765 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:07:58.170836 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:07:58.179194 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:07:58.171067 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:07:58.179879 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:07:58.180225 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:07:58.180325 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:07:58.180402 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:07:58.170897 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:07:58.185601 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:07:58.178575 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:07:58.178371 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:07:58.178803 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:07:58.184614 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:07:58.179041 [debug] [Thread-1  ]: finished collecting timing info
18:07:58.179688 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:07:58.186136 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:07:58.186618 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:07:58.187092 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:07:58.188723 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:07:58.187812 [debug] [Thread-7  ]: finished collecting timing info
18:07:58.188071 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:07:58.189080 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:07:58.188313 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:07:58.188504 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:07:58.192880 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:07:58.188834 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:07:58.188977 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:07:58.187971 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:07:58.192409 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:07:58.192689 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:07:58.187607 [debug] [Thread-2  ]: finished collecting timing info
18:07:58.218648 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:07:58.197790 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:07:58.225730 [debug] [Thread-4  ]: finished collecting timing info
18:07:58.218040 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:07:58.218422 [debug] [Thread-5  ]: finished collecting timing info
18:07:58.195155 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:07:58.219952 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:07:58.226794 [debug] [Thread-3  ]: finished collecting timing info
18:07:58.215838 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:07:58.225968 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:07:58.228728 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:07:58.226919 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:07:58.227058 [debug] [Thread-6  ]: finished collecting timing info
18:07:58.225333 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:07:58.227440 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:07:58.226359 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:07:58.228982 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:07:58.230542 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:07:58.230872 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:07:58.234725 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:07:58.234970 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:07:58.231732 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:07:58.235200 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:07:58.232965 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:07:58.233234 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:07:58.236073 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:07:58.235119 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:07:58.233557 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:07:58.237299 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:07:58.231195 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:07:58.236334 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:07:58.237135 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:07:58.237406 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:07:58.231559 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:07:58.237540 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:07:58.237932 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:07:58.240560 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:07:58.240415 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:07:58.240006 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:07:58.240957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:07:58.242029 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:07:58.242125 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:07:58.242188 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:07:58.243670 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:07:58.245169 [debug] [Thread-2  ]: finished collecting timing info
18:07:58.245295 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:07:58.245498 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:07:58.245894 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.07s]
18:07:58.246431 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:07:58.246513 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:07:58.246745 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:07:58.246837 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:07:58.247475 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:07:58.248321 [debug] [Thread-4  ]: finished collecting timing info
18:07:58.248427 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:07:58.249203 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:07:58.249469 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
18:07:58.249791 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:07:58.252693 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:07:58.252872 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:07:58.253007 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:07:58.253986 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
18:07:58.254137 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:07:58.254228 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:07:58.256521 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:07:58.257575 [debug] [Thread-7  ]: finished collecting timing info
18:07:58.257792 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:07:58.257954 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:07:58.258885 [debug] [Thread-3  ]: finished collecting timing info
18:07:58.258997 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:07:58.259543 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:07:58.259849 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
18:07:58.259995 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:07:58.260482 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:07:58.260776 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:07:58.261383 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:07:58.260944 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:07:58.261566 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:07:58.261638 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:07:58.262366 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:07:58.263172 [debug] [Thread-6  ]: finished collecting timing info
18:07:58.263326 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:07:58.264212 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:07:58.264587 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
18:07:58.264882 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:07:58.268071 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:07:58.268324 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:07:58.268424 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:07:58.270044 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:07:58.270397 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:07:58.270565 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:07:58.270729 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:07:58.271884 [debug] [Thread-1  ]: finished collecting timing info
18:07:58.272020 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:07:58.272285 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:07:58.272686 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.11s]
18:07:58.272956 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:07:58.276061 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:07:58.277219 [debug] [Thread-5  ]: finished collecting timing info
18:07:58.277380 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:07:58.277572 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:07:58.277943 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.10s]
18:07:58.278312 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:07:58.280918 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:58.281130 [debug] [MainThread]: Using postgres connection "master"
18:07:58.281233 [debug] [MainThread]: On master: BEGIN
18:07:58.281325 [debug] [MainThread]: Opening a new connection, currently in state closed
18:07:58.286296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:58.286502 [debug] [MainThread]: On master: COMMIT
18:07:58.286571 [debug] [MainThread]: Using postgres connection "master"
18:07:58.286639 [debug] [MainThread]: On master: COMMIT
18:07:58.286874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:58.287034 [debug] [MainThread]: On master: Close
18:07:58.287567 [info ] [MainThread]: 
18:07:58.287888 [info ] [MainThread]: Finished running 7 tests in 0.17s.
18:07:58.288034 [debug] [MainThread]: Connection 'master' was properly closed.
18:07:58.288099 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:07:58.288154 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:07:58.288208 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:07:58.288259 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:07:58.288310 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:07:58.288361 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:07:58.288412 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:07:58.292655 [info ] [MainThread]: 
18:07:58.292861 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:07:58.292994 [info ] [MainThread]: 
18:07:58.293100 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:07:58.293213 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:07:58.293311 [info ] [MainThread]: 
18:07:58.293409 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:07:58.293524 [info ] [MainThread]: 
18:07:58.293693 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:07:58.293872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e87c98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e87c9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98e41e5820>]}


============================== 2022-06-04 18:14:28.899285 | 47d84000-60cb-475a-b767-7d535d23f0c8 ==============================
18:14:28.899302 [info ] [MainThread]: Running with dbt=1.1.0
18:14:28.899808 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:14:28.899989 [debug] [MainThread]: Tracking: tracking
18:14:28.916309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b8c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b8c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b8c2b0>]}
18:14:28.946514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
18:14:28.946936 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:14:28.947177 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
18:14:28.947347 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers2.sql
18:14:28.954980 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:14:28.963703 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
18:14:28.965713 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers2.sql
18:14:29.023045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47d84000-60cb-475a-b767-7d535d23f0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b90490>]}
18:14:29.026667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47d84000-60cb-475a-b767-7d535d23f0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b8e1c0>]}
18:14:29.026946 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:14:29.027108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d84000-60cb-475a-b767-7d535d23f0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b8ea30>]}
18:14:29.028237 [info ] [MainThread]: 
18:14:29.028585 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:29.029450 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:14:29.037793 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:29.038010 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:14:29.038094 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:14:29.047564 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:14:29.047819 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:29.047937 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:14:29.049844 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:14:29.051070 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:14:29.051324 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:14:29.057077 [debug] [MainThread]: Using postgres connection "master"
18:14:29.057413 [debug] [MainThread]: On master: BEGIN
18:14:29.057499 [debug] [MainThread]: Opening a new connection, currently in state init
18:14:29.065030 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:14:29.065460 [debug] [MainThread]: Using postgres connection "master"
18:14:29.065674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:14:29.077643 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:14:29.078695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47d84000-60cb-475a-b767-7d535d23f0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2a83df0>]}
18:14:29.079006 [debug] [MainThread]: On master: ROLLBACK
18:14:29.079307 [debug] [MainThread]: Using postgres connection "master"
18:14:29.079420 [debug] [MainThread]: On master: BEGIN
18:14:29.079816 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:14:29.079926 [debug] [MainThread]: On master: COMMIT
18:14:29.079998 [debug] [MainThread]: Using postgres connection "master"
18:14:29.080065 [debug] [MainThread]: On master: COMMIT
18:14:29.080290 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:29.080403 [debug] [MainThread]: On master: Close
18:14:29.080733 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:14:29.080975 [info ] [MainThread]: 
18:14:29.092427 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:14:29.092797 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:14:29.093500 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:14:29.093604 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:14:29.093795 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:14:29.100730 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:14:29.100978 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:14:29.101129 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:14:29.101673 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:14:29.103134 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:14:29.102435 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:14:29.103435 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:14:29.104004 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:14:29.104126 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:14:29.102980 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:14:29.102532 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:14:29.104688 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:14:29.105017 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:14:29.105094 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:14:29.105161 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:14:29.102223 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:14:29.104434 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:14:29.109659 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:14:29.102601 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:14:29.104212 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:14:29.109176 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:14:29.103225 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:14:29.102701 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:14:29.109801 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:14:29.123619 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:14:29.110264 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:14:29.126347 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:14:29.126460 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:14:29.121970 [debug] [Thread-5  ]: finished collecting timing info
18:14:29.126729 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:14:29.123435 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:14:29.125955 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:14:29.122914 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:14:29.126530 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:14:29.121816 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:14:29.110091 [debug] [Thread-1  ]: finished collecting timing info
18:14:29.144229 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:14:29.145469 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:14:29.132182 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:14:29.141333 [debug] [Thread-7  ]: finished collecting timing info
18:14:29.146685 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:14:29.145740 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:14:29.156465 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:14:29.146558 [debug] [Thread-2  ]: finished collecting timing info
18:14:29.143638 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:14:29.157536 [debug] [Thread-6  ]: finished collecting timing info
18:14:29.157778 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:14:29.151527 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:14:29.145997 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:14:29.156927 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:14:29.157267 [debug] [Thread-3  ]: finished collecting timing info
18:14:29.161123 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:14:29.140939 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:14:29.143874 [debug] [Thread-4  ]: finished collecting timing info
18:14:29.159420 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:14:29.162885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:14:29.160698 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:14:29.159083 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:14:29.162138 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:14:29.164252 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:14:29.162777 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:14:29.160997 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:14:29.164032 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:14:29.162581 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:14:29.164431 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:14:29.168036 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:14:29.168112 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:14:29.167507 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:14:29.168359 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:14:29.167679 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:14:29.169204 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:14:29.167032 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:14:29.169947 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:14:29.170207 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:14:29.170325 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:14:29.165500 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:14:29.170642 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:14:29.167897 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:14:29.171732 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:14:29.172525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:14:29.172637 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:14:29.172704 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:14:29.174602 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:14:29.176874 [debug] [Thread-1  ]: finished collecting timing info
18:14:29.177011 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:14:29.178009 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:14:29.178364 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.09s]
18:14:29.178649 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:14:29.185741 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:14:29.185985 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:14:29.186091 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:14:29.186823 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:14:29.187110 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:14:29.187199 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:14:29.187362 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:14:29.187598 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:14:29.187681 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:14:29.189395 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:14:29.190546 [debug] [Thread-6  ]: finished collecting timing info
18:14:29.190764 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:14:29.190986 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:14:29.191071 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:14:29.191150 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:14:29.191813 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:14:29.192688 [debug] [Thread-4  ]: finished collecting timing info
18:14:29.192843 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:14:29.193102 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:14:29.193221 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:14:29.193293 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:14:29.194035 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:14:29.194230 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.01 seconds
18:14:29.195096 [debug] [Thread-3  ]: finished collecting timing info
18:14:29.202348 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:14:29.195278 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:14:29.196041 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:14:29.195172 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:14:29.204329 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
18:14:29.204643 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:14:29.204780 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:14:29.205015 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
18:14:29.205337 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:14:29.203916 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
18:14:29.201087 [debug] [Thread-7  ]: finished collecting timing info
18:14:29.205693 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:14:29.199495 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:14:29.207247 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:14:29.207371 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:14:29.206076 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:14:29.203602 [debug] [Thread-2  ]: finished collecting timing info
18:14:29.210015 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:14:29.210260 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:14:29.210632 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
18:14:29.211146 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:14:29.211373 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:14:29.211642 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.11s]
18:14:29.211879 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:14:29.214341 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:14:29.215331 [debug] [Thread-5  ]: finished collecting timing info
18:14:29.215455 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:14:29.215744 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:14:29.216083 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.11s]
18:14:29.216428 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:14:29.219335 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:29.219671 [debug] [MainThread]: Using postgres connection "master"
18:14:29.219756 [debug] [MainThread]: On master: BEGIN
18:14:29.219836 [debug] [MainThread]: Opening a new connection, currently in state closed
18:14:29.226642 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:14:29.226858 [debug] [MainThread]: On master: COMMIT
18:14:29.226934 [debug] [MainThread]: Using postgres connection "master"
18:14:29.227039 [debug] [MainThread]: On master: COMMIT
18:14:29.227298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:29.227425 [debug] [MainThread]: On master: Close
18:14:29.227770 [info ] [MainThread]: 
18:14:29.228015 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:14:29.228175 [debug] [MainThread]: Connection 'master' was properly closed.
18:14:29.228248 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:14:29.228305 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:14:29.228361 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:14:29.228415 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:14:29.228468 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:14:29.228522 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:14:29.228644 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:14:29.232483 [info ] [MainThread]: 
18:14:29.232773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:14:29.232984 [info ] [MainThread]: 
18:14:29.233117 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:14:29.233254 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:14:29.233375 [info ] [MainThread]: 
18:14:29.233498 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:14:29.233642 [info ] [MainThread]: 
18:14:29.233865 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:14:29.237119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2b9bb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f4361940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11f2aab3d0>]}


============================== 2022-06-04 18:14:35.567809 | 32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05 ==============================
18:14:35.567831 [info ] [MainThread]: Running with dbt=1.1.0
18:14:35.568302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:14:35.568403 [debug] [MainThread]: Tracking: tracking
18:14:35.571372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71a88070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71a88040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71a882b0>]}
18:14:35.596495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:14:35.596765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:14:35.602486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7193df10>]}
18:14:35.612775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71a17a00>]}
18:14:35.613184 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:14:35.613489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71a17a90>]}
18:14:35.615372 [info ] [MainThread]: 
18:14:35.615892 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:35.617146 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:14:35.627700 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:14:35.627904 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:14:35.627987 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:14:35.635709 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:14:35.637145 [debug] [ThreadPool]: On list_erp_oltp: Close
18:14:35.642569 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:14:35.647785 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:35.647983 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:14:35.648064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:14:35.653031 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:14:35.653295 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:35.653466 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:14:35.656851 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:14:35.658160 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:14:35.658477 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:14:35.661649 [debug] [MainThread]: Using postgres connection "master"
18:14:35.661917 [debug] [MainThread]: On master: BEGIN
18:14:35.662003 [debug] [MainThread]: Opening a new connection, currently in state init
18:14:35.667614 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:14:35.667837 [debug] [MainThread]: Using postgres connection "master"
18:14:35.667941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:14:35.679572 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:14:35.680666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71a175e0>]}
18:14:35.680938 [debug] [MainThread]: On master: ROLLBACK
18:14:35.681210 [debug] [MainThread]: Using postgres connection "master"
18:14:35.681334 [debug] [MainThread]: On master: BEGIN
18:14:35.681635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:14:35.681828 [debug] [MainThread]: On master: COMMIT
18:14:35.681916 [debug] [MainThread]: Using postgres connection "master"
18:14:35.681985 [debug] [MainThread]: On master: COMMIT
18:14:35.682152 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:35.682290 [debug] [MainThread]: On master: Close
18:14:35.682708 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:14:35.682965 [info ] [MainThread]: 
18:14:35.686907 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:14:35.687161 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:14:35.687523 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:14:35.687625 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:14:35.687712 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:14:35.689363 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:14:35.689657 [debug] [Thread-1  ]: finished collecting timing info
18:14:35.689810 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:14:35.699402 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:14:35.699810 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:14:35.700240 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.700359 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:14:35.700440 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:14:35.733502 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
18:14:35.733916 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_custumers ................................... [RUN]
18:14:35.734178 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:14:35.734590 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
18:14:35.752953 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
18:14:35.746703 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:14:35.753557 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:14:35.753163 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
18:14:35.755027 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
18:14:35.755314 [debug] [Thread-3  ]: finished collecting timing info
18:14:35.755456 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
18:14:35.753661 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:14:35.746336 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:14:35.752762 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:14:35.768580 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:14:35.770997 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:14:35.771485 [debug] [Thread-2  ]: finished collecting timing info
18:14:35.771758 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:14:35.775071 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:14:35.775427 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.775597 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:14:35.775693 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:14:35.775971 [debug] [Thread-4  ]: finished collecting timing info
18:14:35.776144 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:14:35.783336 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
18:14:35.786902 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:35.787204 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:14:35.787290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:14:35.788302 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:14:35.788525 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
18:14:35.788605 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:14:35.790417 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:14:35.790868 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:14:35.791048 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.791173 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:14:35.792949 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:35.793078 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:14:35.793179 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:14:35.797284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:14:35.797482 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:35.797563 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    --union al
    --select null as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:14:35.798167 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:35.804394 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.804913 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:14:35.809143 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:35.809269 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:14:35.805154 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:14:35.809797 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:14:35.809909 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:14:35.809976 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:14:35.810212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.812105 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:35.812314 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:14:35.812902 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:14:35.815793 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:14:35.815980 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
18:14:35.816313 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:14:35.819385 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.819597 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:14:35.819843 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.821463 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:14:35.821586 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
18:14:35.820050 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:35.819930 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:14:35.819746 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:14:35.822118 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.822219 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)

select * from orders
  );
18:14:35.831990 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.832832 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:14:35.832947 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.833024 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:14:35.833130 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:14:35.831504 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:14:35.836510 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:14:35.836322 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:35.836612 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:14:35.836690 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.840195 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:35.836807 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:14:35.840362 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:14:35.840960 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.840559 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.843604 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:14:35.842470 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:14:35.843719 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
18:14:35.844120 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:35.845151 [debug] [Thread-2  ]: finished collecting timing info
18:14:35.845266 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:14:35.843892 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:35.845554 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:14:35.830505 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:14:35.846863 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.847043 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:35.849485 [debug] [Thread-3  ]: finished collecting timing info
18:14:35.849672 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
18:14:35.848560 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:35.847174 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:35.851724 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:14:35.851225 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:14:35.851567 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef719576d0>]}
18:14:35.852401 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.12s]
18:14:35.852901 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
18:14:35.853253 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.853071 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:35.847469 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef71980eb0>]}
18:14:35.856748 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
18:14:35.856394 [debug] [Thread-4  ]: finished collecting timing info
18:14:35.855408 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:35.857390 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:14:35.857265 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:14:35.857145 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:14:35.860049 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:14:35.860404 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef700d33d0>]}
18:14:35.861244 [debug] [Thread-1  ]: finished collecting timing info
18:14:35.861577 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.11s]
18:14:35.861847 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:14:35.862223 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:14:35.866484 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef700b0550>]}
18:14:35.867013 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 1[0m in 0.18s]
18:14:35.867289 [debug] [Thread-6  ]: Began running node model.first_project.costumers
18:14:35.867452 [info ] [Thread-6  ]: 5 of 7 START view model public.costumers ....................................... [RUN]
18:14:35.867603 [debug] [Thread-7  ]: Began running node model.first_project.costumers2
18:14:35.867746 [info ] [Thread-7  ]: 6 of 7 START table model public.costumers2 ..................................... [RUN]
18:14:35.867975 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:14:35.868192 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.costumers"
18:14:35.868507 [debug] [Thread-6  ]: Began compiling node model.first_project.costumers
18:14:35.868672 [debug] [Thread-6  ]: Compiling model.first_project.costumers
18:14:35.868363 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.costumers2"
18:14:35.870696 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.costumers"
18:14:35.870998 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
18:14:35.871118 [debug] [Thread-7  ]: Began compiling node model.first_project.costumers2
18:14:35.871356 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:14:35.871491 [debug] [Thread-7  ]: Compiling model.first_project.costumers2
18:14:35.871845 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:14:35.873883 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.costumers2"
18:14:35.874028 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
18:14:35.874320 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
18:14:35.875724 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:14:35.875957 [debug] [Thread-9  ]: finished collecting timing info
18:14:35.879034 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
18:14:35.882382 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:14:35.874124 [debug] [Thread-6  ]: finished collecting timing info
18:14:35.882906 [debug] [Thread-6  ]: Began executing node model.first_project.costumers
18:14:35.884588 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.costumers"
18:14:35.884891 [debug] [Thread-7  ]: finished collecting timing info
18:14:35.885322 [debug] [Thread-7  ]: Began executing node model.first_project.costumers2
18:14:35.885095 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:14:35.887166 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.costumers2"
18:14:35.887379 [debug] [Thread-6  ]: On model.first_project.costumers: BEGIN
18:14:35.888497 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:14:35.888347 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:14:35.888763 [debug] [Thread-7  ]: On model.first_project.costumers2: BEGIN
18:14:35.888858 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:14:35.887932 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:35.889740 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
18:14:35.889832 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:14:35.899150 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:14:35.899461 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:14:35.899686 [debug] [Thread-6  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:14:35.901960 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:14:35.904048 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:14:35.904210 [debug] [Thread-6  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
18:14:35.905088 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:14:35.905241 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:14:35.905338 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:14:35.905490 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.906462 [debug] [Thread-6  ]: On model.first_project.costumers: COMMIT
18:14:35.906560 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:14:35.906629 [debug] [Thread-6  ]: On model.first_project.costumers: COMMIT
18:14:35.907564 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
18:14:35.907703 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:35.907788 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:14:35.907896 [debug] [Thread-7  ]: SQL status: SELECT 50 in 0.0 seconds
18:14:35.909454 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:14:35.909569 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
18:14:35.909741 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:14:35.912284 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:35.912413 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:14:35.909839 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.912520 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.913523 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:14:35.915581 [debug] [Thread-6  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
18:14:35.915472 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.914921 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:14:35.916441 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:14:35.917168 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:35.916900 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
18:14:35.917271 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:14:35.916581 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:35.918380 [debug] [Thread-6  ]: finished collecting timing info
18:14:35.918536 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:35.918739 [debug] [Thread-6  ]: On model.first_project.costumers: Close
18:14:35.919974 [debug] [Thread-7  ]: On model.first_project.costumers2: COMMIT
18:14:35.920645 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef70022cd0>]}
18:14:35.921828 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:14:35.921970 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.924043 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:35.924141 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:14:35.922552 [debug] [Thread-7  ]: On model.first_project.costumers2: COMMIT
18:14:35.922344 [info ] [Thread-6  ]: 5 of 7 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.05s]
18:14:35.924442 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:35.926470 [debug] [Thread-9  ]: finished collecting timing info
18:14:35.926604 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
18:14:35.926744 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
18:14:35.927867 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:14:35.928610 [debug] [Thread-6  ]: Finished running node model.first_project.costumers
18:14:35.928995 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef607ba910>]}
18:14:35.929187 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
18:14:35.929702 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
18:14:35.930235 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
18:14:35.931843 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
18:14:35.932680 [debug] [Thread-7  ]: finished collecting timing info
18:14:35.932841 [debug] [Thread-7  ]: On model.first_project.costumers2: Close
18:14:35.933222 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecbb50-9d4b-43eb-b1b6-ccb7379f3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef607d5f10>]}
18:14:35.935100 [info ] [Thread-7  ]: 6 of 7 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.06s]
18:14:35.935468 [debug] [Thread-7  ]: Finished running node model.first_project.costumers2
18:14:35.938243 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:35.938448 [debug] [MainThread]: Using postgres connection "master"
18:14:35.938526 [debug] [MainThread]: On master: BEGIN
18:14:35.938593 [debug] [MainThread]: Opening a new connection, currently in state closed
18:14:35.943794 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:14:35.944073 [debug] [MainThread]: On master: COMMIT
18:14:35.944158 [debug] [MainThread]: Using postgres connection "master"
18:14:35.944228 [debug] [MainThread]: On master: COMMIT
18:14:35.944378 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:35.944519 [debug] [MainThread]: On master: Close
18:14:35.944905 [info ] [MainThread]: 
18:14:35.945092 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.33s.
18:14:35.945214 [debug] [MainThread]: Connection 'master' was properly closed.
18:14:35.945277 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:14:35.945338 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:14:35.945398 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
18:14:35.945457 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:14:35.945516 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
18:14:35.945575 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
18:14:35.945633 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:14:35.949274 [info ] [MainThread]: 
18:14:35.949494 [info ] [MainThread]: [32mCompleted successfully[0m
18:14:35.949761 [info ] [MainThread]: 
18:14:35.949926 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:14:35.950157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7193d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7191f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef7191f550>]}


============================== 2022-06-04 18:25:23.792919 | 5a5167b9-56ad-4fa7-ab5c-04550f89dcd6 ==============================
18:25:23.792935 [info ] [MainThread]: Running with dbt=1.1.0
18:25:23.793275 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:25:23.793361 [debug] [MainThread]: Tracking: tracking
18:25:23.796019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad98ae550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad98ae730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad98ae430>]}
18:25:23.820362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:25:23.820845 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:25:23.853772 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' (models/erp/schema.yml) depends on a node named 'customers' which was not found
18:25:23.859866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9745f10>]}
18:25:23.864571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9768ac0>]}
18:25:23.865009 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:25:23.865250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9768940>]}
18:25:23.866487 [info ] [MainThread]: 
18:25:23.866830 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:23.867787 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:25:23.912861 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:25:23.913087 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:25:23.913170 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:23.918567 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:25:23.920130 [debug] [ThreadPool]: On list_erp_oltp: Close
18:25:23.921388 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:25:23.925304 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:23.925442 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:25:23.925541 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:23.931210 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:25:23.931470 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:23.931565 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:25:23.933518 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:25:23.934514 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:25:23.935716 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:25:23.939174 [debug] [MainThread]: Using postgres connection "master"
18:25:23.939338 [debug] [MainThread]: On master: BEGIN
18:25:23.939413 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:23.945826 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:23.946060 [debug] [MainThread]: Using postgres connection "master"
18:25:23.946138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:23.963652 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
18:25:23.964871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad97dbc40>]}
18:25:23.965710 [debug] [MainThread]: On master: ROLLBACK
18:25:23.966505 [debug] [MainThread]: Using postgres connection "master"
18:25:23.966613 [debug] [MainThread]: On master: BEGIN
18:25:23.967091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:23.967222 [debug] [MainThread]: On master: COMMIT
18:25:23.967316 [debug] [MainThread]: Using postgres connection "master"
18:25:23.967384 [debug] [MainThread]: On master: COMMIT
18:25:23.967630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:23.967745 [debug] [MainThread]: On master: Close
18:25:23.968079 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:25:23.968295 [info ] [MainThread]: 
18:25:23.973705 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:25:23.973981 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:25:23.974362 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:25:23.974749 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:25:23.974900 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:25:23.974499 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:25:23.977121 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
18:25:23.977852 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_custumers ................................... [RUN]
18:25:23.978272 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
18:25:23.978387 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
18:25:23.977477 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:25:23.978841 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:25:23.978988 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:25:23.979064 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:25:23.980607 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:25:23.980956 [debug] [Thread-2  ]: finished collecting timing info
18:25:23.981174 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:25:23.977239 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:25:23.986980 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:25:23.987891 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:25:23.988021 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:25:23.988102 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:25:23.989065 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:25:23.978466 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
18:25:23.999650 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
18:25:23.976508 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:25:23.999915 [debug] [Thread-4  ]: finished collecting timing info
18:25:24.008640 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:25:24.018648 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:25:24.020375 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:25:24.021112 [debug] [Thread-1  ]: finished collecting timing info
18:25:24.021317 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:25:24.032128 [debug] [Thread-3  ]: finished collecting timing info
18:25:24.037864 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
18:25:24.039415 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
18:25:24.037668 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:24.039641 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:25:24.039798 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:24.041364 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:25:24.041189 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:25:24.041448 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:25:24.040988 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:25:24.042185 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:24.042313 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:25:24.042374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:24.042955 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:25:24.043077 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
18:25:24.043154 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:25:24.050245 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:25:24.050593 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:24.050687 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    --union al
    --select null as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:25:24.051284 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:25:24.051455 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:24.051519 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)

select * from orders
  );
18:25:24.051760 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:24.056955 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:24.057847 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
18:25:24.058044 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:25:24.059610 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:24.059975 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:25:24.060345 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.061646 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:24.061735 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:25:24.062212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.063653 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:24.063824 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:25:24.064385 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:25:24.064476 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:25:24.064212 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:25:24.065097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.063912 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.078828 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:25:24.087249 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:25:24.087440 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
18:25:24.083709 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
18:25:24.087615 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:24.087722 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:25:24.084680 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:25:24.087879 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:24.087953 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:25:24.083400 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:25:24.088246 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:24.088450 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:25:24.089269 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:24.091098 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:24.091792 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:25:24.091430 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:25:24.091498 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:25:24.091316 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.096019 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:24.096178 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.100296 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:24.100410 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:25:24.098683 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:25:24.097228 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:24.100732 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:25:24.098938 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:25:24.100579 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
18:25:24.101867 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.103177 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:25:24.103279 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:24.103351 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:25:24.103487 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.104294 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:25:24.104382 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:25:24.104451 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:25:24.105574 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:24.106623 [debug] [Thread-4  ]: finished collecting timing info
18:25:24.106792 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:25:24.108837 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:24.108993 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:25:24.106939 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:25:24.109431 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad96d3250>]}
18:25:24.109777 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.12s]
18:25:24.110116 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:25:24.111025 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:25:24.111273 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:25:24.112121 [debug] [Thread-1  ]: finished collecting timing info
18:25:24.113291 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:25:24.113738 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
18:25:24.113395 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:24.113553 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:25:24.114451 [debug] [Thread-2  ]: finished collecting timing info
18:25:24.117191 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:25:24.117576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad97d20a0>]}
18:25:24.117860 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 1[0m in 0.14s]
18:25:24.118111 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:25:24.118435 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:25:24.118739 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:25:24.119089 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:25:24.119197 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:25:24.119275 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:25:24.120901 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:25:24.121855 [debug] [Thread-6  ]: finished collecting timing info
18:25:24.121987 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:25:24.123522 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:25:24.117062 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:24.124372 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:24.126634 [debug] [Thread-3  ]: finished collecting timing info
18:25:24.127319 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
18:25:24.127136 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad970be50>]}
18:25:24.126832 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:25:24.127726 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:25:24.127591 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
18:25:24.129610 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:25:24.130003 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad96d61c0>]}
18:25:24.130265 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.15s]
18:25:24.130523 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
18:25:24.130900 [debug] [Thread-8  ]: Began running node model.first_project.costumers
18:25:24.131072 [info ] [Thread-8  ]: 6 of 7 START view model public.costumers ....................................... [RUN]
18:25:24.131396 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.costumers"
18:25:24.131489 [debug] [Thread-8  ]: Began compiling node model.first_project.costumers
18:25:24.131575 [debug] [Thread-8  ]: Compiling model.first_project.costumers
18:25:24.133099 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.costumers"
18:25:24.133336 [debug] [Thread-9  ]: Began running node model.first_project.costumers2
18:25:24.133523 [info ] [Thread-9  ]: 7 of 7 START table model public.costumers2 ..................................... [RUN]
18:25:24.134026 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.costumers2"
18:25:24.134152 [debug] [Thread-9  ]: Began compiling node model.first_project.costumers2
18:25:24.134231 [debug] [Thread-9  ]: Compiling model.first_project.costumers2
18:25:24.136038 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.costumers2"
18:25:24.139231 [debug] [Thread-9  ]: finished collecting timing info
18:25:24.136311 [debug] [Thread-8  ]: finished collecting timing info
18:25:24.139411 [debug] [Thread-9  ]: Began executing node model.first_project.costumers2
18:25:24.141324 [debug] [Thread-8  ]: Began executing node model.first_project.costumers
18:25:24.147645 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.costumers2"
18:25:24.150388 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.costumers"
18:25:24.151955 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:25:24.152341 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:25:24.152635 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:24.152708 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:25:24.152508 [debug] [Thread-9  ]: On model.first_project.costumers2: BEGIN
18:25:24.152930 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:25:24.153177 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:25:24.153329 [debug] [Thread-8  ]: On model.first_project.costumers: BEGIN
18:25:24.153603 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:25:24.155540 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:24.157062 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:24.157163 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:25:24.157595 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.158410 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:25:24.158503 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:24.158561 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:25:24.160409 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:25:24.161477 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:24.161566 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:25:24.161838 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:24.162676 [debug] [Thread-6  ]: finished collecting timing info
18:25:24.163095 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:25:24.163461 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad9745ee0>]}
18:25:24.163743 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
18:25:24.164051 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:25:24.165537 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:25:24.165660 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:25:24.165773 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:25:24.168266 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:24.170417 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:25:24.170699 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
18:25:24.171316 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.172276 [debug] [Thread-8  ]: On model.first_project.costumers: COMMIT
18:25:24.172398 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:25:24.172469 [debug] [Thread-8  ]: On model.first_project.costumers: COMMIT
18:25:24.172746 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
18:25:24.172905 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:25:24.173047 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:25:24.174168 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:25:24.175353 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:25:24.175464 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
18:25:24.175775 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:24.176954 [debug] [Thread-8  ]: finished collecting timing info
18:25:24.177056 [debug] [Thread-9  ]: SQL status: SELECT 50 in 0.0 seconds
18:25:24.177158 [debug] [Thread-8  ]: On model.first_project.costumers: Close
18:25:24.178551 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:25:24.181362 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
18:25:24.182165 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad8681490>]}
18:25:24.182557 [info ] [Thread-8  ]: 6 of 7 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.05s]
18:25:24.182713 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.183138 [debug] [Thread-8  ]: Finished running node model.first_project.costumers
18:25:24.185530 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:25:24.187384 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
18:25:24.188415 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:24.189549 [debug] [Thread-9  ]: On model.first_project.costumers2: COMMIT
18:25:24.189701 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:25:24.189790 [debug] [Thread-9  ]: On model.first_project.costumers2: COMMIT
18:25:24.191239 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:25:24.193107 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:25:24.193201 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
18:25:24.195738 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
18:25:24.196592 [debug] [Thread-9  ]: finished collecting timing info
18:25:24.196733 [debug] [Thread-9  ]: On model.first_project.costumers2: Close
18:25:24.197103 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a5167b9-56ad-4fa7-ab5c-04550f89dcd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadb0cbdc0>]}
18:25:24.197365 [info ] [Thread-9  ]: 7 of 7 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.06s]
18:25:24.197803 [debug] [Thread-9  ]: Finished running node model.first_project.costumers2
18:25:24.199024 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:24.199140 [debug] [MainThread]: Using postgres connection "master"
18:25:24.199237 [debug] [MainThread]: On master: BEGIN
18:25:24.199328 [debug] [MainThread]: Opening a new connection, currently in state closed
18:25:24.207539 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:24.207743 [debug] [MainThread]: On master: COMMIT
18:25:24.207815 [debug] [MainThread]: Using postgres connection "master"
18:25:24.207876 [debug] [MainThread]: On master: COMMIT
18:25:24.208047 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:24.208172 [debug] [MainThread]: On master: Close
18:25:24.208519 [info ] [MainThread]: 
18:25:24.208701 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.34s.
18:25:24.208825 [debug] [MainThread]: Connection 'master' was properly closed.
18:25:24.208885 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:25:24.208943 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:25:24.209021 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
18:25:24.209076 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:25:24.209123 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:25:24.209171 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
18:25:24.209218 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
18:25:24.216656 [info ] [MainThread]: 
18:25:24.216939 [info ] [MainThread]: [32mCompleted successfully[0m
18:25:24.217092 [info ] [MainThread]: 
18:25:24.217200 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:25:24.217378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad97c2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad85d1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faadb12fca0>]}


============================== 2022-06-04 18:25:30.929180 | a46ee1b4-6203-479c-ada9-d46460fd3acc ==============================
18:25:30.929196 [info ] [MainThread]: Running with dbt=1.1.0
18:25:30.929596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:25:30.929724 [debug] [MainThread]: Tracking: tracking
18:25:30.933127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de724c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de72d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de726d0>]}
18:25:30.960035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:25:30.960279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:25:30.968697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a46ee1b4-6203-479c-ada9-d46460fd3acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981dd29fd0>]}
18:25:30.976153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a46ee1b4-6203-479c-ada9-d46460fd3acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de07cd0>]}
18:25:30.976439 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:25:30.976607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46ee1b4-6203-479c-ada9-d46460fd3acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de07c40>]}
18:25:30.977886 [info ] [MainThread]: 
18:25:30.978426 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:30.979631 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:25:30.991481 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:30.991699 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:25:30.991783 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:30.998767 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:25:30.999045 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:30.999125 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:25:31.001349 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:25:31.002767 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:25:31.003458 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:25:31.006959 [debug] [MainThread]: Using postgres connection "master"
18:25:31.007860 [debug] [MainThread]: On master: BEGIN
18:25:31.011113 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:31.016879 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:31.017093 [debug] [MainThread]: Using postgres connection "master"
18:25:31.017166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:31.034075 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
18:25:31.035247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46ee1b4-6203-479c-ada9-d46460fd3acc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de07a60>]}
18:25:31.035642 [debug] [MainThread]: On master: ROLLBACK
18:25:31.036103 [debug] [MainThread]: Using postgres connection "master"
18:25:31.036230 [debug] [MainThread]: On master: BEGIN
18:25:31.036932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:31.037120 [debug] [MainThread]: On master: COMMIT
18:25:31.037237 [debug] [MainThread]: Using postgres connection "master"
18:25:31.037338 [debug] [MainThread]: On master: COMMIT
18:25:31.037618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:31.037735 [debug] [MainThread]: On master: Close
18:25:31.038266 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:25:31.038438 [info ] [MainThread]: 
18:25:31.044323 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:25:31.044526 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:25:31.044971 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:25:31.045094 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:25:31.045191 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:25:31.051498 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:25:31.051703 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:25:31.052119 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:25:31.052425 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:25:31.052583 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:25:31.057946 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:31.058116 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:25:31.058363 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:31.058451 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:31.103735 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:31.098660 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:25:31.110815 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:25:31.098898 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:31.111474 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:25:31.058562 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:31.103482 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:25:31.111144 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:25:31.111349 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:31.110570 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:31.111722 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:31.114410 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:31.113021 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:25:31.113478 [debug] [Thread-1  ]: finished collecting timing info
18:25:31.115522 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:25:31.113908 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:25:31.114257 [debug] [Thread-3  ]: finished collecting timing info
18:25:31.121499 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:31.114511 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:31.115024 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:31.137426 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:31.121236 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:31.112779 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:25:31.113676 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:25:31.154468 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:25:31.152053 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:25:31.153467 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:31.153868 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:31.154125 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:31.158277 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:31.160698 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:31.157377 [debug] [Thread-2  ]: finished collecting timing info
18:25:31.161275 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:25:31.158130 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:25:31.137637 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:31.164777 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:31.164966 [debug] [Thread-4  ]: finished collecting timing info
18:25:31.165191 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:31.162288 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:25:31.162651 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:25:31.157039 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:25:31.167336 [debug] [Thread-5  ]: finished collecting timing info
18:25:31.167439 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:25:31.166423 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:31.162525 [debug] [Thread-7  ]: finished collecting timing info
18:25:31.167037 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:31.168347 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:25:31.170247 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:25:31.170436 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:25:31.170528 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:25:31.168896 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:31.170912 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:25:31.171011 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:25:31.169268 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:31.173153 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:31.173403 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:31.173549 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:25:31.173620 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:25:31.166882 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:25:31.179181 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:25:31.179358 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:25:31.157797 [debug] [Thread-6  ]: finished collecting timing info
18:25:31.180427 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:31.181978 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:31.182518 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:25:31.182719 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:25:31.182832 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:25:31.169465 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:31.183014 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:25:31.183102 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:25:31.184083 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:31.184213 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:25:31.184273 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:25:31.184797 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:25:31.184897 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:31.184958 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:25:31.186565 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:31.188783 [debug] [Thread-4  ]: finished collecting timing info
18:25:31.189267 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:25:31.190350 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:25:31.190802 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:25:31.191298 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:31.192505 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:25:31.193513 [debug] [Thread-5  ]: finished collecting timing info
18:25:31.193815 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:25:31.194160 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:25:31.194280 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:31.194537 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:25:31.194626 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:25:31.195024 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.08s]
18:25:31.195341 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:25:31.196596 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:25:31.196702 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:25:31.196780 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:25:31.198630 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:31.199746 [debug] [Thread-2  ]: finished collecting timing info
18:25:31.199881 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:25:31.201332 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:25:31.201705 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.15s]
18:25:31.202094 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:25:31.206630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
18:25:31.206834 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:25:31.206966 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:25:31.208489 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:31.209889 [debug] [Thread-1  ]: finished collecting timing info
18:25:31.210193 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:25:31.210315 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.02 seconds
18:25:31.211592 [debug] [Thread-7  ]: finished collecting timing info
18:25:31.211766 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:25:31.211899 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:25:31.212044 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:25:31.212955 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:31.212691 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.17s]
18:25:31.213063 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:25:31.212124 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:25:31.213482 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:25:31.214339 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:31.215211 [debug] [Thread-3  ]: finished collecting timing info
18:25:31.215314 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:25:31.213920 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.09s]
18:25:31.215804 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:31.216043 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:25:31.216130 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:25:31.216279 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:31.216475 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:25:31.216733 [info ] [Thread-3  ]: 3 of 7 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.16s]
18:25:31.216988 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:31.218384 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:31.219955 [debug] [Thread-6  ]: finished collecting timing info
18:25:31.220178 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:25:31.220444 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:25:31.220815 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.11s]
18:25:31.221137 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:31.222520 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:31.222650 [debug] [MainThread]: Using postgres connection "master"
18:25:31.222718 [debug] [MainThread]: On master: BEGIN
18:25:31.222777 [debug] [MainThread]: Opening a new connection, currently in state closed
18:25:31.228212 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:31.228424 [debug] [MainThread]: On master: COMMIT
18:25:31.228513 [debug] [MainThread]: Using postgres connection "master"
18:25:31.228577 [debug] [MainThread]: On master: COMMIT
18:25:31.228836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:31.228956 [debug] [MainThread]: On master: Close
18:25:31.229245 [info ] [MainThread]: 
18:25:31.229479 [info ] [MainThread]: Finished running 7 tests in 0.25s.
18:25:31.229630 [debug] [MainThread]: Connection 'master' was properly closed.
18:25:31.229745 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:25:31.229835 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:25:31.229891 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:25:31.229946 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:25:31.230000 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:25:31.230054 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:25:31.230108 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:25:31.233579 [info ] [MainThread]: 
18:25:31.233901 [info ] [MainThread]: [32mCompleted successfully[0m
18:25:31.234057 [info ] [MainThread]: 
18:25:31.234171 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:25:31.234425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981de076a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981c44fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f981c4cdc10>]}


============================== 2022-06-04 18:26:08.635798 | 51b4f34d-99ed-46c2-aebc-58eefe7fd41d ==============================
18:26:08.635838 [info ] [MainThread]: Running with dbt=1.1.0
18:26:08.636318 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:26:08.636418 [debug] [MainThread]: Tracking: tracking
18:26:08.639278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf6ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf6ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf6fd60>]}
18:26:08.662515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:26:08.662924 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
18:26:08.672108 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
18:26:08.742464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf66490>]}
18:26:08.746221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf644f0>]}
18:26:08.746480 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:08.746643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf64970>]}
18:26:08.747611 [info ] [MainThread]: 
18:26:08.747903 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:08.748711 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:26:08.756341 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:26:08.756513 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:26:08.756585 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:08.764311 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:26:08.765450 [debug] [ThreadPool]: On list_erp_oltp: Close
18:26:08.766656 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:08.770314 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:08.770448 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:08.770527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:08.775549 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:26:08.775791 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:08.775877 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:08.777601 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:26:08.778618 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:08.778807 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:08.782212 [debug] [MainThread]: Using postgres connection "master"
18:26:08.782484 [debug] [MainThread]: On master: BEGIN
18:26:08.782567 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:08.788364 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:08.788560 [debug] [MainThread]: Using postgres connection "master"
18:26:08.788637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:08.800192 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:26:08.801623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ece5be50>]}
18:26:08.801979 [debug] [MainThread]: On master: ROLLBACK
18:26:08.802329 [debug] [MainThread]: Using postgres connection "master"
18:26:08.802456 [debug] [MainThread]: On master: BEGIN
18:26:08.803064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:08.803256 [debug] [MainThread]: On master: COMMIT
18:26:08.803369 [debug] [MainThread]: Using postgres connection "master"
18:26:08.803438 [debug] [MainThread]: On master: COMMIT
18:26:08.803666 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:08.803784 [debug] [MainThread]: On master: Close
18:26:08.804094 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:08.804273 [info ] [MainThread]: 
18:26:08.809401 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:26:08.809626 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:26:08.810046 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:26:08.810196 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:26:08.810300 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:26:08.811825 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:26:08.812202 [debug] [Thread-1  ]: finished collecting timing info
18:26:08.812381 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:26:08.827034 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:26:08.827292 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
18:26:08.827930 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:26:08.834158 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.834372 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:26:08.834475 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:26:08.836451 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:26:08.836853 [debug] [Thread-2  ]: finished collecting timing info
18:26:08.837013 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:26:08.833074 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:26:08.848818 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:26:08.832151 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:26:08.849588 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:08.849216 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:26:08.849887 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:26:08.849715 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:26:08.850925 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:08.850032 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:26:08.848368 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:26:08.852380 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:26:08.833367 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_custumers ................................... [RUN]
18:26:08.853154 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
18:26:08.853334 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
18:26:08.853467 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.853649 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
18:26:08.853809 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:26:08.854922 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
18:26:08.860961 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:26:08.861539 [debug] [Thread-3  ]: finished collecting timing info
18:26:08.861741 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
18:26:08.863713 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
18:26:08.864349 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:26:08.865980 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:08.865634 [debug] [Thread-4  ]: finished collecting timing info
18:26:08.866698 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:26:08.866344 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    --union al
    --select null as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:26:08.866480 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:26:08.868634 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.868729 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:26:08.870213 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:08.868319 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:26:08.875309 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:08.874926 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:08.875653 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:26:08.866165 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:26:08.876040 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
18:26:08.876130 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:08.876352 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.875464 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:26:08.878479 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:08.882248 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:08.882448 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:08.884623 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.886360 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:26:08.882783 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:26:08.886916 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.893385 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:26:08.893646 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:26:08.895595 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:26:08.893779 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:08.895480 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:26:08.897001 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.897478 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:26:08.897191 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:08.894685 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:08.897853 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)

select * from orders
  );
18:26:08.897295 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:08.898073 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.901718 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:08.900439 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:26:08.902096 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
18:26:08.901867 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.902469 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:08.900713 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:08.898224 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:08.904700 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:08.904430 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:08.905491 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:26:08.905714 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.908026 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:26:08.908247 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.909819 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:08.909936 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:26:08.908362 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
18:26:08.910563 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:26:08.913395 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:08.913504 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:26:08.913727 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.915601 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:08.915726 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:08.916088 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:08.915921 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:08.916007 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:26:08.915820 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:08.919060 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:26:08.919153 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:26:08.918151 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:08.917024 [debug] [Thread-2  ]: finished collecting timing info
18:26:08.919798 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:26:08.919227 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:26:08.919299 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:26:08.919504 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:26:08.923114 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ece2f1c0>]}
18:26:08.923380 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
18:26:08.922724 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:26:08.924920 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:26:08.925053 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
18:26:08.922560 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:08.925162 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:26:08.925670 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:26:08.926464 [debug] [Thread-1  ]: finished collecting timing info
18:26:08.926600 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:26:08.926996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ec9b64c0>]}
18:26:08.927227 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 1[0m in 0.12s]
18:26:08.928096 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:08.928840 [debug] [Thread-4  ]: finished collecting timing info
18:26:08.928974 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:26:08.930430 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:08.931266 [debug] [Thread-3  ]: finished collecting timing info
18:26:08.931386 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
18:26:08.931773 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ece20400>]}
18:26:08.931998 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.08s]
18:26:08.932246 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:26:08.932539 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0eca0a310>]}
18:26:08.932746 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
18:26:08.933274 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:26:08.933708 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
18:26:08.937145 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:26:08.937431 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:26:08.938328 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:26:08.941043 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:26:08.941238 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:26:08.941330 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:26:08.943509 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:26:08.943889 [debug] [Thread-8  ]: Began running node model.first_project.costumers
18:26:08.944172 [info ] [Thread-8  ]: 6 of 7 START view model public.costumers ....................................... [RUN]
18:26:08.944644 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.costumers"
18:26:08.944904 [debug] [Thread-8  ]: Began compiling node model.first_project.costumers
18:26:08.945025 [debug] [Thread-8  ]: Compiling model.first_project.costumers
18:26:08.946967 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.costumers"
18:26:08.949568 [debug] [Thread-9  ]: Began running node model.first_project.costumers2
18:26:08.949836 [info ] [Thread-9  ]: 7 of 7 START table model public.costumers2 ..................................... [RUN]
18:26:08.952374 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.costumers2"
18:26:08.952605 [debug] [Thread-9  ]: Began compiling node model.first_project.costumers2
18:26:08.952750 [debug] [Thread-9  ]: Compiling model.first_project.costumers2
18:26:08.957196 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.costumers2"
18:26:08.957512 [debug] [Thread-6  ]: finished collecting timing info
18:26:08.961967 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:26:08.966193 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:26:08.966899 [debug] [Thread-9  ]: finished collecting timing info
18:26:08.967168 [debug] [Thread-8  ]: finished collecting timing info
18:26:08.967440 [debug] [Thread-9  ]: Began executing node model.first_project.costumers2
18:26:08.967620 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:08.967873 [debug] [Thread-8  ]: Began executing node model.first_project.costumers
18:26:08.970115 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.costumers2"
18:26:08.970292 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:26:08.971820 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.costumers"
18:26:08.972169 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:08.972980 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:26:08.973083 [debug] [Thread-8  ]: On model.first_project.costumers: BEGIN
18:26:08.973150 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:26:08.972376 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:26:08.974084 [debug] [Thread-9  ]: On model.first_project.costumers2: BEGIN
18:26:08.974300 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:26:08.979052 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:26:08.979218 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:08.979286 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:26:08.979471 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:26:08.979565 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:26:08.979623 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:26:08.980165 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:08.981790 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:08.981937 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:26:08.983534 [debug] [Thread-9  ]: SQL status: SELECT 50 in 0.0 seconds
18:26:08.986200 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:26:08.986372 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
18:26:08.987388 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.989631 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:26:08.989865 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
18:26:08.990244 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:08.991434 [debug] [Thread-9  ]: On model.first_project.costumers2: COMMIT
18:26:08.991621 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:08.992694 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:08.992791 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:08.992851 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:08.991828 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:26:08.992962 [debug] [Thread-9  ]: On model.first_project.costumers2: COMMIT
18:26:08.996713 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:26:08.996955 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
18:26:08.997087 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  where customers.customers_id <> 63
)

select * from final
  );
18:26:08.997925 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:26:08.999587 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
18:26:08.999766 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:26:08.999919 [debug] [Thread-8  ]: Postgres adapter: Postgres error: column customers.customers_id does not exist
LINE 27:   where customers.customers_id <> 63
                 ^
HINT:  Perhaps you meant to reference the column "customers.customer_id".

18:26:09.002043 [debug] [Thread-8  ]: On model.first_project.costumers: ROLLBACK
18:26:09.001691 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:09.000125 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
18:26:09.002333 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:26:09.002615 [debug] [Thread-8  ]: finished collecting timing info
18:26:09.003038 [debug] [Thread-8  ]: On model.first_project.costumers: Close
18:26:09.003394 [debug] [Thread-8  ]: Database Error in model costumers (models/erp/costumers.sql)
  column customers.customers_id does not exist
  LINE 27:   where customers.customers_id <> 63
                   ^
  HINT:  Perhaps you meant to reference the column "customers.customer_id".
  compiled SQL at target/run/first_project/models/erp/costumers.sql
18:26:09.003711 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ec157fa0>]}
18:26:09.004023 [error] [Thread-8  ]: 6 of 7 ERROR creating view model public.costumers .............................. [[31mERROR[0m in 0.06s]
18:26:09.004720 [debug] [Thread-8  ]: Finished running node model.first_project.costumers
18:26:09.005491 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:09.005704 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
18:26:09.006714 [debug] [Thread-6  ]: finished collecting timing info
18:26:09.007700 [debug] [Thread-9  ]: finished collecting timing info
18:26:09.008137 [debug] [Thread-9  ]: On model.first_project.costumers2: Close
18:26:09.007932 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:26:09.008515 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ec0cfd60>]}
18:26:09.010056 [info ] [Thread-9  ]: 7 of 7 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.06s]
18:26:09.010388 [debug] [Thread-9  ]: Finished running node model.first_project.costumers2
18:26:09.009596 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51b4f34d-99ed-46c2-aebc-58eefe7fd41d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ec0d5790>]}
18:26:09.011035 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:26:09.011269 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:26:09.012628 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:09.012745 [debug] [MainThread]: Using postgres connection "master"
18:26:09.012808 [debug] [MainThread]: On master: BEGIN
18:26:09.012863 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:09.018148 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:09.018349 [debug] [MainThread]: On master: COMMIT
18:26:09.018418 [debug] [MainThread]: Using postgres connection "master"
18:26:09.018481 [debug] [MainThread]: On master: COMMIT
18:26:09.018637 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:09.018804 [debug] [MainThread]: On master: Close
18:26:09.019225 [info ] [MainThread]: 
18:26:09.019377 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.27s.
18:26:09.019479 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:09.019533 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:26:09.019581 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:26:09.019633 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:26:09.019708 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
18:26:09.019797 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:26:09.019869 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
18:26:09.019926 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
18:26:09.023882 [info ] [MainThread]: 
18:26:09.024147 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:26:09.024287 [info ] [MainThread]: 
18:26:09.024398 [error] [MainThread]: [33mDatabase Error in model costumers (models/erp/costumers.sql)[0m
18:26:09.025478 [error] [MainThread]:   column customers.customers_id does not exist
18:26:09.025902 [error] [MainThread]:   LINE 27:   where customers.customers_id <> 63
18:26:09.027167 [error] [MainThread]:                    ^
18:26:09.027299 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "customers.customer_id".
18:26:09.027429 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/costumers.sql
18:26:09.027590 [info ] [MainThread]: 
18:26:09.027716 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:26:09.027936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf71160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ecf71eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ec0e3af0>]}


============================== 2022-06-04 18:26:23.651974 | 51d0286e-23ef-4084-bffa-fb79137e8052 ==============================
18:26:23.651990 [info ] [MainThread]: Running with dbt=1.1.0
18:26:23.652433 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:26:23.652537 [debug] [MainThread]: Tracking: tracking
18:26:23.655489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df762f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df762400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df7621f0>]}
18:26:23.674703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:26:23.674982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:26:23.679830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51d0286e-23ef-4084-bffa-fb79137e8052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df619f40>]}
18:26:23.684638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51d0286e-23ef-4084-bffa-fb79137e8052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df6fcc70>]}
18:26:23.685048 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:23.685231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d0286e-23ef-4084-bffa-fb79137e8052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df6fcbe0>]}
18:26:23.686802 [info ] [MainThread]: 
18:26:23.687288 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:23.688387 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:23.695011 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:23.695204 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:23.695282 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:23.701956 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:23.702282 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:23.702369 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:23.704773 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:26:23.706058 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:23.706443 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:23.709600 [debug] [MainThread]: Using postgres connection "master"
18:26:23.709856 [debug] [MainThread]: On master: BEGIN
18:26:23.709960 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:23.718391 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:23.718600 [debug] [MainThread]: Using postgres connection "master"
18:26:23.718678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:23.728493 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:26:23.729560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d0286e-23ef-4084-bffa-fb79137e8052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df6fca00>]}
18:26:23.729855 [debug] [MainThread]: On master: ROLLBACK
18:26:23.730215 [debug] [MainThread]: Using postgres connection "master"
18:26:23.730334 [debug] [MainThread]: On master: BEGIN
18:26:23.730849 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:23.730968 [debug] [MainThread]: On master: COMMIT
18:26:23.731070 [debug] [MainThread]: Using postgres connection "master"
18:26:23.731140 [debug] [MainThread]: On master: COMMIT
18:26:23.731521 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:23.731646 [debug] [MainThread]: On master: Close
18:26:23.732084 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:23.732264 [info ] [MainThread]: 
18:26:23.738003 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:26:23.738195 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:26:23.738487 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:26:23.738593 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:26:23.738675 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:26:23.745671 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:26:23.745901 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:26:23.746275 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:26:23.746380 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:26:23.746464 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:26:23.746638 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:23.798054 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:26:23.798465 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:23.798638 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:26:23.800736 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:26:23.801079 [debug] [Thread-1  ]: finished collecting timing info
18:26:23.801263 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:26:23.806907 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:26:23.814160 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:23.821066 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:23.821263 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:23.820798 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:23.820925 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:23.830210 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:26:23.820270 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:23.827025 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:23.827230 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:26:23.828728 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:26:23.829964 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:26:23.820649 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:26:23.830549 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:23.830779 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:23.833606 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:23.831641 [debug] [Thread-3  ]: finished collecting timing info
18:26:23.837920 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:23.832468 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:26:23.839332 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:26:23.833025 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:23.837320 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:23.831359 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:23.839732 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:23.839847 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:23.839435 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:26:23.846748 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:26:23.839538 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:23.844350 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:23.849534 [debug] [Thread-7  ]: finished collecting timing info
18:26:23.849657 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:23.848946 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:23.851284 [debug] [Thread-6  ]: finished collecting timing info
18:26:23.849123 [debug] [Thread-5  ]: finished collecting timing info
18:26:23.851644 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:26:23.852969 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:26:23.853362 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:26:23.853495 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:26:23.853571 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:26:23.839061 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:23.851449 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:23.831988 [debug] [Thread-2  ]: finished collecting timing info
18:26:23.849311 [debug] [Thread-4  ]: finished collecting timing info
18:26:23.832738 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:26:23.855136 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:23.856433 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:23.855478 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:26:23.855857 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:23.857785 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:26:23.857879 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:23.856176 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:26:23.850682 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:23.857617 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:26:23.856057 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:23.860487 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:23.858549 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:23.858960 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:23.856587 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:26:23.862080 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:23.861734 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:26:23.862407 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:26:23.860755 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:23.862785 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:26:23.862884 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:23.861902 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:26:23.863628 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:26:23.863725 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:26:23.862009 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:26:23.863849 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:26:23.863916 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:26:23.867263 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:26:23.867503 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:23.867587 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:26:23.867989 [debug] [Thread-5  ]: Postgres adapter: Postgres error: relation "public.costumers" does not exist
LINE 15: from "erp_oltp"."public"."costumers"
              ^

18:26:23.868129 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:26:23.868232 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:23.870376 [debug] [Thread-3  ]: finished collecting timing info
18:26:23.870629 [debug] [Thread-5  ]: finished collecting timing info
18:26:23.871142 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:26:23.871527 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:26:23.871885 [debug] [Thread-5  ]: Database Error in test unique_costumers_customer_id (models/erp/schema.yml)
  relation "public.costumers" does not exist
  LINE 15: from "erp_oltp"."public"."costumers"
                ^
  compiled SQL at target/run/first_project/models/erp/schema.yml/unique_costumers_customer_id.sql
18:26:23.872078 [error] [Thread-5  ]: 5 of 7 ERROR unique_costumers_customer_id ...................................... [[31mERROR[0m in 0.04s]
18:26:23.872359 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:26:23.872678 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:26:23.873021 [info ] [Thread-3  ]: 3 of 7 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.06s]
18:26:23.873325 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:23.879538 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:26:23.879726 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:26:23.879800 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:26:23.880018 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:26:23.880170 [debug] [Thread-2  ]: Postgres adapter: Postgres error: relation "public.costumers" does not exist
LINE 14: from "erp_oltp"."public"."costumers"
              ^

18:26:23.880637 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:26:23.880282 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:26:23.880477 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:23.880743 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:26:23.881255 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:26:23.880907 [debug] [Thread-2  ]: finished collecting timing info
18:26:23.881177 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:26:23.881502 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:23.881394 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:26:23.881039 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:26:23.881636 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:26:23.881955 [debug] [Thread-2  ]: Database Error in test not_null_costumers_customer_id (models/erp/schema.yml)
  relation "public.costumers" does not exist
  LINE 14: from "erp_oltp"."public"."costumers"
                ^
  compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_costumers_customer_id.sql
18:26:23.882369 [error] [Thread-2  ]: 2 of 7 ERROR not_null_costumers_customer_id .................................... [[31mERROR[0m in 0.14s]
18:26:23.882611 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:26:23.882107 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.costumers" does not exist
LINE 17:     from "erp_oltp"."public"."costumers"
                  ^

18:26:23.882723 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:26:23.886304 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:23.887388 [debug] [Thread-7  ]: finished collecting timing info
18:26:23.887529 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:26:23.887702 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.01 seconds
18:26:23.887910 [debug] [Thread-1  ]: finished collecting timing info
18:26:23.893646 [debug] [Thread-4  ]: finished collecting timing info
18:26:23.894312 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:26:23.893767 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:26:23.894080 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:26:23.894463 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:23.894660 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:26:23.893842 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:26:23.894932 [debug] [Thread-1  ]: Database Error in test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA (models/erp/schema.yml)
  relation "public.costumers" does not exist
  LINE 17:     from "erp_oltp"."public"."costumers"
                    ^
  compiled SQL at target/run/first_project/models/erp/schema.yml/accepted_values_costumers_bf4e43dcefd21be06d924a1eb5a9c630.sql
18:26:23.895771 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:26:23.896074 [error] [Thread-1  ]: 1 of 7 ERROR accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[31mERROR[0m in 0.16s]
18:26:23.896593 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:23.896939 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:26:23.898361 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:26:23.898771 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:26:23.899042 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:23.903778 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.01 seconds
18:26:23.905078 [debug] [Thread-6  ]: finished collecting timing info
18:26:23.905244 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:26:23.905767 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:26:23.906253 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
18:26:23.909945 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:23.911525 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:23.911684 [debug] [MainThread]: Using postgres connection "master"
18:26:23.911792 [debug] [MainThread]: On master: BEGIN
18:26:23.911867 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:23.918020 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:23.918270 [debug] [MainThread]: On master: COMMIT
18:26:23.918340 [debug] [MainThread]: Using postgres connection "master"
18:26:23.918407 [debug] [MainThread]: On master: COMMIT
18:26:23.918718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:23.918918 [debug] [MainThread]: On master: Close
18:26:23.919582 [info ] [MainThread]: 
18:26:23.919766 [info ] [MainThread]: Finished running 7 tests in 0.23s.
18:26:23.920010 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:23.920106 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:26:23.920163 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:26:23.920216 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:26:23.920268 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:26:23.920320 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:26:23.920430 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:26:23.920496 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:26:23.923646 [info ] [MainThread]: 
18:26:23.923866 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:26:23.924072 [info ] [MainThread]: 
18:26:23.924217 [error] [MainThread]: [33mDatabase Error in test unique_costumers_customer_id (models/erp/schema.yml)[0m
18:26:23.924353 [error] [MainThread]:   relation "public.costumers" does not exist
18:26:23.925508 [error] [MainThread]:   LINE 15: from "erp_oltp"."public"."costumers"
18:26:23.925665 [error] [MainThread]:                 ^
18:26:23.925851 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/unique_costumers_customer_id.sql
18:26:23.925989 [info ] [MainThread]: 
18:26:23.926127 [error] [MainThread]: [33mDatabase Error in test not_null_costumers_customer_id (models/erp/schema.yml)[0m
18:26:23.926264 [error] [MainThread]:   relation "public.costumers" does not exist
18:26:23.926390 [error] [MainThread]:   LINE 14: from "erp_oltp"."public"."costumers"
18:26:23.926518 [error] [MainThread]:                 ^
18:26:23.926646 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_costumers_customer_id.sql
18:26:23.926792 [info ] [MainThread]: 
18:26:23.926939 [error] [MainThread]: [33mDatabase Error in test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA (models/erp/schema.yml)[0m
18:26:23.927091 [error] [MainThread]:   relation "public.costumers" does not exist
18:26:23.927240 [error] [MainThread]:   LINE 17:     from "erp_oltp"."public"."costumers"
18:26:23.927385 [error] [MainThread]:                     ^
18:26:23.927527 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/accepted_values_costumers_bf4e43dcefd21be06d924a1eb5a9c630.sql
18:26:23.927727 [info ] [MainThread]: 
18:26:23.927852 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:26:23.928107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df5a71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df5a7a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90df5c2430>]}


============================== 2022-06-04 18:27:30.261014 | c9f86309-5431-42dd-b270-9850bc161aee ==============================
18:27:30.261029 [info ] [MainThread]: Running with dbt=1.1.0
18:27:30.261481 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:27:30.261574 [debug] [MainThread]: Tracking: tracking
18:27:30.264183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97dafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97dafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97dad60>]}
18:27:30.284575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:27:30.284968 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
18:27:30.293148 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
18:27:30.360335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97d1490>]}
18:27:30.363845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97cf6d0>]}
18:27:30.364127 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:27:30.364280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97cf640>]}
18:27:30.365392 [info ] [MainThread]: 
18:27:30.365729 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:30.366580 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:27:30.373081 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:27:30.373228 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:27:30.373297 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:30.387707 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:27:30.389096 [debug] [ThreadPool]: On list_erp_oltp: Close
18:27:30.391961 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:27:30.400197 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:30.400426 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:27:30.400496 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:30.406797 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:27:30.407041 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:30.407116 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:27:30.409177 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:27:30.410508 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:27:30.410883 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:27:30.413851 [debug] [MainThread]: Using postgres connection "master"
18:27:30.413987 [debug] [MainThread]: On master: BEGIN
18:27:30.414054 [debug] [MainThread]: Opening a new connection, currently in state init
18:27:30.418127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:30.418269 [debug] [MainThread]: Using postgres connection "master"
18:27:30.418334 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:27:30.428059 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:27:30.429043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca96c7e50>]}
18:27:30.429299 [debug] [MainThread]: On master: ROLLBACK
18:27:30.429526 [debug] [MainThread]: Using postgres connection "master"
18:27:30.429645 [debug] [MainThread]: On master: BEGIN
18:27:30.429900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:30.429992 [debug] [MainThread]: On master: COMMIT
18:27:30.430056 [debug] [MainThread]: Using postgres connection "master"
18:27:30.430128 [debug] [MainThread]: On master: COMMIT
18:27:30.430264 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:30.430350 [debug] [MainThread]: On master: Close
18:27:30.430656 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:27:30.430825 [info ] [MainThread]: 
18:27:30.436942 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:27:30.437209 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:27:30.437496 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:27:30.437593 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:27:30.437693 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:27:30.439313 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:27:30.439632 [debug] [Thread-1  ]: finished collecting timing info
18:27:30.439857 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:27:30.446288 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:27:30.446548 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:27:30.446902 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.447005 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:27:30.447076 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:27:30.449077 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:27:30.449334 [debug] [Thread-2  ]: finished collecting timing info
18:27:30.449464 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:27:30.455649 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
18:27:30.456036 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_custumers ................................... [RUN]
18:27:30.456604 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
18:27:30.456756 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
18:27:30.456866 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
18:27:30.460192 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
18:27:30.460371 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:27:30.460653 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:27:30.460959 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:27:30.461045 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:27:30.461116 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:27:30.461936 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:27:30.484217 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:27:30.485694 [debug] [Thread-3  ]: finished collecting timing info
18:27:30.485938 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
18:27:30.487755 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
18:27:30.488157 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.488394 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:27:30.488594 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:27:30.489547 [debug] [Thread-4  ]: finished collecting timing info
18:27:30.489735 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:27:30.491301 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:27:30.491572 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:27:30.491708 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:27:30.491770 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:27:30.492904 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
18:27:30.493010 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.493072 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:27:30.494534 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:27:30.498979 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.499179 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:27:30.499958 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.501380 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.502179 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:27:30.502665 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:27:30.502778 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
18:27:30.502860 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:27:30.503214 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.508162 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:27:30.513764 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.514082 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:27:30.514249 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:27:30.514357 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:27:30.514428 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)

select * from orders
  );
18:27:30.520130 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:27:30.520309 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
18:27:30.520435 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:27:30.520674 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:27:30.525570 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:27:30.525275 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:27:30.522423 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:27:30.526392 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:27:30.525707 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
18:27:30.526031 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:27:30.526637 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:27:30.526710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:27:30.526969 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.526198 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:27:30.528956 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:27:30.528337 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:27:30.531479 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:27:30.531759 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:27:30.532359 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.531960 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
18:27:30.533096 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:27:30.533345 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:27:30.533433 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:27:30.531858 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:27:30.534446 [debug] [Thread-2  ]: finished collecting timing info
18:27:30.534764 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:27:30.536000 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:27:30.536292 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:27:30.536147 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.534878 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:27:30.537930 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:27:30.538605 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
18:27:30.538282 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:27:30.538780 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:27:30.538859 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    --union al
    --select null as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:27:30.539818 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:30.538168 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:27:30.541363 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:27:30.541521 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.542392 [debug] [Thread-4  ]: finished collecting timing info
18:27:30.544135 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:27:30.543889 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:27:30.544380 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:27:30.544464 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
18:27:30.542892 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:27:30.546189 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca81b7520>]}
18:27:30.546711 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.09s]
18:27:30.546370 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.542695 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97c3df0>]}
18:27:30.548826 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
18:27:30.548459 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:27:30.548560 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:27:30.547035 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:27:30.549069 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:27:30.549225 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:27:30.550096 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
18:27:30.550513 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
18:27:30.551319 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.554930 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:27:30.555051 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:27:30.555119 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:27:30.555486 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:27:30.556194 [debug] [Thread-3  ]: finished collecting timing info
18:27:30.556299 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
18:27:30.556655 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cab6850d0>]}
18:27:30.556867 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.10s]
18:27:30.557856 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
18:27:30.559413 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:27:30.563526 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:27:30.563825 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:27:30.564543 [debug] [Thread-6  ]: Began running node model.first_project.costumers
18:27:30.564853 [info ] [Thread-6  ]: 5 of 7 START view model public.costumers ....................................... [RUN]
18:27:30.565201 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.costumers"
18:27:30.565351 [debug] [Thread-6  ]: Began compiling node model.first_project.costumers
18:27:30.565450 [debug] [Thread-6  ]: Compiling model.first_project.costumers
18:27:30.569596 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.costumers"
18:27:30.570256 [debug] [Thread-7  ]: Began running node model.first_project.costumers2
18:27:30.573293 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:27:30.576179 [info ] [Thread-7  ]: 6 of 7 START table model public.costumers2 ..................................... [RUN]
18:27:30.577613 [debug] [Thread-1  ]: finished collecting timing info
18:27:30.578262 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.costumers2"
18:27:30.578490 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:27:30.578653 [debug] [Thread-7  ]: Began compiling node model.first_project.costumers2
18:27:30.578901 [debug] [Thread-7  ]: Compiling model.first_project.costumers2
18:27:30.581883 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.costumers2"
18:27:30.582328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca9223f40>]}
18:27:30.582604 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 1[0m in 0.14s]
18:27:30.582889 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:27:30.583246 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
18:27:30.583458 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:27:30.583896 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:27:30.584033 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
18:27:30.584169 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
18:27:30.586813 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:27:30.587178 [debug] [Thread-9  ]: finished collecting timing info
18:27:30.587351 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
18:27:30.588899 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:27:30.589155 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:27:30.589241 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
18:27:30.589302 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:27:30.589921 [debug] [Thread-6  ]: finished collecting timing info
18:27:30.590090 [debug] [Thread-6  ]: Began executing node model.first_project.costumers
18:27:30.594673 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.costumers"
18:27:30.595173 [debug] [Thread-7  ]: finished collecting timing info
18:27:30.595615 [debug] [Thread-7  ]: Began executing node model.first_project.costumers2
18:27:30.599049 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.costumers2"
18:27:30.599400 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:27:30.599586 [debug] [Thread-6  ]: On model.first_project.costumers: BEGIN
18:27:30.599686 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:27:30.600592 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:27:30.600754 [debug] [Thread-7  ]: On model.first_project.costumers2: BEGIN
18:27:30.600817 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:27:30.604054 [debug] [Thread-6  ]: SQL status: BEGIN in 0.0 seconds
18:27:30.604263 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:27:30.604378 [debug] [Thread-6  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  where customers.customer_id <> 63
)

select * from final
  );
18:27:30.606842 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:27:30.608651 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:27:30.608840 [debug] [Thread-6  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
18:27:30.608989 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
18:27:30.609101 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:27:30.609174 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:27:30.609331 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.610126 [debug] [Thread-6  ]: On model.first_project.costumers: COMMIT
18:27:30.610316 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:27:30.610492 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:27:30.612885 [debug] [Thread-6  ]: On model.first_project.costumers: COMMIT
18:27:30.612652 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:27:30.613058 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:27:30.622254 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:27:30.623497 [debug] [Thread-6  ]: Using postgres connection "model.first_project.costumers"
18:27:30.623617 [debug] [Thread-6  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
18:27:30.622518 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.01 seconds
18:27:30.624420 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:27:30.624519 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:27:30.624589 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:27:30.624884 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:27:30.625628 [debug] [Thread-6  ]: finished collecting timing info
18:27:30.625872 [debug] [Thread-6  ]: On model.first_project.costumers: Close
18:27:30.626188 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca80e8070>]}
18:27:30.626431 [info ] [Thread-6  ]: 5 of 7 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.06s]
18:27:30.626828 [debug] [Thread-6  ]: Finished running node model.first_project.costumers
18:27:30.627369 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:27:30.628726 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:27:30.628833 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:27:30.629144 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:27:30.629252 [debug] [Thread-7  ]: SQL status: BEGIN in 0.03 seconds
18:27:30.630407 [debug] [Thread-9  ]: finished collecting timing info
18:27:30.630665 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:27:30.630860 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
18:27:30.631088 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:27:30.631683 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca8147d60>]}
18:27:30.631986 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:27:30.632238 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
18:27:30.635365 [debug] [Thread-7  ]: SQL status: SELECT 50 in 0.0 seconds
18:27:30.637229 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:27:30.637366 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
18:27:30.640084 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.644654 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:27:30.644870 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
18:27:30.646246 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:27:30.647650 [debug] [Thread-7  ]: On model.first_project.costumers2: COMMIT
18:27:30.647777 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:27:30.647851 [debug] [Thread-7  ]: On model.first_project.costumers2: COMMIT
18:27:30.649262 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
18:27:30.650519 [debug] [Thread-7  ]: Using postgres connection "model.first_project.costumers2"
18:27:30.650617 [debug] [Thread-7  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
18:27:30.652252 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
18:27:30.653175 [debug] [Thread-7  ]: finished collecting timing info
18:27:30.653288 [debug] [Thread-7  ]: On model.first_project.costumers2: Close
18:27:30.653578 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9f86309-5431-42dd-b270-9850bc161aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca80feee0>]}
18:27:30.653843 [info ] [Thread-7  ]: 6 of 7 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.08s]
18:27:30.656493 [debug] [Thread-7  ]: Finished running node model.first_project.costumers2
18:27:30.658094 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:30.658222 [debug] [MainThread]: Using postgres connection "master"
18:27:30.658288 [debug] [MainThread]: On master: BEGIN
18:27:30.658345 [debug] [MainThread]: Opening a new connection, currently in state closed
18:27:30.662260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:30.662391 [debug] [MainThread]: On master: COMMIT
18:27:30.662459 [debug] [MainThread]: Using postgres connection "master"
18:27:30.662517 [debug] [MainThread]: On master: COMMIT
18:27:30.662640 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:30.662738 [debug] [MainThread]: On master: Close
18:27:30.663068 [info ] [MainThread]: 
18:27:30.663222 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.30s.
18:27:30.663339 [debug] [MainThread]: Connection 'master' was properly closed.
18:27:30.663407 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:27:30.663495 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:27:30.663566 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
18:27:30.663639 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:27:30.663758 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
18:27:30.663817 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
18:27:30.663873 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:27:30.667308 [info ] [MainThread]: 
18:27:30.667584 [info ] [MainThread]: [32mCompleted successfully[0m
18:27:30.667740 [info ] [MainThread]: 
18:27:30.667843 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:27:30.668017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97d19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cab08fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ca97cf0d0>]}


============================== 2022-06-04 18:27:34.674419 | a39f2fe5-279a-4f52-97be-ec3bc2504da7 ==============================
18:27:34.674434 [info ] [MainThread]: Running with dbt=1.1.0
18:27:34.674835 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:27:34.674928 [debug] [MainThread]: Tracking: tracking
18:27:34.677849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bbb9afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bbb9a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bbb9afa0>]}
18:27:34.706249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:27:34.706458 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:27:34.711352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a39f2fe5-279a-4f52-97be-ec3bc2504da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bba4caf0>]}
18:27:34.719837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a39f2fe5-279a-4f52-97be-ec3bc2504da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bbb2dc40>]}
18:27:34.720182 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:27:34.720395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a39f2fe5-279a-4f52-97be-ec3bc2504da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bbb2dbb0>]}
18:27:34.721728 [info ] [MainThread]: 
18:27:34.722242 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:34.723290 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:27:34.729530 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:34.730052 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:27:34.730204 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:34.739918 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:27:34.740153 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:34.740243 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:27:34.742163 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:27:34.743856 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:27:34.744139 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:27:34.748273 [debug] [MainThread]: Using postgres connection "master"
18:27:34.748465 [debug] [MainThread]: On master: BEGIN
18:27:34.748593 [debug] [MainThread]: Opening a new connection, currently in state init
18:27:34.752927 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:34.753103 [debug] [MainThread]: Using postgres connection "master"
18:27:34.753174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:27:34.763116 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:27:34.764113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a39f2fe5-279a-4f52-97be-ec3bc2504da7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2bbb2d9d0>]}
18:27:34.764357 [debug] [MainThread]: On master: ROLLBACK
18:27:34.764632 [debug] [MainThread]: Using postgres connection "master"
18:27:34.764756 [debug] [MainThread]: On master: BEGIN
18:27:34.765009 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:34.765113 [debug] [MainThread]: On master: COMMIT
18:27:34.765180 [debug] [MainThread]: Using postgres connection "master"
18:27:34.765251 [debug] [MainThread]: On master: COMMIT
18:27:34.765378 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:34.765472 [debug] [MainThread]: On master: Close
18:27:34.765845 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:27:34.766113 [info ] [MainThread]: 
18:27:34.770097 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:34.770296 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:27:34.770413 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:34.770854 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:34.771740 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:34.771876 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:34.771137 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:34.771273 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:34.771339 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:34.783148 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:27:34.771053 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:34.784125 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:27:34.771209 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:34.782880 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:27:34.790108 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:34.790195 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:34.790286 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:34.771545 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:27:34.829166 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:34.829293 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:34.789521 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:27:34.784486 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:34.830058 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:34.830173 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:34.789151 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:34.783860 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:34.829375 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:34.829862 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:34.838729 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:34.782436 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:27:34.839288 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:34.839372 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:34.839448 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:34.838838 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:27:34.843633 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:34.843930 [debug] [Thread-5  ]: finished collecting timing info
18:27:34.836153 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:34.841523 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:34.838950 [debug] [Thread-1  ]: finished collecting timing info
18:27:34.844532 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:34.844371 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:34.828724 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:34.847333 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:34.847580 [debug] [Thread-4  ]: finished collecting timing info
18:27:34.868512 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:34.838472 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:34.871002 [debug] [Thread-2  ]: finished collecting timing info
18:27:34.871177 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:34.872240 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:34.872493 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:34.872634 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:27:34.872711 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:27:34.835924 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:34.873117 [debug] [Thread-3  ]: finished collecting timing info
18:27:34.873259 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:34.870251 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:34.868200 [debug] [Thread-6  ]: finished collecting timing info
18:27:34.874774 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:34.850618 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:34.874357 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:34.867923 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:34.878426 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:34.876560 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:34.878648 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:27:34.877811 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:34.878825 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:27:34.878912 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:27:34.878579 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:27:34.878010 [debug] [Thread-7  ]: finished collecting timing info
18:27:34.878717 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:27:34.876224 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:34.880852 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:34.881012 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:27:34.880233 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:34.879153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:27:34.877509 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:34.882356 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:34.881087 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:27:34.883340 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:27:34.884060 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:34.884137 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:27:34.883719 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:34.884230 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:27:34.883563 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:34.884322 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:27:34.884445 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:27:34.886014 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:27:34.886300 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:34.888118 [debug] [Thread-2  ]: finished collecting timing info
18:27:34.888303 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:27:34.888461 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:27:34.888971 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.06s]
18:27:34.889335 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:34.889518 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:27:34.889618 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:34.889682 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:27:34.890432 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:34.891292 [debug] [Thread-4  ]: finished collecting timing info
18:27:34.891403 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:27:34.891593 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:27:34.891884 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.05s]
18:27:34.892140 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:34.897196 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:27:34.897418 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:34.897510 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:27:34.897797 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:27:34.897959 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:34.898037 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:27:34.898744 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:34.899671 [debug] [Thread-6  ]: finished collecting timing info
18:27:34.899791 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:27:34.901403 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:27:34.901527 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:34.901594 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:27:34.903077 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:34.904200 [debug] [Thread-5  ]: finished collecting timing info
18:27:34.904342 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:27:34.904568 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.01 seconds
18:27:34.905375 [debug] [Thread-3  ]: finished collecting timing info
18:27:34.905475 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:27:34.905561 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:27:34.905923 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.12s]
18:27:34.906161 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:34.907821 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:27:34.909291 [info ] [Thread-3  ]: 3 of 7 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.12s]
18:27:34.910246 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:34.910886 [debug] [Thread-7  ]: SQL status: BEGIN in 0.03 seconds
18:27:34.911003 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:34.911066 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:27:34.911301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:27:34.911416 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:34.911489 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:27:34.912279 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:34.913405 [debug] [Thread-7  ]: finished collecting timing info
18:27:34.913608 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:27:34.915609 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:27:34.916181 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.09s]
18:27:34.916488 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:34.917460 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:27:34.918464 [debug] [Thread-1  ]: finished collecting timing info
18:27:34.918617 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:27:34.918790 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:27:34.919054 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:27:34.919564 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.14s]
18:27:34.919925 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.15s]
18:27:34.920239 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:34.920512 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:34.921809 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:34.921929 [debug] [MainThread]: Using postgres connection "master"
18:27:34.921998 [debug] [MainThread]: On master: BEGIN
18:27:34.922056 [debug] [MainThread]: Opening a new connection, currently in state closed
18:27:34.926202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:34.926386 [debug] [MainThread]: On master: COMMIT
18:27:34.926459 [debug] [MainThread]: Using postgres connection "master"
18:27:34.926524 [debug] [MainThread]: On master: COMMIT
18:27:34.926646 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:34.926742 [debug] [MainThread]: On master: Close
18:27:34.927022 [info ] [MainThread]: 
18:27:34.927239 [info ] [MainThread]: Finished running 7 tests in 0.20s.
18:27:34.927364 [debug] [MainThread]: Connection 'master' was properly closed.
18:27:34.927421 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:27:34.927473 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:27:34.927548 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:27:34.927602 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:27:34.927653 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:27:34.927703 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:27:34.927755 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:27:34.935010 [info ] [MainThread]: 
18:27:34.935310 [info ] [MainThread]: [32mCompleted successfully[0m
18:27:34.935481 [info ] [MainThread]: 
18:27:34.937149 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:27:34.937450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2b814df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2be7e55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2b8172ee0>]}


============================== 2022-06-04 18:27:45.700316 | ec48f608-348b-4ba0-8609-af817af74e3b ==============================
18:27:45.700333 [info ] [MainThread]: Running with dbt=1.1.0
18:27:45.700844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:27:45.700959 [debug] [MainThread]: Tracking: tracking
18:27:45.703655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345e149fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345e149fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345e149d60>]}
18:27:45.731140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:27:45.731334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:27:45.735469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec48f608-348b-4ba0-8609-af817af74e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345dfecfa0>]}
18:27:45.744680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec48f608-348b-4ba0-8609-af817af74e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345e0ccc70>]}
18:27:45.744957 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:27:45.745117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec48f608-348b-4ba0-8609-af817af74e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345e0ccca0>]}
18:27:45.746702 [info ] [MainThread]: 
18:27:45.747121 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:45.748112 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:27:45.755809 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:45.756012 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:27:45.756093 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:45.765974 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:27:45.766183 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:45.766260 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:27:45.768046 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:27:45.772272 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:27:45.772808 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:27:45.778002 [debug] [MainThread]: Using postgres connection "master"
18:27:45.778200 [debug] [MainThread]: On master: BEGIN
18:27:45.778277 [debug] [MainThread]: Opening a new connection, currently in state init
18:27:45.782832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:45.783032 [debug] [MainThread]: Using postgres connection "master"
18:27:45.783125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:27:45.793535 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:27:45.794760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec48f608-348b-4ba0-8609-af817af74e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345e0cca60>]}
18:27:45.795013 [debug] [MainThread]: On master: ROLLBACK
18:27:45.795292 [debug] [MainThread]: Using postgres connection "master"
18:27:45.795437 [debug] [MainThread]: On master: BEGIN
18:27:45.795637 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:45.795732 [debug] [MainThread]: On master: COMMIT
18:27:45.795797 [debug] [MainThread]: Using postgres connection "master"
18:27:45.795856 [debug] [MainThread]: On master: COMMIT
18:27:45.795972 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:45.796103 [debug] [MainThread]: On master: Close
18:27:45.796394 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:27:45.796569 [info ] [MainThread]: 
18:27:45.803386 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:45.803599 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:27:45.803902 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:45.804023 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:45.804113 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:45.810993 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:45.811202 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:27:45.811505 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:45.811674 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:45.811838 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:45.833983 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:45.811929 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:45.812072 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:45.817546 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:45.866876 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:27:45.867188 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:45.867267 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:45.867333 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:45.861452 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:27:45.866617 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:45.817764 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:27:45.872552 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:45.872636 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:45.872703 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:45.874907 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:45.872171 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:45.871660 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:45.861275 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:27:45.861000 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:45.875205 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:45.876403 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:45.811993 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:45.878964 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:27:45.876083 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:45.879404 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:45.879521 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:45.878688 [debug] [Thread-1  ]: finished collecting timing info
18:27:45.879213 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:45.883504 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:45.883629 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:27:45.878473 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:45.886674 [debug] [Thread-6  ]: finished collecting timing info
18:27:45.886834 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:45.883386 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:45.875653 [debug] [Thread-3  ]: finished collecting timing info
18:27:45.878850 [debug] [Thread-7  ]: finished collecting timing info
18:27:45.886022 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:45.881906 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:45.913270 [debug] [Thread-5  ]: finished collecting timing info
18:27:45.911403 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:45.911625 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:45.914945 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:45.912626 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:45.875473 [debug] [Thread-2  ]: finished collecting timing info
18:27:45.913454 [debug] [Thread-4  ]: finished collecting timing info
18:27:45.913640 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:45.912284 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:45.916201 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:45.918440 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:45.918601 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:27:45.916709 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:45.916983 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:45.918115 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:45.920952 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:45.918723 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:27:45.921981 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:45.918874 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:27:45.920513 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:45.921164 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:27:45.922484 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:27:45.916375 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:45.922236 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:27:45.922147 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:27:45.923923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:27:45.922962 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:45.924543 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:27:45.924642 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:27:45.923496 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:27:45.925268 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:27:45.916865 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:45.927339 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:45.927739 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:45.928821 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:27:45.928929 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:27:45.929233 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
18:27:45.929442 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:45.929534 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:27:45.931197 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:45.932714 [debug] [Thread-7  ]: finished collecting timing info
18:27:45.933300 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:27:45.933611 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:27:45.933750 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:27:45.933833 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:27:45.935709 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:27:45.936288 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
18:27:45.936644 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:45.941135 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:27:45.943483 [debug] [Thread-5  ]: finished collecting timing info
18:27:45.944074 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:27:45.946911 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:27:45.947215 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:27:45.947697 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.07s]
18:27:45.947827 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:45.948153 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:27:45.948299 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:27:45.948809 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:27:45.948889 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:27:45.948500 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:27:45.949558 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:45.950694 [debug] [Thread-6  ]: finished collecting timing info
18:27:45.950850 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:27:45.951912 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:27:45.952371 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.08s]
18:27:45.952793 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:45.953409 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:27:45.953514 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:45.953580 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:27:45.954419 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:45.955362 [debug] [Thread-4  ]: finished collecting timing info
18:27:45.955467 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:27:45.955706 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:27:45.955856 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:27:45.955936 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:27:45.956102 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:27:45.956180 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:45.956237 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:27:45.956387 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:27:45.956700 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:27:45.956944 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:45.957516 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:45.958451 [debug] [Thread-3  ]: finished collecting timing info
18:27:45.958580 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:27:45.958699 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:27:45.959640 [debug] [Thread-1  ]: finished collecting timing info
18:27:45.959737 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:27:45.960156 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:27:45.960455 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.16s]
18:27:45.960681 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:27:45.962031 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:27:45.962367 [info ] [Thread-3  ]: 3 of 7 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.09s]
18:27:45.962597 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:45.965539 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:27:45.966636 [debug] [Thread-2  ]: finished collecting timing info
18:27:45.966813 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:27:45.967187 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:27:45.967572 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.16s]
18:27:45.967939 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:27:45.969479 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:45.969608 [debug] [MainThread]: Using postgres connection "master"
18:27:45.969673 [debug] [MainThread]: On master: BEGIN
18:27:45.969809 [debug] [MainThread]: Opening a new connection, currently in state closed
18:27:45.978430 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:27:45.978662 [debug] [MainThread]: On master: COMMIT
18:27:45.978732 [debug] [MainThread]: Using postgres connection "master"
18:27:45.978796 [debug] [MainThread]: On master: COMMIT
18:27:45.979000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:45.979165 [debug] [MainThread]: On master: Close
18:27:45.979670 [info ] [MainThread]: 
18:27:45.979914 [info ] [MainThread]: Finished running 7 tests in 0.23s.
18:27:45.980026 [debug] [MainThread]: Connection 'master' was properly closed.
18:27:45.980088 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:27:45.980146 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:27:45.980195 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:27:45.980243 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:27:45.980291 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:27:45.980337 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:27:45.980435 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:27:45.983723 [info ] [MainThread]: 
18:27:45.983989 [info ] [MainThread]: [32mCompleted successfully[0m
18:27:45.984160 [info ] [MainThread]: 
18:27:45.984296 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:27:45.984531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345df84c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345df84d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f345df84a30>]}


============================== 2022-06-04 18:28:14.670925 | b79e875f-3f17-463a-8fcc-633e705dacd9 ==============================
18:28:14.670940 [info ] [MainThread]: Running with dbt=1.1.0
18:28:14.671386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:28:14.671504 [debug] [MainThread]: Tracking: tracking
18:28:14.674123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ac02040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ac02f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ac02070>]}
18:28:14.700132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:28:14.700303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:28:14.704752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b79e875f-3f17-463a-8fcc-633e705dacd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369aab2af0>]}
18:28:14.713192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b79e875f-3f17-463a-8fcc-633e705dacd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ab94c40>]}
18:28:14.713633 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:28:14.714089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b79e875f-3f17-463a-8fcc-633e705dacd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ab94bb0>]}
18:28:14.715584 [info ] [MainThread]: 
18:28:14.716004 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:14.716971 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:28:14.723936 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:14.724128 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:28:14.724262 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:14.732167 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:14.732392 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:14.732478 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:28:14.737519 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:28:14.739065 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:28:14.739480 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:28:14.742532 [debug] [MainThread]: Using postgres connection "master"
18:28:14.742667 [debug] [MainThread]: On master: BEGIN
18:28:14.742755 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:14.747602 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:14.747793 [debug] [MainThread]: Using postgres connection "master"
18:28:14.747876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:14.758117 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:28:14.759204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b79e875f-3f17-463a-8fcc-633e705dacd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ab949d0>]}
18:28:14.759443 [debug] [MainThread]: On master: ROLLBACK
18:28:14.759770 [debug] [MainThread]: Using postgres connection "master"
18:28:14.759878 [debug] [MainThread]: On master: BEGIN
18:28:14.760325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:14.760435 [debug] [MainThread]: On master: COMMIT
18:28:14.760506 [debug] [MainThread]: Using postgres connection "master"
18:28:14.760566 [debug] [MainThread]: On master: COMMIT
18:28:14.760851 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:14.760960 [debug] [MainThread]: On master: Close
18:28:14.761244 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:28:14.761393 [info ] [MainThread]: 
18:28:14.767289 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:14.767512 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:28:14.767807 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:14.767904 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:14.768031 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:14.778405 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:14.778681 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:28:14.779094 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:14.779626 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:14.779781 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:14.779926 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:14.789885 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:28:14.785720 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:14.790455 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:14.786327 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:28:14.825989 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:14.789650 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:28:14.790276 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:14.832779 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:14.832898 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:28:14.836787 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:14.789386 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:14.826529 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:14.832479 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:14.780063 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:14.840588 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:28:14.840997 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:14.841134 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:14.837737 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:14.841245 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:14.845298 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:14.826116 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:14.845983 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:14.848218 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:14.842134 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:14.786084 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:14.838059 [debug] [Thread-1  ]: finished collecting timing info
18:28:14.841591 [debug] [Thread-5  ]: finished collecting timing info
18:28:14.850502 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:14.854209 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:28:14.854407 [debug] [Thread-3  ]: finished collecting timing info
18:28:14.856553 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:14.855519 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:14.856158 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:14.878998 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:14.856457 [debug] [Thread-6  ]: finished collecting timing info
18:28:14.879284 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:14.880238 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:14.880506 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:14.880585 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:28:14.880652 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:28:14.879110 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:14.883346 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:14.856379 [debug] [Thread-4  ]: finished collecting timing info
18:28:14.883555 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:14.884796 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:14.885317 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:14.885432 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:28:14.885512 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:28:14.854687 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:14.878784 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:14.873924 [debug] [Thread-2  ]: finished collecting timing info
18:28:14.892228 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:14.891416 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:14.894872 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:14.895196 [debug] [Thread-7  ]: finished collecting timing info
18:28:14.895822 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:14.877985 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:14.895338 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:28:14.896911 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:14.897150 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:14.898534 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:28:14.898650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:14.898022 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:14.898320 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:14.898921 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:28:14.898813 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:28:14.897533 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:14.899226 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:28:14.899297 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:28:14.899001 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:28:14.897838 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:14.900167 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:28:14.900245 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:28:14.900041 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:14.900648 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:28:14.900726 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:28:14.901974 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:14.903826 [debug] [Thread-6  ]: finished collecting timing info
18:28:14.904026 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:28:14.905528 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:28:14.906095 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
18:28:14.906439 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:14.909748 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:28:14.909905 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:14.910001 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:28:14.911596 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:14.912635 [debug] [Thread-4  ]: finished collecting timing info
18:28:14.912767 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:28:14.916269 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:28:14.916490 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:14.916587 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:28:14.919466 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:28:14.920074 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:28:14.920454 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:14.922947 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:28:14.923136 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:14.923360 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:14.925043 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:28:14.924566 [debug] [Thread-7  ]: finished collecting timing info
18:28:14.925256 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:28:14.925375 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:28:14.923618 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:28:14.925475 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:14.925638 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:28:14.925799 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:14.926090 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:28:14.926271 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:28:14.926568 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
18:28:14.926751 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:28:14.927123 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:14.927225 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:14.927535 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:28:14.927995 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:14.929094 [debug] [Thread-3  ]: finished collecting timing info
18:28:14.929227 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:28:14.929386 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:28:14.929985 [info ] [Thread-3  ]: 3 of 7 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.10s]
18:28:14.930282 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:14.931697 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:14.932632 [debug] [Thread-5  ]: finished collecting timing info
18:28:14.932726 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:14.933514 [debug] [Thread-2  ]: finished collecting timing info
18:28:14.933614 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:28:14.932827 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:28:14.933860 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:28:14.934142 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.16s]
18:28:14.934433 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:14.934561 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:28:14.934806 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.14s]
18:28:14.935092 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:14.935716 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:14.937328 [debug] [Thread-1  ]: finished collecting timing info
18:28:14.937502 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:28:14.937900 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:28:14.938333 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.17s]
18:28:14.938640 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:14.940000 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:14.940119 [debug] [MainThread]: Using postgres connection "master"
18:28:14.940185 [debug] [MainThread]: On master: BEGIN
18:28:14.940242 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:14.946150 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:14.946382 [debug] [MainThread]: On master: COMMIT
18:28:14.946463 [debug] [MainThread]: Using postgres connection "master"
18:28:14.946531 [debug] [MainThread]: On master: COMMIT
18:28:14.947247 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:14.947413 [debug] [MainThread]: On master: Close
18:28:14.947786 [info ] [MainThread]: 
18:28:14.947955 [info ] [MainThread]: Finished running 7 tests in 0.23s.
18:28:14.948064 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:14.948120 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:28:14.948170 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:28:14.948230 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:28:14.948280 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:28:14.948329 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:28:14.948377 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:28:14.948427 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:28:14.951980 [info ] [MainThread]: 
18:28:14.952214 [info ] [MainThread]: [32mCompleted successfully[0m
18:28:14.952383 [info ] [MainThread]: 
18:28:14.952544 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:28:14.952720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36981e61c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369ab945e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36981de9a0>]}


============================== 2022-06-04 18:28:49.935689 | 9ed504a0-ee62-4731-8c96-78e19ba23284 ==============================
18:28:49.935706 [info ] [MainThread]: Running with dbt=1.1.0
18:28:49.936150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:28:49.936299 [debug] [MainThread]: Tracking: tracking
18:28:49.938870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609558e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609558ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609558ee20>]}
18:28:49.960716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:28:49.961120 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/costumers.sql
18:28:49.970731 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
18:28:50.033583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed504a0-ee62-4731-8c96-78e19ba23284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6095596490>]}
18:28:50.037580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed504a0-ee62-4731-8c96-78e19ba23284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609548be80>]}
18:28:50.037950 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:28:50.038202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed504a0-ee62-4731-8c96-78e19ba23284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609548bee0>]}
18:28:50.039405 [info ] [MainThread]: 
18:28:50.039805 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:50.040854 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:28:50.047291 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:50.047428 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:28:50.047496 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:50.053851 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:50.054054 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:50.054125 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:28:50.055573 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:28:50.056712 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:28:50.056896 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:28:50.060418 [debug] [MainThread]: Using postgres connection "master"
18:28:50.060604 [debug] [MainThread]: On master: BEGIN
18:28:50.060683 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:50.067507 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:50.067736 [debug] [MainThread]: Using postgres connection "master"
18:28:50.067833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:50.079053 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:28:50.080070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ed504a0-ee62-4731-8c96-78e19ba23284', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609559f460>]}
18:28:50.080323 [debug] [MainThread]: On master: ROLLBACK
18:28:50.080712 [debug] [MainThread]: Using postgres connection "master"
18:28:50.080825 [debug] [MainThread]: On master: BEGIN
18:28:50.081051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:50.081148 [debug] [MainThread]: On master: COMMIT
18:28:50.081221 [debug] [MainThread]: Using postgres connection "master"
18:28:50.081288 [debug] [MainThread]: On master: COMMIT
18:28:50.081483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:50.081607 [debug] [MainThread]: On master: Close
18:28:50.082042 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:28:50.082274 [info ] [MainThread]: 
18:28:50.089422 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:50.089750 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:28:50.090268 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:50.090408 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:50.090521 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:50.096126 [debug] [Thread-2  ]: Began running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:50.096429 [info ] [Thread-2  ]: 2 of 7 START test not_null_costumers_customer_id ............................... [RUN]
18:28:50.096830 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:50.096981 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:50.097075 [debug] [Thread-2  ]: Compiling test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:50.103205 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:50.103765 [debug] [Thread-2  ]: finished collecting timing info
18:28:50.105917 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:50.105752 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:50.112763 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:50.116850 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:28:50.113144 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:50.116342 [debug] [Thread-5  ]: Began running node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:50.116608 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:50.116705 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:50.116120 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:50.117186 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:50.117365 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:28:50.117647 [info ] [Thread-5  ]: 5 of 7 START test unique_costumers_customer_id ................................. [RUN]
18:28:50.119696 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:50.119818 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:50.119913 [debug] [Thread-5  ]: Compiling test.first_project.unique_costumers_customer_id.996b6965e7
18:28:50.117972 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:28:50.118787 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:50.124597 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:50.124742 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:50.118262 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:50.127673 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:50.117528 [debug] [Thread-1  ]: finished collecting timing info
18:28:50.130774 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:50.117798 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:28:50.132196 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:50.127392 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:50.124388 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:50.130046 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:50.134377 [debug] [Thread-3  ]: finished collecting timing info
18:28:50.132302 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:50.135695 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:50.133992 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:50.138863 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:50.140862 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:50.141144 [debug] [Thread-7  ]: finished collecting timing info
18:28:50.124012 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:50.138562 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:50.141791 [debug] [Thread-6  ]: finished collecting timing info
18:28:50.141938 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:50.143208 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:50.141313 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:50.141468 [debug] [Thread-4  ]: finished collecting timing info
18:28:50.145486 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:50.131788 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:50.146985 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:50.143670 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:50.144958 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:50.147677 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:50.147795 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:28:50.147864 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:28:50.135524 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:50.149363 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:50.147357 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:28:50.145187 [debug] [Thread-5  ]: finished collecting timing info
18:28:50.150349 [debug] [Thread-5  ]: Began executing node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:50.151274 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:50.146559 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:50.149613 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:28:50.150202 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:50.152316 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:28:50.153007 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:28:50.152167 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:50.153812 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:28:50.153889 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:28:50.119079 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:50.154490 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: BEGIN
18:28:50.154571 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:28:50.147130 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: BEGIN
18:28:50.155115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:50.155941 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:50.156073 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: BEGIN
18:28:50.156130 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:28:50.157525 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:28:50.157641 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:50.157758 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:28:50.159259 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:50.160589 [debug] [Thread-6  ]: finished collecting timing info
18:28:50.160756 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:28:50.161355 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:28:50.161808 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.03s]
18:28:50.162243 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:50.162876 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:28:50.162984 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:50.163052 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:28:50.163994 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:50.165070 [debug] [Thread-7  ]: finished collecting timing info
18:28:50.165186 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:28:50.167950 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:28:50.168358 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.04s]
18:28:50.168803 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:50.171566 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:28:50.171691 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:50.171760 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:28:50.171861 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:28:50.171929 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_costumers_customer_id.28d6753afa"
18:28:50.171984 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_costumers_customer_id.28d6753afa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."costumers"
where customer_id is null



      
    ) dbt_internal_test
18:28:50.174894 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:50.175968 [debug] [Thread-3  ]: finished collecting timing info
18:28:50.176094 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:28:50.176617 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:28:50.177147 [info ] [Thread-3  ]: 3 of 7 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.06s]
18:28:50.177567 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:50.178486 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:50.179697 [debug] [Thread-2  ]: finished collecting timing info
18:28:50.179880 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: ROLLBACK
18:28:50.180312 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:28:50.180412 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_costumers_customer_id.996b6965e7"
18:28:50.180486 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_costumers_customer_id.996b6965e7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."costumers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:28:50.180585 [debug] [Thread-2  ]: On test.first_project.not_null_costumers_customer_id.28d6753afa: Close
18:28:50.180852 [info ] [Thread-2  ]: 2 of 7 PASS not_null_costumers_customer_id ..................................... [[32mPASS[0m in 0.08s]
18:28:50.181165 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_costumers_customer_id.28d6753afa
18:28:50.183221 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:50.184153 [debug] [Thread-5  ]: finished collecting timing info
18:28:50.184338 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: ROLLBACK
18:28:50.184704 [debug] [Thread-5  ]: On test.first_project.unique_costumers_customer_id.996b6965e7: Close
18:28:50.185051 [info ] [Thread-5  ]: 5 of 7 PASS unique_costumers_customer_id ....................................... [[32mPASS[0m in 0.07s]
18:28:50.185418 [debug] [Thread-5  ]: Finished running node test.first_project.unique_costumers_customer_id.996b6965e7
18:28:50.186323 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:28:50.186427 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"
18:28:50.186495 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."costumers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:28:50.187140 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:28:50.187230 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:50.187288 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:28:50.187793 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:50.188691 [debug] [Thread-4  ]: finished collecting timing info
18:28:50.188804 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:28:50.190352 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:28:50.190698 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
18:28:50.190972 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:50.194193 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:50.195500 [debug] [Thread-1  ]: finished collecting timing info
18:28:50.195650 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: ROLLBACK
18:28:50.195868 [debug] [Thread-1  ]: On test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855: Close
18:28:50.196366 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.11s]
18:28:50.196686 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855
18:28:50.199991 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:50.200166 [debug] [MainThread]: Using postgres connection "master"
18:28:50.200246 [debug] [MainThread]: On master: BEGIN
18:28:50.200312 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:50.206905 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:50.207107 [debug] [MainThread]: On master: COMMIT
18:28:50.207181 [debug] [MainThread]: Using postgres connection "master"
18:28:50.207243 [debug] [MainThread]: On master: COMMIT
18:28:50.207570 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:50.207695 [debug] [MainThread]: On master: Close
18:28:50.207993 [info ] [MainThread]: 
18:28:50.208203 [info ] [MainThread]: Finished running 7 tests in 0.17s.
18:28:50.208356 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:50.208436 [debug] [MainThread]: Connection 'test.first_project.accepted_values_costumers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.d894ec9855' was properly closed.
18:28:50.208489 [debug] [MainThread]: Connection 'test.first_project.not_null_costumers_customer_id.28d6753afa' was properly closed.
18:28:50.208540 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:28:50.208591 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:28:50.208642 [debug] [MainThread]: Connection 'test.first_project.unique_costumers_customer_id.996b6965e7' was properly closed.
18:28:50.208692 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:28:50.208741 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:28:50.213515 [info ] [MainThread]: 
18:28:50.213778 [info ] [MainThread]: [32mCompleted successfully[0m
18:28:50.213996 [info ] [MainThread]: 
18:28:50.214142 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:28:50.214391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6096e5fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f609a0241c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60955a1160>]}


============================== 2022-06-04 20:29:51.419406 | a1491b9a-6665-4d12-9223-2da40d13ba76 ==============================
20:29:51.419418 [info ] [MainThread]: Running with dbt=1.1.0
20:29:51.423164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:29:51.423265 [debug] [MainThread]: Tracking: tracking
20:29:51.426366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4737d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4737040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4737070>]}
20:29:51.447283 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:29:51.447742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4737c70>]}
20:29:51.460448 [debug] [MainThread]: Parsing macros/catalog.sql
20:29:51.462969 [debug] [MainThread]: Parsing macros/relations.sql
20:29:51.463898 [debug] [MainThread]: Parsing macros/adapters.sql
20:29:51.478227 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:29:51.479329 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:29:51.480873 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:29:51.483191 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:29:51.489270 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:29:51.498993 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:29:51.509422 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:29:51.512315 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:29:51.513272 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:29:51.514119 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:29:51.515597 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:29:51.517285 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:29:51.521422 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:29:51.525923 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:29:51.527673 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:29:51.537541 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:29:51.541330 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:29:51.542491 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:29:51.545165 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:29:51.546371 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:29:51.554120 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:29:51.566235 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:29:51.572790 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:29:51.573949 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:29:51.575603 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:29:51.576808 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:29:51.577748 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:29:51.583595 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:29:51.589461 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:29:51.591293 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:29:51.592715 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:29:51.594418 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:29:51.598736 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:29:51.601648 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:29:51.602216 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:29:51.602749 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:29:51.603165 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:29:51.604023 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:29:51.609199 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:29:51.612009 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:29:51.750913 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers2.sql
20:29:51.759073 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_custumers.sql
20:29:51.761144 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:29:51.762993 [debug] [MainThread]: 1699: static parser successfully parsed erp/costumers.sql
20:29:51.764479 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:29:51.766189 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:29:51.767562 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:29:51.824501 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' (models/erp/schema.yml) depends on a node named 'customers' which was not found
20:29:51.834339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f46a4f40>]}
20:29:51.842339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f46f44f0>]}
20:29:51.842660 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:29:51.842884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4737d90>]}
20:29:51.844120 [info ] [MainThread]: 
20:29:51.844666 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:51.846030 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:29:51.852338 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:29:51.852527 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:29:51.852597 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:51.860762 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:29:51.861781 [debug] [ThreadPool]: On list_erp_oltp: Close
20:29:51.862933 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:29:51.870426 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:51.870815 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:29:51.871066 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:51.876849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:51.877050 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:51.877131 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:29:51.878825 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:29:51.879846 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:29:51.880192 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:29:51.883692 [debug] [MainThread]: Using postgres connection "master"
20:29:51.883909 [debug] [MainThread]: On master: BEGIN
20:29:51.883996 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:51.888320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:51.888531 [debug] [MainThread]: Using postgres connection "master"
20:29:51.888612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:51.899100 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:29:51.900250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f46a4df0>]}
20:29:51.900504 [debug] [MainThread]: On master: ROLLBACK
20:29:51.900724 [debug] [MainThread]: Using postgres connection "master"
20:29:51.900817 [debug] [MainThread]: On master: BEGIN
20:29:51.901008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:51.901094 [debug] [MainThread]: On master: COMMIT
20:29:51.901176 [debug] [MainThread]: Using postgres connection "master"
20:29:51.901249 [debug] [MainThread]: On master: COMMIT
20:29:51.901384 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:51.901476 [debug] [MainThread]: On master: Close
20:29:51.901815 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:29:51.901993 [info ] [MainThread]: 
20:29:51.906962 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:29:51.907235 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:29:51.907584 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:29:51.907723 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:29:51.907819 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:29:51.909517 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:29:51.909846 [debug] [Thread-1  ]: finished collecting timing info
20:29:51.909966 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:29:51.918906 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:29:51.919190 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:29:51.919491 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:29:51.919592 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:29:51.919674 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:29:51.921114 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:29:51.921353 [debug] [Thread-3  ]: Began running node model.first_project.stg_custumers
20:29:51.921503 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:29:51.921736 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_custumers ................................... [RUN]
20:29:51.922044 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:29:51.928591 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:29:51.928096 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_custumers"
20:29:51.922130 [debug] [Thread-2  ]: finished collecting timing info
20:29:51.928774 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:29:51.935482 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:29:51.935805 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_custumers
20:29:51.936128 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:29:51.936415 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:29:51.952256 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:29:51.948323 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:51.936764 [debug] [Thread-3  ]: Compiling model.first_project.stg_custumers
20:29:51.952574 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:29:51.953763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:51.952715 [debug] [Thread-4  ]: finished collecting timing info
20:29:51.954026 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:29:51.951260 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:29:51.953548 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_custumers"
20:29:51.955981 [debug] [Thread-3  ]: finished collecting timing info
20:29:51.956245 [debug] [Thread-3  ]: Began executing node model.first_project.stg_custumers
20:29:51.956130 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:51.957580 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_custumers"
20:29:51.958148 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
20:29:51.957787 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:29:51.958279 [debug] [Thread-3  ]: On model.first_project.stg_custumers: BEGIN
20:29:51.958916 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:29:51.958485 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:29:51.955413 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:29:51.960221 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:51.960351 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:29:51.960411 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:29:51.966004 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:29:51.966240 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:51.966323 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
20:29:51.972739 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:51.977726 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:51.978507 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
20:29:51.978647 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:29:51.978800 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:51.978945 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)

select * from orders
  );
20:29:51.979814 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
20:29:51.979916 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
20:29:51.979981 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */

  create view "erp_oltp"."public"."stg_custumers__dbt_tmp" as (
    with customers as (
  select distinct
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado as state
  from erp_oltp.public.clientes
)

select * from customers
  );
20:29:51.980155 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:51.982105 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:51.982254 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:29:51.982363 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:51.982647 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
20:29:51.984277 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:51.984355 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    --union al
    --select null as id

)

select *
from source_data


/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:29:51.984166 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:51.984477 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:29:51.984585 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:51.986064 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
20:29:51.986516 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers" rename to "stg_custumers__dbt_backup"
20:29:51.986206 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:51.986688 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:51.990787 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:51.991036 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
20:29:51.994004 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
20:29:51.994169 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:51.995410 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:51.997139 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:29:51.996850 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
20:29:51.997023 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:51.997292 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
alter table "erp_oltp"."public"."stg_custumers__dbt_tmp" rename to "stg_custumers"
20:29:51.993882 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:51.997489 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:29:51.997918 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:51.998779 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:51.998880 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:52.000355 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:52.000446 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:29:51.999087 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:51.998956 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.001180 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
20:29:52.004415 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
20:29:52.003992 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:52.004208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:52.004563 [debug] [Thread-3  ]: On model.first_project.stg_custumers: COMMIT
20:29:51.999172 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:52.009210 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:52.009630 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:52.009499 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:52.009751 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:52.005588 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:29:52.011152 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.012466 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_custumers"
20:29:52.012580 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:52.012764 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.014724 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:52.014864 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:29:52.013697 [debug] [Thread-2  ]: finished collecting timing info
20:29:52.015527 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:29:52.012943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.016913 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:52.017437 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:29:52.017288 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f46a4cd0>]}
20:29:52.017810 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
20:29:52.018067 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:29:52.012868 [debug] [Thread-3  ]: On model.first_project.stg_custumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_custumers"} */
drop view if exists "erp_oltp"."public"."stg_custumers__dbt_backup" cascade
20:29:52.018945 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:52.019808 [debug] [Thread-4  ]: finished collecting timing info
20:29:52.020183 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:52.021096 [debug] [Thread-1  ]: finished collecting timing info
20:29:52.021240 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:29:52.021513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f411a370>]}
20:29:52.020402 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:29:52.024438 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
20:29:52.025468 [debug] [Thread-3  ]: finished collecting timing info
20:29:52.026076 [debug] [Thread-3  ]: On model.first_project.stg_custumers: Close
20:29:52.025858 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f40df520>]}
20:29:52.023096 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 1[0m in 0.11s]
20:29:52.026949 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:29:52.027247 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f41cfdf0>]}
20:29:52.027565 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
20:29:52.027785 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:29:52.026413 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.10s]
20:29:52.028315 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:29:52.028062 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:29:52.029866 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
20:29:52.029962 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
20:29:52.031432 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:29:52.031717 [debug] [Thread-6  ]: finished collecting timing info
20:29:52.031858 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
20:29:52.033351 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:29:52.033583 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:52.033707 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
20:29:52.033851 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:29:52.034135 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_custumers .............................. [[32mCREATE VIEW[0m in 0.10s]
20:29:52.034368 [debug] [Thread-3  ]: Finished running node model.first_project.stg_custumers
20:29:52.035585 [debug] [Thread-8  ]: Began running node model.first_project.costumers
20:29:52.035734 [info ] [Thread-8  ]: 6 of 7 START view model public.costumers ....................................... [RUN]
20:29:52.036006 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.costumers"
20:29:52.036083 [debug] [Thread-8  ]: Began compiling node model.first_project.costumers
20:29:52.036146 [debug] [Thread-8  ]: Compiling model.first_project.costumers
20:29:52.037902 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.costumers"
20:29:52.038012 [debug] [Thread-9  ]: Began running node model.first_project.costumers2
20:29:52.038223 [info ] [Thread-9  ]: 7 of 7 START table model public.costumers2 ..................................... [RUN]
20:29:52.038492 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.costumers2"
20:29:52.038562 [debug] [Thread-9  ]: Began compiling node model.first_project.costumers2
20:29:52.038621 [debug] [Thread-9  ]: Compiling model.first_project.costumers2
20:29:52.040251 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.costumers2"
20:29:52.040516 [debug] [Thread-9  ]: finished collecting timing info
20:29:52.046278 [debug] [Thread-9  ]: Began executing node model.first_project.costumers2
20:29:52.045977 [debug] [Thread-8  ]: finished collecting timing info
20:29:52.048401 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.costumers2"
20:29:52.048665 [debug] [Thread-8  ]: Began executing node model.first_project.costumers
20:29:52.050698 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.costumers"
20:29:52.050926 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
20:29:52.051063 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:52.051196 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:29:52.051478 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
20:29:52.051630 [debug] [Thread-8  ]: On model.first_project.costumers: BEGIN
20:29:52.051702 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:29:52.052436 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:52.055623 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:52.055788 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:29:52.055941 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
20:29:52.056073 [debug] [Thread-8  ]: SQL status: BEGIN in 0.0 seconds
20:29:52.056396 [debug] [Thread-9  ]: On model.first_project.costumers2: BEGIN
20:29:52.056696 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:29:52.056594 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
20:29:52.056518 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:52.060692 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */

  create view "erp_oltp"."public"."costumers__dbt_tmp" as (
    with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  where customers.customer_id != 63
)

select * from final
  );
20:29:52.061989 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:52.062574 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:52.062684 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:52.064937 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:52.066905 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
20:29:52.067083 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.067605 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
alter table "erp_oltp"."public"."costumers__dbt_tmp" rename to "costumers"
20:29:52.068599 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:52.068801 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:29:52.069051 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:52.069157 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:52.070113 [debug] [Thread-6  ]: finished collecting timing info
20:29:52.070952 [debug] [Thread-8  ]: On model.first_project.costumers: COMMIT
20:29:52.071163 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
20:29:52.071277 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
20:29:52.071416 [debug] [Thread-8  ]: On model.first_project.costumers: COMMIT
20:29:52.072820 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f40688e0>]}
20:29:52.072939 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.073081 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
20:29:52.075539 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
20:29:52.074493 [debug] [Thread-8  ]: Using postgres connection "model.first_project.costumers"
20:29:52.075743 [debug] [Thread-8  ]: On model.first_project.costumers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers"} */
drop view if exists "erp_oltp"."public"."costumers__dbt_backup" cascade
20:29:52.073299 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
20:29:52.075643 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */


  create  table "erp_oltp"."public"."costumers2__dbt_tmp"
  as (
    

with customers as (
  select * from "erp_oltp"."public"."stg_custumers"
),orders as (
  select * from "erp_oltp"."public"."stg_orders"
),customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
    from orders
    group by 1
), final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
20:29:52.076146 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:52.077031 [debug] [Thread-8  ]: finished collecting timing info
20:29:52.077270 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
20:29:52.077385 [debug] [Thread-8  ]: On model.first_project.costumers: Close
20:29:52.079202 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f40153d0>]}
20:29:52.079489 [info ] [Thread-8  ]: 6 of 7 OK created view model public.costumers .................................. [[32mCREATE VIEW[0m in 0.04s]
20:29:52.079940 [debug] [Thread-8  ]: Finished running node model.first_project.costumers
20:29:52.080123 [debug] [Thread-9  ]: SQL status: SELECT 50 in 0.0 seconds
20:29:52.081927 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
20:29:52.082059 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2" rename to "costumers2__dbt_backup"
20:29:52.082582 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:52.083919 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
20:29:52.084010 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
alter table "erp_oltp"."public"."costumers2__dbt_tmp" rename to "costumers2"
20:29:52.084266 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:52.086153 [debug] [Thread-9  ]: On model.first_project.costumers2: COMMIT
20:29:52.086253 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
20:29:52.086323 [debug] [Thread-9  ]: On model.first_project.costumers2: COMMIT
20:29:52.087797 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
20:29:52.088768 [debug] [Thread-9  ]: Using postgres connection "model.first_project.costumers2"
20:29:52.088857 [debug] [Thread-9  ]: On model.first_project.costumers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.costumers2"} */
drop table if exists "erp_oltp"."public"."costumers2__dbt_backup" cascade
20:29:52.091077 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:52.092378 [debug] [Thread-9  ]: finished collecting timing info
20:29:52.092562 [debug] [Thread-9  ]: On model.first_project.costumers2: Close
20:29:52.092914 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1491b9a-6665-4d12-9223-2da40d13ba76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4084190>]}
20:29:52.093157 [info ] [Thread-9  ]: 7 of 7 OK created table model public.costumers2 ................................ [[32mSELECT 50[0m in 0.05s]
20:29:52.093447 [debug] [Thread-9  ]: Finished running node model.first_project.costumers2
20:29:52.095732 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:52.095871 [debug] [MainThread]: Using postgres connection "master"
20:29:52.095941 [debug] [MainThread]: On master: BEGIN
20:29:52.096002 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:52.103094 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:52.103388 [debug] [MainThread]: On master: COMMIT
20:29:52.103503 [debug] [MainThread]: Using postgres connection "master"
20:29:52.103583 [debug] [MainThread]: On master: COMMIT
20:29:52.103776 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:52.103890 [debug] [MainThread]: On master: Close
20:29:52.104398 [info ] [MainThread]: 
20:29:52.104646 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.26s.
20:29:52.104777 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:52.104842 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:29:52.104899 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:29:52.104956 [debug] [MainThread]: Connection 'model.first_project.stg_custumers' was properly closed.
20:29:52.105048 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:29:52.105117 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:29:52.105172 [debug] [MainThread]: Connection 'model.first_project.costumers' was properly closed.
20:29:52.105227 [debug] [MainThread]: Connection 'model.first_project.costumers2' was properly closed.
20:29:52.108830 [info ] [MainThread]: 
20:29:52.109093 [info ] [MainThread]: [32mCompleted successfully[0m
20:29:52.109252 [info ] [MainThread]: 
20:29:52.109367 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:29:52.109581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f41cf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f46a4d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93f4219f40>]}


============================== 2022-06-04 20:31:05.409596 | d098955a-eba8-4754-9ac3-688e4719ae6f ==============================
20:31:05.409611 [info ] [MainThread]: Running with dbt=1.1.0
20:31:05.410048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:31:05.410143 [debug] [MainThread]: Tracking: tracking
20:31:05.412591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fc14f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fc14dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fc14eb0>]}
20:31:05.437088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:31:05.437281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:31:05.442115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd098955a-eba8-4754-9ac3-688e4719ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103facc0d0>]}
20:31:05.446831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd098955a-eba8-4754-9ac3-688e4719ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fbacdc0>]}
20:31:05.447119 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:31:05.447317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd098955a-eba8-4754-9ac3-688e4719ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1041430c70>]}
20:31:05.451462 [info ] [MainThread]: 
20:31:05.451940 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:05.452935 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:31:05.460584 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:31:05.460803 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:31:05.461234 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:05.468416 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:31:05.473375 [debug] [ThreadPool]: On list_erp_oltp: Close
20:31:05.477552 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:31:05.481303 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:05.481433 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:31:05.481508 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:05.486677 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:31:05.486816 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:05.486882 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:31:05.488438 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:31:05.489316 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:31:05.489576 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:31:05.492749 [debug] [MainThread]: Using postgres connection "master"
20:31:05.492887 [debug] [MainThread]: On master: BEGIN
20:31:05.492966 [debug] [MainThread]: Opening a new connection, currently in state init
20:31:05.499103 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:31:05.499304 [debug] [MainThread]: Using postgres connection "master"
20:31:05.499379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:31:05.510434 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:31:05.511465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd098955a-eba8-4754-9ac3-688e4719ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fbd53d0>]}
20:31:05.511688 [debug] [MainThread]: On master: ROLLBACK
20:31:05.512049 [debug] [MainThread]: Using postgres connection "master"
20:31:05.512156 [debug] [MainThread]: On master: BEGIN
20:31:05.512664 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:05.512775 [debug] [MainThread]: On master: COMMIT
20:31:05.512871 [debug] [MainThread]: Using postgres connection "master"
20:31:05.512943 [debug] [MainThread]: On master: COMMIT
20:31:05.513229 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:05.513343 [debug] [MainThread]: On master: Close
20:31:05.513756 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:31:05.513972 [info ] [MainThread]: 
20:31:05.518721 [debug] [Thread-1  ]: Began running node seed.first_project.code-country
20:31:05.518993 [info ] [Thread-1  ]: 1 of 1 START seed file public.code-country ..................................... [RUN]
20:31:05.519291 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:31:05.519393 [debug] [Thread-1  ]: Began compiling node seed.first_project.code-country
20:31:05.519485 [debug] [Thread-1  ]: finished collecting timing info
20:31:05.519573 [debug] [Thread-1  ]: Began executing node seed.first_project.code-country
20:31:05.579846 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:05.580076 [debug] [Thread-1  ]: On seed.first_project.code-country: BEGIN
20:31:05.580148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:05.586130 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:31:05.586311 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:05.586381 [debug] [Thread-1  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */

    create table "erp_oltp"."public"."code-country" ("Name" text,"Code" text)
  
20:31:05.591492 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
20:31:05.678869 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:05.679091 [debug] [Thread-1  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:31:05.680438 [debug] [Thread-1  ]: SQL status: INSERT 0 249 in 0.0 seconds
20:31:05.682911 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:31:05.690114 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:05.690293 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:05.690386 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:05.692077 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:31:05.692528 [debug] [Thread-1  ]: finished collecting timing info
20:31:05.692668 [debug] [Thread-1  ]: On seed.first_project.code-country: Close
20:31:05.693166 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd098955a-eba8-4754-9ac3-688e4719ae6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fa56cd0>]}
20:31:05.693360 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.17s]
20:31:05.693642 [debug] [Thread-1  ]: Finished running node seed.first_project.code-country
20:31:05.694746 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:05.694879 [debug] [MainThread]: Using postgres connection "master"
20:31:05.694944 [debug] [MainThread]: On master: BEGIN
20:31:05.695001 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:05.698759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:05.698889 [debug] [MainThread]: On master: COMMIT
20:31:05.698958 [debug] [MainThread]: Using postgres connection "master"
20:31:05.699018 [debug] [MainThread]: On master: COMMIT
20:31:05.699139 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:05.699222 [debug] [MainThread]: On master: Close
20:31:05.699449 [info ] [MainThread]: 
20:31:05.699641 [info ] [MainThread]: Finished running 1 seed in 0.25s.
20:31:05.699794 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:05.699928 [debug] [MainThread]: Connection 'list_erp_oltp' was properly closed.
20:31:05.700020 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:31:05.703156 [info ] [MainThread]: 
20:31:05.703382 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:05.703580 [info ] [MainThread]: 
20:31:05.703695 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:31:05.703869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fa70e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fa70d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f103fa4bd90>]}


============================== 2022-06-06 22:24:59.401475 | cea5014d-b2d2-4524-b5cd-481eccc80e51 ==============================
22:24:59.401490 [info ] [MainThread]: Running with dbt=1.1.0
22:24:59.402576 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
22:24:59.402668 [debug] [MainThread]: Tracking: tracking
22:24:59.405542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344bccb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344bccbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344bccb160>]}
22:24:59.480756 [debug] [MainThread]: Executing "git --help"
22:24:59.483966 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:24:59.484228 [debug] [MainThread]: STDERR: "b''"
22:24:59.487928 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:24:59.488334 [debug] [MainThread]: Using postgres connection "debug"
22:24:59.488408 [debug] [MainThread]: On debug: select 1 as id
22:24:59.488479 [debug] [MainThread]: Opening a new connection, currently in state init
22:24:59.515989 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
22:24:59.516941 [debug] [MainThread]: On debug: Close
22:24:59.517301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344a43c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344a43cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f344a43c220>]}
22:25:00.266590 [debug] [MainThread]: Connection 'debug' was properly closed.
